#!/bin/sh
set -e

# State-of-the-Art Development Rules erzwingen
echo "[pre-commit] enforcing development rules..."
python3 omf/scripts/enforce_development_rules.py

# Validierung der Regeln
echo "[pre-commit] validating development rules..."
python3 omf/scripts/validate_development_rules.py

# Registry-Validierung
if [ -f "registry/model/v1/mapping.yml" ]; then
  echo "[pre-commit] validate mapping..."
  python3 tools/validate_mapping.py
  echo "[pre-commit] check mapping collisions..."
  python3 tools/check_mapping_collisions.py
fi
if [ -d "registry/model/v1/templates" ]; then
  echo "[pre-commit] check templates don't include topics..."
  python3 tools/check_templates_no_topics.py
fi

# ðŸ§ª KRITISCHE TESTS AUSFÃœHREN
echo "[pre-commit] running tests..."
source .venv/bin/activate
python -m pytest tests/ -v --tb=short
echo "[pre-commit] tests passed âœ…"

echo "[pre-commit] OK - State-of-the-Art Standards eingehalten"
