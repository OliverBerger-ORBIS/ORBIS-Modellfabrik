var $localize=Object.assign(void 0===$localize?{}:$localize,{locale:"de"});
"use strict";(function(global){global.ng=global.ng||{};global.ng.common=global.ng.common||{};global.ng.common.locales=global.ng.common.locales||{};const u=undefined;function plural(val){const n=val,i=Math.floor(Math.abs(val)),v=val.toString().replace(/^[^.]*\.?/,"").length;if(i===1&&v===0)return 1;return 5}global.ng.common.locales["de"]=["de",[["AM","PM"],u,u],u,[["S","M","D","M","D","F","S"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]],[["S","M","D","M","D","F","S"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]],[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan.","Feb.","M\xE4rz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]],[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]],[["v. Chr.","n. Chr."],u,u],1,[6,0],["dd.MM.yy","dd.MM.y","d. MMMM y","EEEE, d. MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1}, {0}",u,"{1} 'um' {0}",u],[",",".",";","%","+","-","E","\xB7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","Euro",{"ATS":["\xF6S"],"AUD":["AU$","$"],"BGM":["BGK"],"BGO":["BGJ"],"CUC":[u,"Cub$"],"DEM":["DM"],"FKP":[u,"Fl\xA3"],"GHS":[u,"\u20B5"],"GNF":[u,"F.G."],"KMF":[u,"FC"],"PHP":[u,"\u20B1"],"RON":[u,"L"],"RWF":[u,"F.Rw"],"SYP":[],"THB":["\u0E3F"],"TWD":["NT$"],"XXX":[],"ZMW":[u,"K"]},"ltr",plural,[[["Mitternacht","morgens","vorm.","mittags","nachm.","abends","nachts"],u,["Mitternacht","morgens","vormittags","mittags","nachmittags","abends","nachts"]],[["Mitternacht","Morgen","Vorm.","Mittag","Nachm.","Abend","Nacht"],u,["Mitternacht","Morgen","Vormittag","Mittag","Nachmittag","Abend","Nacht"]],["00:00",["05:00","10:00"],["10:00","12:00"],["12:00","13:00"],["13:00","18:00"],["18:00","24:00"],["00:00","05:00"]]]]})(typeof globalThis!=="undefined"&&globalThis||typeof global!=="undefined"&&global||typeof window!=="undefined"&&window);;
"use strict";(self.webpackChunkff_frontend=self.webpackChunkff_frontend||[]).push([["main"],{1728:(pt,me,p)=>{var Zt=p(318),t=p(3184),Ht=p(8784),je=p(7481);const Bt=new t.OlP("MqttClientService"),Gt=new t.OlP("MqttPrefixRequired"),Wt=new t.OlP("ShowLanguageSelector"),Vt=new t.OlP("ControllerClientService");var R=p(2136);const fe={history:!0,identifier:"ff",dialog:{treeNodes:[{title:"Customer view",i18n:"dashboardCustomerView",type:R.NS.TypeEnum.Customer},{title:"Supplier view",i18n:"dashboardSupplierView",type:R.NS.TypeEnum.OrderRawMaterial},{title:"Production view",i18n:"dashboardProductionvView",children:[{title:"Stock",i18n:"dashboardStock",type:R.NS.TypeEnum.Stock},{title:"NFC Reader",i18n:"dashboardNfcReader",type:R.NS.TypeEnum.Nfc}]},{title:"Monitoring",i18n:"dashboardMonitoring",children:[{title:"Temperature",i18n:"dashboardChartTemperature",type:R.NS.TypeEnum.TemperatureValue},{title:"Air humidity",i18n:"dashboardChartAirHumidity",type:R.NS.TypeEnum.AirHumidityValue},{title:"Air pressure",i18n:"dashboardChartAirPressure",type:R.NS.TypeEnum.AirPressureValue},{title:"Air quality",i18n:"dashboardChartAirQuality",type:R.NS.TypeEnum.AirQualityValue},{title:"Brightnes",i18n:"dashboardChartBrightness",type:R.NS.TypeEnum.BrightnesValue},{title:"Camera",i18n:"dashboardCamera",type:R.NS.TypeEnum.Camera},{title:"Camera control",i18n:"dashboardCameraControl",type:R.NS.TypeEnum.Ptu}]}]}},ze=Object.assign(Object.assign({},fe),{history:!1});var _=p(6362),A=p(3935),_t=p(5162),L=p(587),Z=p(1381);let ge=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_.ez]]}),n})();var X=p(4941),E=p(7317),Ft=p(1959),S=p(1961),jt=p(1534),x=p(5758),he=p(9975),mt=p(6531),N=p(9076),U=p(5590),rt=p(4683),j=p(6131),ft=p(7776),Ce=p(6439),zt=p(4742),gt=p(4770),ht=p(7216),Kt=p(6623),Ct=p(2528),z=p(4316),C=p(7939),tt=p(2379),Lt=p(89);let Xt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[tt.Nh,E.ot,he.t,j.ie,U.Ps,ft.Tx,ht.SJ,C.p0,Lt.AV,S.QW,X._t,Ft.vV,mt.To,z.JX,Ct.ZX,x.Is,N.lN,rt.c,gt.LD,Ce.TU,zt.Cq,jt.p9,Kt.rP],tt.Nh,E.ot,he.t,j.ie,U.Ps,ft.Tx,ht.SJ,C.p0,Lt.AV,S.QW,X._t,Ft.vV,mt.To,z.JX,Ct.ZX,x.Is,N.lN,rt.c,gt.LD,Ce.TU,zt.Cq,jt.p9,Kt.rP]}),n})(),Te=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_.ez,Xt,_t.IX,Z.Bz,A.aw,ge,L.u5]]}),n})();var J=p(6067),F=p(8951),Tt=(()=>{return(n=Tt||(Tt={})).BLOCKED="BLOCKED",n.READY="READY",n.BUSY="BUSY",Tt;var n})();const k={BLUE:"BLUE",RED:"RED",WHITE:"WHITE"},Ae={MODULE:"MODULE",FTS:"FTS"};var v=(()=>{return(n=v||(v={})).ENQUEUED="ENQUEUED",n.IN_PROGRESS="IN_PROGRESS",n.FINISHED="FINISHED",n.CANCELLED="CANCELLED",n.ERROR="ERROR",v;var n})(),h=(()=>{return(n=h||(h={})).NORTH="NORTH",n.EAST="EAST",n.SOUTH="SOUTH",n.WEST="WEST",h;var n})(),Mt=(()=>{return(n=Mt||(Mt={})).SET_VALUES="setCalibrationValues",n.RESET="resetCalibration",n.STORE="storeCalibrationValues",n.SELECT="selectCalibrationPosition",n.TEST="testCalibrationPosition",n.START="startCalibration",n.STOP="stopCalibration",Mt;var n})();const Q="+";var y=(()=>{return(n=y||(y={})).GLOBAL="ccu/global",n.ORDER_REQUEST="ccu/order/request",n.ORDER_RESPONSE="ccu/order/response",n.ACTIVE_ORDERS="ccu/order/active",n.COMPLETED_ORDERS="ccu/order/completed",n.CANCEL_ORDERS="ccu/order/cancel",n.PAIRING_STATE="ccu/pairing/state",n.KNOWN_MODULES_STATE="ccu/pairing/known_modules",n.PAIRING_PAIR_FTS="ccu/pairing/pair_fts",n.CALIBRATION_BASE="ccu/state/calibration",n.LOG="ccu/state/log",n.STOCK="ccu/state/stock",n.FLOWS="ccu/state/flows",n.LAYOUT="ccu/state/layout",n.VERSION_MISMATCH="ccu/state/version-mismatch",n.SET_LAYOUT="ccu/set/layout",n.SET_DEFAULT_LAYOUT="ccu/set/default_layout",n.SET_FLOWS="ccu/set/flows",n.SET_MODULE_DURATION="ccu/set/module-duration",n.SET_MODULE_CALIBRATION="ccu/set/calibration",n.SET_RESET="ccu/set/reset",n.SET_CHARGE="ccu/set/charge",n.CONFIG="ccu/state/config",n.SET_CONFIG="ccu/set/config",n.SET_PARK="ccu/set/park",n.DELETE_MODULE="ccu/set/delete-module",y;var n})();function xe(n){return y.CALIBRATION_BASE+"/"+n}var B=(()=>{return(n=B||(B={})).ROOT="fts/v1/ff",n.ORDER="order",n.STATE="state",n.CONNECTION="connection",n.FACTSHEET="factsheet",n.INSTANT_ACTION="instantAction",B;var n})();function Pt(n,r){if(!r||r===B.ROOT)throw new Error("Invalid argument for topic: "+r);return`${B.ROOT}/${n}/${r}`}var G=(()=>{return(n=G||(G={})).ROOT="module/v1/ff",n.STATE="state",n.ORDER="order",n.CONNECTION="connection",n.FACTSHEET="factsheet",n.INSTANT_ACTION="instantAction",G;var n})();function At(n,r){if(!r||r===G.ROOT)throw new Error("Invalid argument for topic: "+r);return`${G.ROOT}/${n}/${r}`}var xt=(()=>{return(n=xt||(xt={})).ONLINE="ONLINE",n.OFFLINE="OFFLINE",n.CONNECTIONBROKEN="CONNECTIONBROKEN",xt;var n})(),wt=(()=>((wt||(wt={})).DASHBOARD="dashboard",wt))(),M=(()=>{return(n=M||(M={})).ROOT="",n.MODULE="module",n.CALIBRATION="calibration",n.ORDERS="orders",n.PRODUCTION_FLOWS="flows",n.LAYOUT="layout",n.SIMULATION="simulation",n.LOGS="logs",n.DASHBOARD="dashboard",M;var n})();const q="moduleRoot";var m=p(635);function Y(){return(0,m.U)(n=>n.payload)}function tn(n,r){if(1&n&&(t.TgZ(0,"li")(1,"strong"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.lnq("",e.serialNumber," (",t.lcZ(3,3,"Letzte Position:")," ",e.lastNodeId,")")}}function en(n,r){if(1&n&&(t.TgZ(0,"div",5)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"h3"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"ul"),t.YNc(11,tn,4,5,"li",6),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"Ein oder mehrere Fahrerlose Transportsysteme (FTS) sind durch Gegenst\xe4nde auf der Fahrbahn am Weiterfahren blockiert.")),t.xp6(3),t.Oqu(t.lcZ(6,6,"Bitte entfernen Sie die Hindernisse um den Betrieb fortzusetzen.")),t.xp6(3),t.Oqu(t.lcZ(9,8,"FTS mit gemeldeten Hindernissen:")),t.xp6(3),t.Q6J("ngForOf",e.data.collisions)}}let nn=(()=>{class n{constructor(e){this.data=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-collision-warning-popup"]],decls:10,vars:7,consts:[["mat-dialog-title",""],[2,"vertical-align","baseline"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial","","color","warn"],["mat-dialog-content",""],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.TgZ(0,"h2",0)(1,"mat-icon",1),t._uU(2,"report_problem"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,en,12,10,"div",2),t.TgZ(6,"div",3)(7,"button",4),t._uU(8),t.ALo(9,"translate"),t.qZA()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,3,"Kollisionswarnung"),"\n"),t.xp6(2),t.Q6J("ngIf",o.data.collisions),t.xp6(3),t.Oqu(t.lcZ(9,5,"OK")))},directives:[x.uh,U.Hw,_.O5,x.xY,_.sg,x.H8,E.lW,x.ZT],pipes:[A.X$],styles:[".mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:.5rem}"]}),n})();var It=(()=>{return(n=It||(It={})).RESET="RESET",n.ACTION_DISMISSED="ACTION_DISMISSED",n.COLLISION="COLLISION",It;var n})(),te=p(538),et=p(6562),at=p(9635),T=p(9196),yt=p(4351),D=p(4874),on=p(833),$=p(116),Oe=p(2673);const rn=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(?::\d{2}(?:\.\d*)?)?Z$/;function an(n,r){return"string"==typeof r&&rn.test(r)?new Date(r):r}var H=p(6317),ye=p(745);let ee=(()=>{class n{constructor(e){this.controllerService=e,this.destroy$=new J.t(1),this.selectedController$=new H.X(void 0),this.availableControllers$=(0,ye.of)(this.controllerService.loadControllers()).pipe((0,Oe.w)(()=>this.controllerService.onChange()),(0,T.d)(1)),this.availableFutureFactoryControllers$=this.setupAvailableFutureFactoryControllers(this.availableControllers$),this.setupSelectedController(this.availableFutureFactoryControllers$)}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}loadControllers(){this.controllerService.loadControllers()}setupAvailableFutureFactoryControllers(e){return e.pipe((0,$.h)(o=>(null==o?void 0:o.length)>0),(0,m.U)(o=>o.filter(i=>3===(null==i?void 0:i.targetModule))),(0,T.d)(1))}setupSelectedController(e){e.pipe((0,$.h)(o=>(null==o?void 0:o.length)>0),(0,m.U)(o=>o.filter(i=>!!i)),(0,te.M)(this.selectedController$),(0,m.U)(([o,i])=>{var a;return null!==(a=o.find(s=>s.controllerId===(null==i?void 0:i.controllerId)))&&void 0!==a?a:o[0]}),(0,F.R)(this.destroy$)).subscribe(o=>this.selectedController$.next(o))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Vt))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),I=(()=>{class n{constructor(e,o,i){this.mqttService=e,this.requirePrefix=o,this.selectedControllerService=i,this.requirePrefix=null==o||o}prependPrefix(e,o){return this.requirePrefix?`/j1/txt/${e}/${o}`:o}subscribe(e){return this.selectedControllerService.selectedController$.pipe((0,$.h)(o=>!!(null==o?void 0:o.controllerId)),(0,m.U)(o=>null==o?void 0:o.controllerId),(0,Oe.w)(o=>this.mqttService.subscribe(o,this.prependPrefix(o,e))),(0,m.U)(o=>this.parsePayload(o.topic,o)),(0,T.d)(1))}parsePayload(e,o){var i;try{return Object.assign(Object.assign({},o),{payload:JSON.parse(null===(i=o.payload)||void 0===i?void 0:i.toString(),an)})}catch(a){return console.error('Unable to parse message payload in topic "%s" as JSON',e,a),Object.assign(Object.assign({},o),{payload:{}})}}publish(e,o,i){var a;const s=null===(a=this.selectedControllerService.selectedController$.value)||void 0===a?void 0:a.controllerId;if(!s)throw new Error("No controller selected");this.mqttService.publish(s,this.prependPrefix(s,e),JSON.stringify(o),Object.assign({retain:!1,qos:2},null!=i?i:{}))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Bt),t.LFG(Gt,8),t.LFG(ee))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),sn=(()=>{class n{subscribe(e,o){return new on.y}publish(e,o,i){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),ln=(()=>{class n{constructor(){this.controllers$=new J.t(1)}onChange(){return this.controllers$.asObservable()}loadControllers(){this.controllers$.next([{name:"controller",hardwareId:"50F14AFC164C",hardwareModel:"TXT",alarm:!0,pushMessage:!0,shared:!0,mqttUser:void 0,softwareVersion:"1.1.9",softwareName:"txt",controllerId:1,crdate:1560873431}])}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const Et={FTS:"FTS",MODULE:"MODULE",CONNECTION:"CONNECTION"};let K=(()=>{class n{constructor(e){this.mqttService=e,this.destroy=new J.t(1),this.STATE_TOPICS={fts:Pt(Q,B.STATE),module:At(Q,G.STATE),fts_connection:Pt(Q,B.CONNECTION),module_connection:At(Q,G.CONNECTION)},this.pairingState$=this.mqttService.subscribe(y.PAIRING_STATE).pipe(Y(),(0,T.d)(1)),this.pairedModules$=this.pairingState$.pipe((0,m.U)(o=>o.modules),(0,T.d)(1)),this.pairedTransports$=this.pairingState$.pipe((0,m.U)(o=>o.transports),(0,T.d)(1)),this.allModules$=this.pairingState$.pipe((0,m.U)(o=>[...o.modules,...o.transports]),(0,T.d)(1)),this.ftsState$=this.subscribeTo(this.STATE_TOPICS.fts,"FTS"),this.moduleState$=this.subscribeTo(this.STATE_TOPICS.module,"MODULE"),this.ftsConnection$=this.subscribeTo(this.STATE_TOPICS.fts_connection,"CONNECTION"),this.moduleConnection$=this.subscribeTo(this.STATE_TOPICS.module_connection,"CONNECTION"),this.ftsStateLog$=this.ftsState$.pipe(this.collectLogs(),(0,T.d)(1)),this.moduleStateLog$=this.moduleState$.pipe(this.collectLogs(),(0,T.d)(1)),this.ftsConnectionLog$=this.ftsConnection$.pipe(this.collectLogs(),(0,T.d)(1)),this.moduleConnectionLog$=this.moduleConnection$.pipe(this.collectLogs(),(0,T.d)(1)),this.moduleStates$=this.moduleState$.pipe((0,yt.R)((o,i)=>{const a=new Map(o);return"MODULE"===i.type&&a.set(i.state.serialNumber,i.state),a},new Map),(0,T.d)(1)),this.ftsStates$=this.ftsState$.pipe((0,yt.R)((o,i)=>{const a=new Map(o);return"FTS"===i.type&&a.set(i.state.serialNumber,i.state),a},new Map),(0,T.d)(1)),this.stateLog$=(0,et.a)([this.ftsState$,this.moduleState$,this.ftsConnection$,this.moduleConnection$]).pipe((0,yt.R)((o,i)=>{const a=i.filter(s=>void 0!==s.type);return[...new Set([...o,...a])]},[]),(0,T.d)(1)),this.calibrationState$=this.mqttService.subscribe(xe(Q)).pipe((0,m.U)(o=>o.payload)),this.calibrationState$=this.mqttService.subscribe(xe(Q)).pipe(Y()),this.ftsStateLog$.pipe((0,F.R)(this.destroy)).subscribe(at.Z),this.moduleStateLog$.pipe((0,F.R)(this.destroy)).subscribe(at.Z),this.ftsConnectionLog$.pipe((0,F.R)(this.destroy)).subscribe(at.Z),this.moduleConnectionLog$.pipe((0,F.R)(this.destroy)).subscribe(at.Z),this.stateLog$.pipe((0,F.R)(this.destroy)).subscribe(at.Z),this.moduleStates$.pipe((0,F.R)(this.destroy)).subscribe(at.Z)}ngOnDestroy(){this.destroy.next(!0),this.destroy.complete()}subscribeTo(e,o){return this.mqttService.subscribe(e).pipe((0,m.U)(i=>({type:o,received:new Date,state:i.payload})),(0,D.O)({}),(0,T.d)(1))}collectLogs(){return(0,yt.R)((e,o)=>o.type?[...new Set([...e,o])]:e,[])}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),be=(()=>{class n{constructor(e,o){this.statesService=e,this.dialog=o,this.dialogRef=null,this.subscription=null}init(){this.subscription||(this.subscription=this.statesService.ftsStates$.pipe((0,m.U)(e=>this.getFtsWithCollisions(e)),(0,te.M)(this.statesService.pairingState$),(0,m.U)(([e,o])=>e.filter(i=>this.isPairedFtsSerial(i.serialNumber,o)))).subscribe(e=>{e&&e.length>0?this.dialogRef?this.dialogRef.componentInstance.data.collisions=e:(this.dialogRef=this.dialog.open(nn,{data:{collisions:e},disableClose:!0}),this.dialogRef.afterClosed().subscribe(()=>{this.dialogRef=null})):this.closeDialog()}))}closeDialog(){this.dialogRef&&(this.dialogRef.close(),this.dialogRef=null)}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.closeDialog()}hasCollisionWarning(e){return e.errors&&e.errors.some(o=>o.errorType===It.COLLISION)}getFtsWithCollisions(e){return[...e.values()].filter(o=>this.hasCollisionWarning(o)).map(o=>o)}isPairedFtsSerial(e,o){var i;return null===(i=o.transports)||void 0===i?void 0:i.some(a=>a.serialNumber===e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(K),t.LFG(x.uw))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var ne=p(9783);function cn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).setLanguage(a)}),t._uU(1),t.ALo(2,"uppercase"),t.qZA()}if(2&n){const e=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e))}}function un(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"button",1)(2,"span"),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.TgZ(5,"mat-icon"),t._uU(6,"arrow_drop_down"),t.qZA()(),t.TgZ(7,"mat-menu",2,3),t.YNc(9,cn,3,3,"button",4),t.qZA(),t.BQk()),2&n){const e=t.MAs(8),o=t.oxw();t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(2),t.Oqu(t.lcZ(4,4,o.selectedLocale)),t.xp6(4),t.Q6J("overlapTrigger",!1),t.xp6(2),t.Q6J("ngForOf",o.locales)}}let dn=(()=>{class n{constructor(e,o,i,a){this.showLanguageSelector=e,this.locale=o,this.i18n=i,this.router=a,this.locales=["de","en","es","fr","nl","pt","ru"],this.selectedLocale=o,this.i18n.use(o)}setLanguage(e){this.selectedLocale=e,this.i18n.use(e),location.href=`/${e}/aps${this.router.url}`}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Wt),t.Y36(t.soG),t.Y36(ne.Dp),t.Y36(Z.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-language-selector"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-button","",1,"lang-button",3,"matMenuTriggerFor"],[1,"nav__language-menu",3,"overlapTrigger"],["localMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(e,o){1&e&&t.YNc(0,un,10,6,"ng-container",0),2&e&&t.Q6J("ngIf",o.showLanguageSelector)},directives:[_.O5,E.lW,ft.p6,U.Hw,ft.VK,_.sg,ft.OP],pipes:[_.gd],styles:["[_nghost-%COMP%]{display:block;align-self:center;height:36px;line-height:36px;color:var(--text-accent-color)}.lang-button[_ngcontent-%COMP%]{height:36px;line-height:36px}.mat-icon[_ngcontent-%COMP%]{line-height:24px}"]}),n})();function pn(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Modul")))}function _n(n,r){if(1&n&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;let o;t.xp6(1),t.hij(" ",t.lcZ(2,1,"Produktionsschritt."+(null!==(o=e.moduleType)&&void 0!==o?o:e.deviceType))," ")}}function mn(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Seriennummer")))}function fn(n,r){if(1&n&&(t.TgZ(0,"td",18)(1,"strong"),t._uU(2),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.serialNumber)}}function gn(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Controller")))}function hn(n,r){1&n&&(t.TgZ(0,"span"),t._uU(1,"24V"),t.qZA())}function Cn(n,r){1&n&&(t.TgZ(0,"span"),t._uU(1,"TXT"),t.qZA())}function Tn(n,r){1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SPS")))}function An(n,r){if(1&n&&(t.TgZ(0,"td",18),t.YNc(1,hn,2,0,"span",19),t.YNc(2,Cn,2,0,"span",19),t.YNc(3,Tn,3,3,"span",19),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.is24V),t.xp6(1),t.Q6J("ngIf",e.isTXT),t.xp6(1),t.Q6J("ngIf",!e.isTXT)}}function xn(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Installiert")))}function On(n,r){if(1&n&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e.version," ")}}function yn(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Erwartete Version")))}function bn(n,r){if(1&n&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e.requiredVersion," ")}}function Sn(n,r){1&n&&t._UZ(0,"tr",20)}function vn(n,r){1&n&&t._UZ(0,"tr",21)}function Zn(n,r){if(1&n&&(t.TgZ(0,"div",5)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"translate"),t._UZ(7,"br"),t.TgZ(8,"a",6),t._uU(9,"https://www.fischertechnik.de/agile-production-simulation/update-blog"),t.qZA()(),t.TgZ(10,"p")(11,"strong"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"table",7),t.ynx(15,8),t.YNc(16,pn,3,3,"th",9),t.YNc(17,_n,3,3,"td",10),t.BQk(),t.ynx(18,11),t.YNc(19,mn,3,3,"th",9),t.YNc(20,fn,3,1,"td",10),t.BQk(),t.ynx(21,12),t.YNc(22,gn,3,3,"th",9),t.YNc(23,An,4,3,"td",10),t.BQk(),t.ynx(24,13),t.YNc(25,xn,3,3,"th",9),t.YNc(26,On,2,1,"td",10),t.BQk(),t.ynx(27,14),t.YNc(28,yn,3,3,"th",9),t.YNc(29,bn,2,1,"td",10),t.BQk(),t.YNc(30,Sn,1,0,"tr",15),t.YNc(31,vn,1,0,"tr",16),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,7,"Modulversionen stimmen nicht mit der Version der zentralen Steuerung \xfcberein!")),t.xp6(3),t.hij(" ",t.lcZ(6,9,"F\xfcr eine einwandfreie Funktion installieren Sie bitte einen einheitlichen Softwarestand. Die aktuellen Versionen finden Sie unter")," "),t.xp6(7),t.AsE("",t.lcZ(13,11,"Version der zentralen Steuerung:")," ",e.data.message.ccuVersion,""),t.xp6(2),t.Q6J("dataSource",e.data.message.mismatchedModules),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let Fn=(()=>{class n{constructor(e){this.data=e,this.displayedColumns=["serialNumber","moduleType","description","version","requiredVersion"]}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-version-mismatch-popup"]],decls:10,vars:7,consts:[["mat-dialog-title",""],[2,"vertical-align","baseline"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial","","color","warn"],["mat-dialog-content",""],["href","https://www.fischertechnik.de/agile-production-simulation/update-blog"],["mat-table","",3,"dataSource"],["matColumnDef","moduleType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","serialNumber"],["matColumnDef","description"],["matColumnDef","version"],["matColumnDef","requiredVersion"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"h2",0)(1,"mat-icon",1),t._uU(2,"report_problem"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,Zn,32,13,"div",2),t.TgZ(6,"div",3)(7,"button",4),t._uU(8),t.ALo(9,"translate"),t.qZA()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,3,"Versions-Konflikt"),"\n"),t.xp6(2),t.Q6J("ngIf",o.data.message),t.xp6(3),t.Oqu(t.lcZ(9,5,"OK")))},directives:[x.uh,U.Hw,_.O5,x.xY,C.BZ,C.w1,C.fO,C.ge,C.Dz,C.ev,C.as,C.XQ,C.nj,C.Gk,x.H8,E.lW,x.ZT],pipes:[A.X$],styles:[".mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:.5rem}.mat-cell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(:last-child){margin-right:1ch}"]}),n})(),Se=(()=>{class n{constructor(e,o){this.mqttService=e,this.dialog=o,this.dialogRef=null,this.subscription=null,this.lastMessageDate=null}init(){this.subscription||(this.subscription=this.mqttService.subscribe(y.VERSION_MISMATCH).subscribe(e=>{e.payload.mismatchedModules&&0!==e.payload.mismatchedModules.length?this.updateDialog(e.payload):this.closeDialog()}))}updateDialog(e){this.dialogRef?(this.lastMessageDate=e.timestamp,this.dialogRef.componentInstance.data.message=e):(!this.lastMessageDate||this.lastMessageDate<e.timestamp)&&(this.lastMessageDate=e.timestamp,this.dialogRef=this.dialog.open(Fn,{data:{message:e},disableClose:!0}),this.dialogRef.afterClosed().subscribe(()=>{this.dialogRef=null}))}closeDialog(){this.dialogRef&&(this.dialogRef.close(),this.dialogRef=null)}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this.closeDialog()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I),t.LFG(x.uw))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),Ln=(()=>{class n{constructor(e){this.mismatchPopup=e,this.now=Date.now(),e.init()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Se))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-version-info"]],features:[t._Bn([Se])],decls:3,vars:1,consts:[["target","_blank","alt","version information",3,"href"],["color","primary"]],template:function(e,o){1&e&&(t.TgZ(0,"a",0)(1,"mat-icon",1),t._uU(2,"info"),t.qZA()()),2&e&&t.s9C("href","./assets/version.json?v="+o.now,t.LSH)},directives:[U.Hw],styles:["[_nghost-%COMP%]{display:block;align-self:center;height:24px;width:24px;line-height:36px;color:var(--text-accent-color);background-color:var(--text-accent-color);border-radius:50%;position:absolute;right:1rem}a[_ngcontent-%COMP%]{display:inline-block;height:24px;line-height:24px}"]}),n})();var st=p(9295);const Mn=["resetDialogContent"];function Pn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h2",2)(1,"mat-icon"),t._uU(2,"sync_problem"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3)(6,"p"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"p")(10,"mat-checkbox",4),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().withStorage=i}),t._uU(11),t.ALo(12,"translate"),t.qZA()()(),t.TgZ(13,"div",5)(14,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendFactoryReset()}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"button",7),t._uU(18),t.ALo(19,"translate"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,6,"Fabrik zur\xfccksetzen"),""),t.xp6(4),t.Oqu(t.lcZ(8,8,"Soll die Fabrik wirklich zur\xfcckgesetzt werden?")),t.xp6(3),t.Q6J("ngModel",e.withStorage),t.xp6(1),t.hij(" ",t.lcZ(12,10,"Auch den Lagerbestand leeren?")," "),t.xp6(4),t.Oqu(t.lcZ(16,12,"Ja")),t.xp6(3),t.Oqu(t.lcZ(19,14,"Nein"))}}let wn=(()=>{class n{constructor(e,o){this.dialog=e,this.mqtt=o,this.withStorage=!1}confirmFactoryReset(){this.dialog.open(this.resetDialogContent).afterClosed().pipe((0,st.q)(1)).subscribe(()=>this.clearState())}clearState(){this.withStorage=!1}sendFactoryReset(){const e={timestamp:new Date,withStorage:this.withStorage};this.mqtt.publish(y.SET_RESET,e,{qos:2})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.uw),t.Y36(I))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-factory-reset"]],viewQuery:function(e,o){if(1&e&&t.Gf(Mn,5),2&e){let i;t.iGM(i=t.CRH())&&(o.resetDialogContent=i.first)}},decls:7,vars:6,consts:[["resetDialogContent",""],["mat-mini-fab","","color","primary",1,"action-btn",3,"title","click"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","color","warn",3,"click"],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(e,o){1&e&&(t.YNc(0,Pn,20,16,"ng-template",null,0,t.W1O),t.TgZ(2,"button",1),t.NdJ("click",function(){return o.confirmFactoryReset()}),t.ALo(3,"translate"),t.ALo(4,"translate"),t.TgZ(5,"mat-icon"),t._uU(6,"sync_problem"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("title",t.lcZ(3,2,"Fabrik zur\xfccksetzen")),t.uIk("aria-label",t.lcZ(4,4,"Fabrik zur\xfccksetzen")))},directives:[x.uh,U.Hw,x.xY,jt.oG,L.JJ,L.On,x.H8,E.lW,x.ZT],pipes:[A.X$],styles:["[_nghost-%COMP%]{position:absolute;top:45px;right:20px;z-index:2001}.extended-fab-button[_ngcontent-%COMP%]{width:unset;padding:0 26px;border-radius:29px}.extended-fab-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:10px}.extended-fab-button[_ngcontent-%COMP%]   .extended-fab-button__text[_ngcontent-%COMP%]{font-weight:300;letter-spacing:.1em;text-transform:uppercase}"]}),n})(),In=(()=>{class n{constructor(e,o,i,a){this.mqttService=e,this.translate=o,this.notification=i,this.collisionWarningDetectorService=a,this.destroy$=new J.t(1),this.FutureFactoryRoutes=M,this.mqttService.subscribe(At("NodeRed","status")).pipe(Y(),(0,F.R)(this.destroy$)).subscribe(s=>{s.connectionState===xt.ONLINE?this.notification.dismiss():this.notification.open(this.translate.instant("Die zentrale Steuerung hat die Verbindung zur APS verloren. Bitte starten Sie die zentrale Steuerung neu."),void 0,{duration:0,panelClass:"error-snackbar",horizontalPosition:"center",verticalPosition:"top"})}),a.init()}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(I),t.Y36(A.sK),t.Y36(Ct.ux),t.Y36(be))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-futurefactory"]],features:[t._Bn([be])],decls:36,vars:36,consts:[["mat-tab-nav-bar","","backgroundColor","accent",3,"tabPanel"],["mat-tab-link","","routerLinkActive","active",1,"button",3,"active","routerLink"],["rlaA","routerLinkActive"],["rlaB","routerLinkActive"],["rlaC","routerLinkActive"],["rlaD","routerLinkActive"],["rlaE","routerLinkActive"],["rlaF","routerLinkActive"],["rlaG","routerLinkActive"],["tabPanel",""],[1,"page-content","mat-typography"]],template:function(e,o){if(1&e&&(t.TgZ(0,"nav",0)(1,"a",1,2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"a",1,3),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"a",1,4),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"a",1,5),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"a",1,6),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"a",1,7),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"a",1,8),t._uU(27),t.ALo(28,"translate"),t.qZA(),t._UZ(29,"ff-language-selector")(30,"ff-version-info"),t.qZA(),t._UZ(31,"mat-tab-nav-panel",null,9),t.TgZ(33,"mat-tab-nav-panel",10),t._UZ(34,"ff-factory-reset")(35,"router-outlet"),t.qZA()),2&e){const i=t.MAs(2),a=t.MAs(6),s=t.MAs(10),l=t.MAs(14),d=t.MAs(18),c=t.MAs(22),u=t.MAs(26),g=t.MAs(32);t.Q6J("tabPanel",g),t.xp6(1),t.Q6J("active",i.isActive)("routerLink",o.FutureFactoryRoutes.DASHBOARD),t.xp6(2),t.Oqu(t.lcZ(4,22,"\xdcbersicht")),t.xp6(2),t.Q6J("active",a.isActive)("routerLink",o.FutureFactoryRoutes.ORDERS),t.xp6(2),t.Oqu(t.lcZ(8,24,"Auftr\xe4ge")),t.xp6(2),t.Q6J("active",s.isActive)("routerLink",o.FutureFactoryRoutes.PRODUCTION_FLOWS),t.xp6(2),t.Oqu(t.lcZ(12,26,"Abl\xe4ufe")),t.xp6(2),t.Q6J("active",l.isActive)("routerLink",o.FutureFactoryRoutes.LAYOUT),t.xp6(2),t.Oqu(t.lcZ(16,28,"Konfiguration")),t.xp6(2),t.Q6J("active",d.isActive)("routerLink",o.FutureFactoryRoutes.MODULE),t.xp6(2),t.Oqu(t.lcZ(20,30,"Module")),t.xp6(2),t.Q6J("active",c.isActive)("routerLink",o.FutureFactoryRoutes.SIMULATION),t.xp6(2),t.Oqu(t.lcZ(24,32,"Planspiel")),t.xp6(2),t.Q6J("active",u.isActive)("routerLink",o.FutureFactoryRoutes.LOGS),t.xp6(2),t.Oqu(t.lcZ(28,34,"Meldungen"))}},directives:[tt.BU,Z.yS,tt.Nj,Z.Od,dn,Ln,tt.sW,wn,Z.lC],pipes:[A.X$],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;margin:0;padding:0;overflow:hidden;flex-direction:column}.page-content[_ngcontent-%COMP%]{position:relative;box-sizing:border-box;display:block;flex:1;overflow:auto}a.mat-tab-link.active[_ngcontent-%COMP%]{opacity:1!important}",'@font-face{font-family:Material Icons;font-style:normal;font-weight:400;src:url(material-icons.59322316b3fd6063.woff2) format("woff2")}.material-icons[_ngcontent-%COMP%]{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-cyrillic-ext.cd7c57150098aa46.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-cyrillic.8879841235d1038b.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-greek-ext.bc5ce7039b793526.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-greek.25dc89b086bd298c.woff2) format("woff2");unicode-range:U+0370-03FF}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-vietnamese.b3d3e96016c7cf4b.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-latin-ext.37d4965de9e08156.woff2) format("woff2");unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:swap;src:url(roboto-normal-300-latin.a4eae32d320f45e6.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-cyrillic-ext.d7827ae32eeaf2a2.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-cyrillic.2d9c9d60987f55b3.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-greek-ext.2b547ded99644dd7.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-greek.63e6dc182bc99716.woff2) format("woff2");unicode-range:U+0370-03FF}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-vietnamese.c95fc061f1b36d6b.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-latin-ext.21abc8c8d8fbf6be.woff2) format("woff2");unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:swap;src:url(roboto-normal-400-latin.f2894edcf7d09d36.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-cyrillic-ext.a1b5c90de241a056.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-cyrillic.aa68ea542b48a213.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-greek-ext.7ea6cffa7d138319.woff2) format("woff2");unicode-range:U+1F00-1FFF}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-greek.533b03d2a55a1755.woff2) format("woff2");unicode-range:U+0370-03FF}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-vietnamese.7f8c0554ba06f872.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-latin-ext.85ebfb558a17f059.woff2) format("woff2");unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:swap;src:url(roboto-normal-500-latin.3170fd9aa9258fe0.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}']}),n})();var nt=p(1670),bt=p(4363),f=(()=>{return(n=f||(f={})).DRILL="DRILL",n.START="START",n.MILL="MILL",n.DPS="DPS",n.AIQS="AIQS",n.HBW="HBW",n.OVEN="OVEN",n.CHRG="CHRG",f;var n})();const En=new Set([f.START,f.HBW,f.DPS,f.CHRG]);var P=(()=>{return(n=P||(P={})).DRILL="DRILL",n.MILL="MILL",n.CHECK_QUALITY="CHECK_QUALITY",n.FIRE="FIRE",n.DROP="DROP",n.PICK="PICK",P;var n})();const W=(n,r)=>`${n}_${r}`;W(f.DPS,P.DROP),W(f.AIQS,P.CHECK_QUALITY),W(f.HBW,P.PICK),W(f.HBW,P.DROP),W(f.OVEN,P.FIRE),W(f.MILL,P.MILL),W(f.DRILL,P.DRILL),W(f.DPS,P.PICK),Pt(Q,B.STATE),At(Q,G.STATE);let Rn=(()=>{class n{constructor(e){this.mqttService=e,this.productionFlows$=this.mqttService.subscribe(y.FLOWS).pipe(Y(),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Nn=[f.HBW,f.DPS];let St=(()=>{class n{constructor(e,o){this.mqtt=e,this.factoryStateService=o,this.DIRECTION_UPDATES=[{direction:h.NORTH,inverse:h.SOUTH,xDiff:0,yDiff:-1},{direction:h.EAST,inverse:h.WEST,xDiff:1,yDiff:0},{direction:h.SOUTH,inverse:h.NORTH,xDiff:0,yDiff:1},{direction:h.WEST,inverse:h.EAST,xDiff:-1,yDiff:0}],this.currentGridLayout$=this.mqtt.subscribe(y.LAYOUT).pipe(Y(),(0,m.U)(i=>this.layoutToGridLayout(i)),(0,T.d)(1)),this.pairingState$=this.factoryStateService.pairingState$,this.pairedModules$=this.factoryStateService.pairedModules$,this.pairedFTS$=this.factoryStateService.pairedTransports$}getInverseDirection(e){switch(e){case h.EAST:return h.WEST;case h.WEST:return h.EAST;case h.NORTH:return h.SOUTH;case h.SOUTH:return h.NORTH}}isLargeModule(e){return Nn.includes(e)}layoutToGridLayout(e){const{modules:o,intersections:i,roads:a}=e,s=this.createPositionedRoadTiles(i,a),l=this.createModuleTiles(o);this.positionModuleTiles(l,s,a);const d=[...Array.from(s.values()),...Array.from(l.values())];return this.moveToPositivePositions(d),d}moveToPositivePositions(e){const o=e.reduce((i,a)=>(i.x=a.x<i.x?a.x:i.x,i.y=a.y<i.y?a.y:i.y,i),{x:0,y:0});e.forEach(i=>{i.x=i.x-o.x,i.y=i.y-o.y})}positionModuleTiles(e,o,i){for(const a of i){const s=e.get(a.from),l=e.get(a.to);if(s){const d=o.get(a.to);if(s&&d){s.direction=a.direction,s.intersection=d.id;const c=this.DIRECTION_UPDATES.find(u=>u.inverse===a.direction);c&&(s.x=d.x+c.xDiff,s.y=d.y+c.yDiff,d.road[c.direction]=s.id)}}else if(l){const d=o.get(a.from);if(l&&d){const c=this.DIRECTION_UPDATES.find(u=>u.direction===a.direction);c&&(l.x=d.x+c.xDiff,l.y=d.y+c.yDiff,l.direction=c.inverse),d.road[a.direction]=l.id,l.intersection=d.id}}}}createModuleTiles(e){const o=new Map;return e.forEach(i=>o.set(i.serialNumber,{type:"MODULE",id:i.serialNumber,x:0,y:0,direction:i.type===f.DPS?h.WEST:h.EAST,connected:!1,moduleType:i.type,placeholder:i.placeholder})),o}createPositionedRoadTiles(e,o){const i=new Set,a=new Map;if(!e.length)return a;e.forEach(d=>a.set(d.id,{type:"ROAD",id:d.id,x:0,y:0,road:{}}));for(const d of o){const c=a.get(d.from),u=a.get(d.to);c&&u&&(c.road[d.direction]=u.id,u.road[this.getInverseDirection(d.direction)]=c.id)}const l=[a.get(e[0].id)];for(;l.length>0;){const d=l.pop();for(const c of this.DIRECTION_UPDATES){const u=d.road[c.direction];if(u&&!i.has(u)){i.add(u);const g=a.get(u);g&&(g.x=d.x+c.xDiff,g.y=d.y+c.yDiff,l.push(g))}}}return a}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I),t.LFG(K))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var vt=p(732),Dn=p(6646);const lt={fts:Pt(Q,B.STATE),module:At(Q,G.STATE),order:y.ORDER_RESPONSE};let ct=(()=>{class n{constructor(e){this.mqttService=e,this.buildOrderStatus=(s,l)=>{var d,c,u;const g=Object.assign({},s);let b,Qt,Yt;if(l){if(vt.KZ.filterMatchesTopic(lt.fts,l.topic)){const w=l.payload;b=w.orderId,w.actionState&&(Yt=new Date(w.actionState.timestamp),Qt=`FTS ${w.serialNumber}: ${w.actionState.state}`)}else if(vt.KZ.filterMatchesTopic(lt.module,l.topic)){const w=l.payload;b=w.orderId,w.actionState&&(Yt=new Date(w.actionState.timestamp),Qt=`Module ${w.serialNumber}: ${w.actionState.command} ${w.actionState.state}`)}else if(vt.KZ.filterMatchesTopic(lt.order,l.topic)){const w=l.payload;b=w.orderId,Yt=new Date(w.timestamp),Qt=`Order created: ${w.orderId} ${w.type}`}if(b){const w=null===(d=s[b])||void 0===d?void 0:d.current,hs=w?[w,...null===(c=s[b])||void 0===c?void 0:c.log]:(null===(u=s[b])||void 0===u?void 0:u.log)||[];g[b]={current:Qt||"Unknown",lastTimestamp:Yt||new Date,log:hs}}}return g};const o=this.mqttService.subscribe(lt.fts),i=this.mqttService.subscribe(lt.module),a=this.mqttService.subscribe(lt.order);this.orderStatus$=(0,Dn.T)(o,i,a).pipe((0,yt.R)(this.buildOrderStatus,{}),(0,T.d)(1)),this.activeOrders$=this.listenForActiveOrders(),this.completedOrders$=this.listenForCompletedOrders(),this.hasRunningOrders$=this.setupHasRunningOrders(this.activeOrders$)}listenForActiveOrders(){return this.mqttService.subscribe(y.ACTIVE_ORDERS).pipe(Y(),(0,T.d)(1))}listenForCompletedOrders(){return this.mqttService.subscribe(y.COMPLETED_ORDERS).pipe(Y(),(0,T.d)(1))}setupHasRunningOrders(e){return e.pipe((0,D.O)([]),(0,m.U)(o=>(null!=o?o:[]).length>0),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ze=(()=>{class n{constructor(e){this.controllerService=e,this.factoryControllers$=this.controllerService.availableFutureFactoryControllers$,this.hasController$=this.setupHasController(this.factoryControllers$,this.controllerService.selectedController$)}setupHasController(e,o){return e.pipe((0,te.M)(o),(0,m.U)(([i,a])=>!!a||i.length>0),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(ee))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();function kn(n,r){1&n&&t.Hsn(0,0,["*ngSwitchCase","true"])}function qn(n,r){1&n&&(t.TgZ(0,"div",3)(1,"h1"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"Controller for the Agile Production Simulation is not connected")))}const $n=["*"];let ut=(()=>{class n{constructor(e){this.state=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Ze))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-missing-controller-banner"]],features:[t._Bn([Ze])],ngContentSelectors:$n,decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],["class","missing-controller-banner",4,"ngSwitchDefault"],[1,"missing-controller-banner"]],template:function(e,o){1&e&&(t.F$t(),t.ynx(0,0),t.ALo(1,"async"),t.YNc(2,kn,1,0,"ng-content",1),t.YNc(3,qn,4,3,"div",2),t.BQk()),2&e&&(t.Q6J("ngSwitch",t.lcZ(1,2,o.state.hasController$)),t.xp6(2),t.Q6J("ngSwitchCase",!0))},directives:[_.RF,_.n9,_.ED],pipes:[_.Ov,A.X$],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column}.missing-controller-banner[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;align-items:center;justify-content:center;height:5rem;width:100%;margin:1rem 2rem 0;background:var(--warn-lighter-color);border:3px solid var(--warn-color);border-radius:1rem}.missing-controller-banner[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}"],changeDetection:0}),n})();function Jn(n,r){1&n&&(t.O4$(),t.TgZ(0,"svg",26),t._UZ(1,"path",27),t.qZA())}function Qn(n,r){if(1&n&&(t.TgZ(0,"section",28),t.ALo(1,"async"),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&n){const e=r.$implicit,o=t.oxw();t.ekj("blocked",t.lcZ(1,4,o.hasRunningOrders$)),t.Q6J("cdkDragData",e),t.xp6(3),t.Oqu(t.lcZ(4,6,"Produktionsschritt."+e))}}function Yn(n,r){1&n&&t.GkF(0)}function Hn(n,r){1&n&&t.GkF(0)}function Bn(n,r){1&n&&t.GkF(0)}function Gn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section",29),t.ALo(1,"async"),t._UZ(2,"img",30),t.ALo(3,"translate"),t.TgZ(4,"h3"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"span",31)(8,"button",32),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return s.deleteStepAtIndex(a,s.blueSteps)}),t.ALo(9,"translate"),t.ALo(10,"async"),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()()}if(2&n){const e=r.$implicit,o=t.oxw();t.ekj("blocked",t.lcZ(1,8,o.hasRunningOrders$)),t.Q6J("cdkDragData",e),t.xp6(2),t.Q6J("src","assets/images/ic_ft_"+e.toLowerCase()+".svg",t.LSH),t.uIk("alt",t.lcZ(3,10,"Produktionsschritt."+e)),t.xp6(3),t.Oqu(t.lcZ(6,12,"Produktionsschritt."+e)),t.xp6(3),t.Q6J("disabled",t.lcZ(10,16,o.hasRunningOrders$)),t.uIk("aria-label",t.lcZ(9,14,"L\xf6schen"))}}function Wn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section",29),t.ALo(1,"async"),t._UZ(2,"img",30),t.ALo(3,"translate"),t.TgZ(4,"h3"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"span",31)(8,"button",32),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return s.deleteStepAtIndex(a,s.redSteps)}),t.ALo(9,"translate"),t.ALo(10,"async"),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()()}if(2&n){const e=r.$implicit,o=t.oxw();t.ekj("blocked",t.lcZ(1,8,o.hasRunningOrders$)),t.Q6J("cdkDragData",e),t.xp6(2),t.Q6J("src","assets/images/ic_ft_"+e.toLowerCase()+".svg",t.LSH),t.uIk("alt",t.lcZ(3,10,"Produktionsschritt."+e)),t.xp6(3),t.Oqu(t.lcZ(6,12,"Produktionsschritt."+e)),t.xp6(3),t.Q6J("disabled",t.lcZ(10,16,o.hasRunningOrders$)),t.uIk("aria-label",t.lcZ(9,14,"L\xf6schen"))}}function Vn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section",29),t.ALo(1,"async"),t._UZ(2,"img",30),t.ALo(3,"translate"),t.TgZ(4,"h3"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"span",31)(8,"button",32),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return s.deleteStepAtIndex(a,s.whiteSteps)}),t.ALo(9,"translate"),t.ALo(10,"async"),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()()}if(2&n){const e=r.$implicit,o=t.oxw();t.ekj("blocked",t.lcZ(1,8,o.hasRunningOrders$)),t.Q6J("cdkDragData",e),t.xp6(2),t.Q6J("src","assets/images/ic_ft_"+e.toLowerCase()+".svg",t.LSH),t.uIk("alt",t.lcZ(3,10,"Produktionsschritt."+e)),t.xp6(3),t.Oqu(t.lcZ(6,12,"Produktionsschritt."+e)),t.xp6(3),t.Q6J("disabled",t.lcZ(10,16,o.hasRunningOrders$)),t.uIk("aria-label",t.lcZ(9,14,"L\xf6schen"))}}function jn(n,r){1&n&&t.GkF(0)}function zn(n,r){1&n&&t.GkF(0)}function Kn(n,r){1&n&&t.GkF(0)}const Ut=function(n,r,e){return[n,r,e]},Xn={[k.BLUE]:[f.AIQS,f.MILL,f.DRILL,f.OVEN],[k.RED]:[f.AIQS,f.MILL,f.OVEN],[k.WHITE]:[f.AIQS,f.DRILL,f.OVEN]},to=[f.AIQS,f.MILL,f.DRILL,f.OVEN];let eo=(()=>{class n{constructor(e,o,i,a,s,l){this.productionFlowsService=e,this.layout=o,this.orderStates=i,this.mqtt=a,this.translate=s,this.notification=l,this.destroyed$=new J.t(1),this.productionFlows={},this.Workpiece=k,this.availableModulesId="available-modules",this.modified=!1,this.extendedFlows=!1,this.enterPredicate__bound=this.enterPredicate.bind(this),this.blueSteps=[],this.redSteps=[],this.whiteSteps=[],e.productionFlows$.pipe((0,F.R)(this.destroyed$)).subscribe(c=>{this.productionFlows=c,this.resetFlows()});const d=c=>c.pairedSince&&c.subType&&!En.has(c.subType);this.availableTypes$=o.pairedModules$.pipe((0,m.U)(c=>c.filter(d).map(u=>u.subType))),this.selectableTypes$=this.availableTypes$.pipe((0,m.U)(c=>[...new Set(null!=c?c:[])])),this.hasRunningOrders$=this.orderStates.hasRunningOrders$}resetFlows(){var e,o,i;this.modified=!1;const a=JSON.parse(JSON.stringify(this.productionFlows));this.modified||(this.blueSteps=(null===(e=a.BLUE)||void 0===e?void 0:e.steps)||[],this.redSteps=(null===(o=a.RED)||void 0===o?void 0:o.steps)||[],this.whiteSteps=(null===(i=a.WHITE)||void 0===i?void 0:i.steps)||[])}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}enterPredicate(e,o){var i;const a=this.extendedFlows?to:null!==(i=Xn[o.id])&&void 0!==i?i:[],s=e.data===f.AIQS&&o.data.includes(f.AIQS);return!(!a.includes(e.data)||s)}sortPredicate(e,o,i){const a=[...i.data];return(0,X.bA)(a,e,i.data.indexOf(o.data)),o.data===f.AIQS?e===a.length:!(a[e+1]===o.data||a[e-1]===o.data||a[e-1]===f.AIQS)}drop(e){e.previousIndex===e.currentIndex&&e.previousContainer===e.container||(this.modified=!0,e.previousContainer===e.container?(0,X.bA)(e.container.data,e.previousIndex,e.currentIndex):e.previousContainer.id===this.availableModulesId?e.container.data.splice(e.currentIndex,0,e.item.data):(0,X.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.ensureChainConsistency(e.container.data))}ensureChainConsistency(e){const o=e.length-1,i=e.indexOf(f.AIQS);-1!==i&&i!==o&&(e.splice(o,0,e.splice(i,1)[0]),this.notification.open(this.translate.instant("AIQS muss immer am Ende der Kette stehen"),this.translate.instant("OK"),{duration:5e3}));let a=0;for(;a<e.length-1;)e[a]===e[a+1]?(e.splice(a,1),this.notification.open(this.translate.instant("Ein Produktionsschritt wurde entfernt, da dieser direkt auf sich selbst folgte."),this.translate.instant("OK"),{duration:5e3})):a++}deleteStepAtIndex(e,o){this.modified=!0,o.splice(e,1),this.ensureChainConsistency(o)}saveFlows(){var e=this;return(0,nt.Z)(function*(){if(yield(0,bt.z)(e.hasRunningOrders$))return;const i={BLUE:{steps:[...e.blueSteps]},RED:{steps:[...e.redSteps]},WHITE:{steps:[...e.whiteSteps]}};e.modified=!1,e.mqtt.publish(y.SET_FLOWS,i,{qos:2})})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Rn),t.Y36(St),t.Y36(ct),t.Y36(I),t.Y36(A.sK),t.Y36(Ct.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-flow-editor"]],decls:94,vars:132,consts:[["flowsConnector",""],["id","flows-configuration"],[1,"heading"],[1,"flows-actions"],[3,"disabled"],["add_toggle",""],["mat-raised-button","",3,"disabled","matTooltip","click"],["mat-raised-button","",3,"matTooltip","disabled","click"],[3,"disabled","ngModel","ngModelChange"],[1,"workpiece__steps"],["cdkDropList","","cdkDropListSortingDisabled","",1,"modules-list",3,"id","cdkDropListDisabled","cdkDropListConnectedTo"],["class","module-item","cdkDrag","",3,"blocked","cdkDragData",4,"ngFor","ngForOf"],[1,"workpiece__flows"],[1,"flows-start"],[4,"ngTemplateOutlet"],[1,"workpiece__flows__steps"],["mat-card-avatar","","src","assets/images/ic_ft_workpiece_blue.svg",1,"workpiece--icon"],[1,"workpiece--name"],["src","assets/images/drilled+milled.svg",1,"workpiece__finished"],["cdkDropList","",1,"step-list",3,"id","cdkDropListData","cdkDropListDisabled","cdkDropListConnectedTo","cdkDropListEnterPredicate","cdkDropListSortPredicate","cdkDropListDropped"],["class","step-item","cdkDrag","",3,"blocked","cdkDragData",4,"ngFor","ngForOf"],["mat-card-avatar","","src","assets/images/ic_ft_workpiece_red.svg",1,"workpiece--icon"],["src","assets/images/milled.svg",1,"workpiece__finished"],["mat-card-avatar","","src","assets/images/ic_ft_workpiece_white.svg",1,"workpiece--icon"],["src","assets/images/drilled.svg",1,"workpiece__finished"],[1,"flows-end"],["viewBox","0 0 100 20","xmlns","http://www.w3.org/2000/svg"],["fill","var(--accent-color)","stroke","var(--accent-color)","d","M0,0 L100,0 L50,19 L0,0"],["cdkDrag","",1,"module-item",3,"cdkDragData"],["cdkDrag","",1,"step-item",3,"cdkDragData"],[1,"step-item__icon",3,"src"],[1,"buttons","push"],["mat-icon-button","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.YNc(0,Jn,2,0,"ng-template",null,0,t.W1O),t.TgZ(2,"ff-missing-controller-banner")(3,"div",1)(4,"h2",2),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"section",3)(8,"mat-button-toggle",4,5),t.ALo(10,"translate"),t.ALo(11,"async"),t.TgZ(12,"mat-icon"),t._uU(13,"add_circle"),t.qZA()(),t.TgZ(14,"button",6),t.NdJ("click",function(){return o.saveFlows()}),t.ALo(15,"async"),t.ALo(16,"translate"),t.ALo(17,"translate"),t.TgZ(18,"mat-icon"),t._uU(19,"save"),t.qZA()(),t.TgZ(20,"button",7),t.NdJ("click",function(){return o.resetFlows()}),t.ALo(21,"translate"),t.ALo(22,"translate"),t.TgZ(23,"mat-icon"),t._uU(24,"refresh"),t.qZA()(),t.TgZ(25,"mat-slide-toggle",8),t.NdJ("ngModelChange",function(a){return o.extendedFlows=a}),t.ALo(26,"translate"),t.ALo(27,"async"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t.TgZ(30,"section",9)(31,"mat-card")(32,"mat-card-title"),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"mat-card-content")(36,"div",10),t.ALo(37,"async"),t.YNc(38,Qn,5,8,"section",11),t.ALo(39,"async"),t.qZA()()()(),t.TgZ(40,"section",12)(41,"section",13)(42,"h2"),t._uU(43),t.ALo(44,"translate"),t.qZA()(),t.YNc(45,Yn,1,0,"ng-container",14),t.YNc(46,Hn,1,0,"ng-container",14),t.YNc(47,Bn,1,0,"ng-container",14),t.TgZ(48,"mat-card",15)(49,"mat-card-header"),t._UZ(50,"img",16),t.ALo(51,"translate"),t.TgZ(52,"mat-card-title",17),t._uU(53),t.ALo(54,"translate"),t.qZA(),t._UZ(55,"img",18),t.ALo(56,"translate"),t.qZA(),t.TgZ(57,"mat-card-content")(58,"div",19),t.NdJ("cdkDropListDropped",function(a){return o.drop(a)}),t.ALo(59,"async"),t.YNc(60,Gn,13,18,"section",20),t.qZA()()(),t.TgZ(61,"mat-card",15)(62,"mat-card-header"),t._UZ(63,"img",21),t.ALo(64,"translate"),t.TgZ(65,"mat-card-title",17),t._uU(66),t.ALo(67,"translate"),t.qZA(),t._UZ(68,"img",22),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"mat-card-content")(71,"div",19),t.NdJ("cdkDropListDropped",function(a){return o.drop(a)}),t.ALo(72,"async"),t.YNc(73,Wn,13,18,"section",20),t.qZA()()(),t.TgZ(74,"mat-card",15)(75,"mat-card-header"),t._UZ(76,"img",23),t.ALo(77,"translate"),t.TgZ(78,"mat-card-title",17),t._uU(79),t.ALo(80,"translate"),t.qZA(),t._UZ(81,"img",24),t.ALo(82,"translate"),t.qZA(),t.TgZ(83,"mat-card-content")(84,"div",19),t.NdJ("cdkDropListDropped",function(a){return o.drop(a)}),t.ALo(85,"async"),t.YNc(86,Vn,13,18,"section",20),t.qZA()()(),t.YNc(87,jn,1,0,"ng-container",14),t.YNc(88,zn,1,0,"ng-container",14),t.YNc(89,Kn,1,0,"ng-container",14),t.TgZ(90,"section",25)(91,"h2"),t._uU(92),t.ALo(93,"translate"),t.qZA()()()()()),2&e){const i=t.MAs(1),a=t.MAs(9);t.xp6(5),t.hij(" ",t.lcZ(6,60,"Bearbeitungsschritte")," "),t.xp6(3),t.Q6J("disabled",t.lcZ(11,64,o.hasRunningOrders$)),t.uIk("aria-label",t.lcZ(10,62,"Bearbeitungsschritt hinzuf\xfcgen")),t.xp6(6),t.Q6J("disabled",t.lcZ(15,66,o.hasRunningOrders$)||!o.modified)("matTooltip",t.lcZ(17,70,"Speichern")),t.uIk("aria-label",t.lcZ(16,68,"Speichern")),t.xp6(6),t.Q6J("matTooltip",t.lcZ(22,74,"Zur\xfccksetzen"))("disabled",!o.modified),t.uIk("aria-label",t.lcZ(21,72,"Zur\xfccksetzen")),t.xp6(5),t.Udp("margin-left",16,"px"),t.Q6J("disabled",t.lcZ(27,78,o.hasRunningOrders$))("ngModel",o.extendedFlows),t.uIk("aria-label",t.lcZ(26,76,"Erweiterte Bearbeitungsschritte aktivieren")),t.xp6(3),t.hij(" ",t.lcZ(29,80,"Erweiterte Bearbeitungsschritte aktivieren")," "),t.xp6(2),t.Udp("display",a.checked?"block":"none"),t.xp6(3),t.hij(" ",t.lcZ(34,82,"Vorhandene Produktionsmodule")," "),t.xp6(3),t.Q6J("id",o.availableModulesId)("cdkDropListDisabled",t.lcZ(37,84,o.hasRunningOrders$))("cdkDropListConnectedTo",t.kEZ(116,Ut,o.Workpiece.BLUE,o.Workpiece.RED,o.Workpiece.WHITE)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(39,86,o.selectableTypes$)),t.xp6(5),t.Oqu(t.lcZ(44,88,"Auslagern aus Hochregallager")),t.xp6(2),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(3),t.uIk("alt",t.lcZ(51,90,"Werkst\xfcck.Blau")),t.xp6(3),t.hij(" ",t.lcZ(54,92,"Werkst\xfcck.Blau")," "),t.xp6(2),t.uIk("alt",t.lcZ(56,94,"Fertiges Werkst\xfcck")),t.xp6(3),t.Q6J("id",o.Workpiece.BLUE)("cdkDropListData",o.blueSteps)("cdkDropListDisabled",t.lcZ(59,96,o.hasRunningOrders$))("cdkDropListConnectedTo",t.kEZ(120,Ut,o.availableModulesId,o.Workpiece.RED,o.Workpiece.WHITE))("cdkDropListEnterPredicate",o.enterPredicate__bound)("cdkDropListSortPredicate",o.sortPredicate),t.xp6(2),t.Q6J("ngForOf",o.blueSteps),t.xp6(3),t.uIk("alt",t.lcZ(64,98,"Werkst\xfcck.Rot")),t.xp6(3),t.hij(" ",t.lcZ(67,100,"Werkst\xfcck.Rot")," "),t.xp6(2),t.uIk("alt",t.lcZ(69,102,"Fertiges Werkst\xfcck")),t.xp6(3),t.Q6J("id",o.Workpiece.RED)("cdkDropListData",o.redSteps)("cdkDropListDisabled",t.lcZ(72,104,o.hasRunningOrders$))("cdkDropListConnectedTo",t.kEZ(124,Ut,o.availableModulesId,o.Workpiece.BLUE,o.Workpiece.WHITE))("cdkDropListEnterPredicate",o.enterPredicate__bound)("cdkDropListSortPredicate",o.sortPredicate),t.xp6(2),t.Q6J("ngForOf",o.redSteps),t.xp6(3),t.uIk("alt",t.lcZ(77,106,"Werkst\xfcck.Wei\xdf")),t.xp6(3),t.hij(" ",t.lcZ(80,108,"Werkst\xfcck.Wei\xdf")," "),t.xp6(2),t.uIk("alt",t.lcZ(82,110,"Fertiges Werkst\xfcck")),t.xp6(3),t.Q6J("id",o.Workpiece.WHITE)("cdkDropListData",o.whiteSteps)("cdkDropListDisabled",t.lcZ(85,112,o.hasRunningOrders$))("cdkDropListConnectedTo",t.kEZ(128,Ut,o.availableModulesId,o.Workpiece.BLUE,o.Workpiece.RED))("cdkDropListEnterPredicate",o.enterPredicate__bound)("cdkDropListSortPredicate",o.sortPredicate),t.xp6(2),t.Q6J("ngForOf",o.whiteSteps),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(3),t.Oqu(t.lcZ(93,114,"Auslieferung \xfcber Warenausgang"))}},directives:[ut,Ft.Yi,U.Hw,E.lW,Lt.gM,Kt.Rr,L.JJ,L.On,S.a8,S.n5,S.dn,X.Wj,_.sg,X.Zt,_.tP,S.dk,S.kc],pipes:[A.X$,_.Ov],styles:["#flows-configuration[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;margin:10px}  .mat-card-content{height:calc(100% - 3rem)}.mat-icon[_ngcontent-%COMP%]{line-height:24px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;border:1px dashed var(--accent-color);background:var(--accent-color);color:var(--text-primary-color);cursor:grabbing}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.flows-actions[_ngcontent-%COMP%]{margin-bottom:1rem}.workpiece__finished[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:1.25rem;height:3rem;width:3rem}.workpiece__steps[_ngcontent-%COMP%]{box-sizing:border-box;width:50dvw;margin-bottom:1rem;border:3px solid var(--accent-color)}.modules-list[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:row;box-sizing:border-box;margin-top:.5rem!important}.modules-list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{margin-left:0}.modules-list.cdk-drop-list-dragging[_ngcontent-%COMP%]{background-color:#00000014}.modules-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .module-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.module-item[_ngcontent-%COMP%]{box-sizing:border-box;height:3rem;display:flex;align-items:center;border:1px solid var(--accent-color);margin-left:.5rem;padding:0 1rem}.module-item[_ngcontent-%COMP%]:hover{cursor:grab}.module-item.blocked[_ngcontent-%COMP%]:hover{cursor:not-allowed}.module-item.cdk-drag-placeholder[_ngcontent-%COMP%]{margin:0;opacity:0}.module-item[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{margin:0}.workpiece__flows[_ngcontent-%COMP%]{display:grid;grid-template:repeat(2,auto) repeat(3,fit-content) repeat(2,auto);grid-template-columns:repeat(3,minmax(max-content,1fr));grid-column-gap:.5rem;column-gap:.5rem;width:50dvw}.workpiece__flows__steps[_ngcontent-%COMP%]{border:3px solid var(--accent-color);border-bottom:0;border-radius:0}.workpiece--icon[_ngcontent-%COMP%]{border-radius:0;width:3rem}.workpiece--name[_ngcontent-%COMP%]{margin-top:.6rem}.flows-start[_ngcontent-%COMP%], .flows-end[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex:1 1 auto;flex-direction:column;align-items:center;justify-content:center;padding:1rem;color:var(--accent-color);border:3px solid var(--accent-color)}.flows-start[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%], .flows-end[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{margin:0}.flows-start[_ngcontent-%COMP%], .flows-end[_ngcontent-%COMP%]{grid-column:1/span 3}.step-list[_ngcontent-%COMP%]{display:block;box-sizing:border-box;overflow:hidden;margin-top:.5rem!important;min-height:6rem;height:100%}.step-list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{margin-top:0}.step-list.cdk-drop-list-dragging[_ngcontent-%COMP%]{background-color:#00000014}.step-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .step-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.step-item[_ngcontent-%COMP%]{box-sizing:border-box;height:3rem;display:grid;grid-template-columns:40px 1fr 40px;grid-template-rows:1fr;grid-gap:.5rem;gap:.5rem;margin-top:.5rem;padding:0 .5rem 0 1rem;border:1px solid var(--accent-color);align-items:center}.step-item[_ngcontent-%COMP%]:hover{cursor:grab}.step-item.blocked[_ngcontent-%COMP%]:hover{cursor:not-allowed}.step-item.cdk-drag-placeholder[_ngcontent-%COMP%]{margin:0;opacity:0}.step-item[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{margin:0}"]}),n})();var dt=p(6886);function oe(n){return n.data.pipe((0,m.U)(r=>{var e;return`${null!==(e=r[q])&&void 0!==e?e:"."}`}))}const Fe={[f.AIQS]:"assets/images/ic_ft_aiqs.svg",[f.HBW]:"assets/images/ic_ft_hbw.svg",[f.DPS]:"assets/images/ic_ft_dps.svg",[f.DRILL]:"assets/images/ic_ft_drill.svg",[f.MILL]:"assets/images/ic_ft_mill.svg",[f.CHRG]:"assets/images/ic_ft_chrg.svg",[f.OVEN]:"assets/images/ic_ft_oven.svg",[f.START]:"assets/images/placeholder.svg",MODULE:"assets/images/placeholder.svg",FTS:"assets/images/ic_ft_fts.svg",UNDEFINED:"assets/images/placeholder.svg",undefined:"assets/images/placeholder.svg"};var Rt=p(253);let ro=(()=>{class n{constructor(e){this.layoutService=e,this.NEXT_DIRECTIONS_CLOCKWISE={[h.NORTH]:h.EAST,[h.EAST]:h.SOUTH,[h.SOUTH]:h.WEST,[h.WEST]:h.NORTH},this.DIRECTION_UPDATES=[{direction:h.NORTH,inverse:h.SOUTH,xDiff:0,yDiff:-1},{direction:h.EAST,inverse:h.WEST,xDiff:1,yDiff:0},{direction:h.SOUTH,inverse:h.NORTH,xDiff:0,yDiff:1},{direction:h.WEST,inverse:h.EAST,xDiff:-1,yDiff:0}],this.EXTRA_TILE_OFFSETS_FOR_MODULES={[f.DPS]:{[h.NORTH]:{x:0,y:0,cols:2,rows:1},[h.EAST]:{x:0,y:0,cols:1,rows:2},[h.SOUTH]:{x:-1,y:0,cols:2,rows:1},[h.WEST]:{x:0,y:-1,cols:1,rows:2}},[f.HBW]:{[h.NORTH]:{x:-1,y:0,cols:2,rows:1},[h.EAST]:{x:0,y:-1,cols:1,rows:2},[h.SOUTH]:{x:0,y:0,cols:2,rows:1},[h.WEST]:{x:0,y:0,cols:1,rows:2}}},this.grid=[],this._modified=!1,this.destroyed$=new Rt.x,this.gridSubject=new H.X([]),this.editorGrid$=this.gridSubject.asObservable(),this.baseLayout=[],this.layoutService.currentGridLayout$.subscribe(o=>{this.baseLayout=o,this.updateEditorGrid(o)}),this.availableModules$=this._getAvailableModules(this.layoutService.pairedModules$.pipe((0,D.O)([])),this.editorGrid$,this.layoutService.currentGridLayout$)}get modified(){return this._modified}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}_getAvailableModules(e,o,i){return(0,et.a)([e,o,i]).pipe((0,m.U)(([s,l,d])=>{const c=d.filter(g=>"MODULE"===g.type),u=[...s];for(const g of c)u.find(b=>b.serialNumber===g.id)||u.push({type:"MODULE",subType:g.moduleType,connected:!1,serialNumber:g.id});return u.filter(g=>"MODULE"===g.type&&!l.find(b=>b.tile.id===g.serialNumber))}),(0,T.d)(1))}isLargeModule(e){return this.layoutService.isLargeModule(e)}hasGridItemId(e){return null!=this.grid.find(o=>o.tile.id===e)}updateEditorGrid(e){var o;if(!this._modified){this.grid=this.grid.filter(i=>e.find(a=>a.id===i.tile.id));for(const i of e){const a=this.grid.find(u=>u.tile.id===i.id);let s=0,l=0,d=1,c=1;if("MODULE"===i.type){const u=null===(o=this.EXTRA_TILE_OFFSETS_FOR_MODULES[i.moduleType])||void 0===o?void 0:o[i.direction];u&&(s=u.x,l=u.y,d=u.rows,c=u.cols)}a?(a.tile=JSON.parse(JSON.stringify(i)),a.x=i.x+s,a.y=i.y+l,a.rows=d,a.cols=c):this.grid.push({tile:JSON.parse(JSON.stringify(i)),x:i.x+s,y:i.y+l,rows:d,cols:c,resizeEnabled:!1})}this.moveToPositiveCoordinates(this.grid),this.gridSubject.next(this.grid)}}moveToPositiveCoordinates(e){const o=e.reduce((a,s)=>Math.min(s.x,a),0),i=e.reduce((a,s)=>Math.min(s.y,a),0);for(const a of e)a.x-=o,a.y-=i,a.tile.x-=o,a.tile.y-=i}resetLayout(){this.grid=[],this._modified=!1,this.updateEditorGrid(this.baseLayout)}getNextId(){const e=this.grid.filter(o=>"ROAD"===o.tile.type).map(o=>Number(o.tile.id));return e.length?String(Math.max(...e)+1):"1"}getGridItemAtTilePosition(e,o){return this.grid.find(i=>i.tile.x===e&&i.tile.y===o)}hasOverlappingItem(e){return this.grid.find(o=>!(o.x>=e.x+e.cols||o.x+o.cols<=e.x||o.y>=e.y+e.rows||o.y+o.rows<=e.y)&&e!==o)}deleteGridItem(e){this._modified=!0,this.clearItemAssociations(e),this.grid=this.grid.filter(o=>o!==e),this.gridSubject.next(this.grid)}clearItemAssociations(e){for(const o of this.grid)if(o!==e&&"MODULE"===o.tile.type&&o.tile.intersection===e.tile.id)o.tile.intersection=void 0;else if(o!==e&&"ROAD"===o.tile.type){const i=o.tile.road;for(const a of Object.keys(i))i[a]===e.tile.id&&(i[a]=void 0)}}updateMovedGridItem(e){var o;if(this._modified=!0,e.tile.x=e.x,e.tile.y=e.y,"MODULE"===e.tile.type){const i=null===(o=this.EXTRA_TILE_OFFSETS_FOR_MODULES[e.tile.moduleType])||void 0===o?void 0:o[e.tile.direction];i&&(e.tile.x-=i.x,e.tile.y-=i.y)}this.clearItemAssociations(e),"ROAD"===e.tile.type?this.rebuildConnectionsForRoad(e):"MODULE"===e.tile.type&&this.rebuildConnectionsForModule(e),this.moveToPositiveCoordinates(this.grid),this.gridSubject.next(this.grid)}rebuildConnectionsForModule(e){var o;if("MODULE"!==e.tile.type)return;e.tile.intersection=void 0;const i=e.tile.direction,a=Math.max(0,this.DIRECTION_UPDATES.findIndex(s=>s.direction===i));for(let s=0;s<this.DIRECTION_UPDATES.length&&!e.tile.intersection;++s){const l=this.DIRECTION_UPDATES[(s+a)%this.DIRECTION_UPDATES.length],u=this.getGridItemAtTilePosition(e.tile.x+l.xDiff,e.tile.y+l.yDiff);if(u&&"ROAD"===u.tile.type){e.tile.direction=l.direction;const g=null===(o=this.EXTRA_TILE_OFFSETS_FOR_MODULES[e.tile.moduleType])||void 0===o?void 0:o[l.direction];g&&(e.x=e.tile.x+g.x,e.y=e.tile.y+g.y,e.rows=g.rows,e.cols=g.cols,console.log(g)),this.hasOverlappingItem(e)||(e.tile.intersection=u.tile.id,u.tile.road[l.inverse]=e.tile.id);break}}}rebuildConnectionsForRoad(e){var o;if("ROAD"===e.tile.type){e.tile.road.NORTH=void 0,e.tile.road.EAST=void 0,e.tile.road.SOUTH=void 0,e.tile.road.WEST=void 0;for(const i of this.DIRECTION_UPDATES){const a=this.getGridItemAtTilePosition(e.tile.x+i.xDiff,e.tile.y+i.yDiff);if(a)if(e.tile.road[i.direction]=a.tile.id,"ROAD"===a.tile.type)a.tile.road[i.inverse]=e.tile.id;else if("MODULE"===a.tile.type&&!a.tile.intersection){const s=null===(o=this.EXTRA_TILE_OFFSETS_FOR_MODULES[a.tile.moduleType])||void 0===o?void 0:o[i.inverse],l=a.x,d=a.y,c=a.rows,u=a.cols;s&&(a.x=a.tile.x+s.x,a.y=a.tile.y+s.y,a.rows=s.rows,a.cols=s.cols,console.log(s)),this.hasOverlappingItem(a)?(a.x=l,a.y=d,a.rows=c,a.cols=u):(a.tile.direction=i.inverse,a.tile.intersection=e.tile.id)}}}}addItem(e){this.grid=[...this.grid,e],this.updateMovedGridItem(e)}rotateModuleConnection(e){var o;if(console.log("olditem",e),"MODULE"===e.tile.type){const i=e.tile.direction,s=(this.DIRECTION_UPDATES.findIndex(d=>d.direction===i)+1)%this.DIRECTION_UPDATES.length;e.tile.direction=this.DIRECTION_UPDATES[s].direction;const l=null===(o=this.EXTRA_TILE_OFFSETS_FOR_MODULES[e.tile.moduleType])||void 0===o?void 0:o[e.tile.direction];l&&(e.rows=l.rows,e.cols=l.cols,e.x=e.tile.x+l.x,e.y=e.tile.y+l.y),console.log(l),console.log(e),this.updateMovedGridItem(e)}}convertGridLayoutToLayout(e){const o={modules:[],intersections:[],roads:[]};for(const i of e)switch(i.type){case"MODULE":o.modules.push({type:i.moduleType,serialNumber:i.id,placeholder:i.placeholder}),i.intersection&&o.roads.push({direction:i.direction,from:i.id,to:i.intersection,length:i.moduleType===f.CHRG?430:380});break;case"ROAD":o.intersections.push({id:i.id});for(const a of this.DIRECTION_UPDATES)if(a.direction===h.NORTH||a.direction===h.EAST){const s=i.road[a.direction];if(s){const l=e.find(d=>d.id===i.road[a.direction]);l&&"MODULE"!==l.type&&o.roads.push({length:360,from:i.id,to:s,direction:a.direction})}}}return o}getNewGridLayout(){var e=this;return(0,nt.Z)(function*(){return e.convertGridToGridLayout(e.grid)})()}convertGridToGridLayout(e){return e.map(o=>o.tile)}validateGridLayout(e){const o=new Set(e.map(i=>i.id));if(o.size){const i=[e[0].id];for(;i.length;){const a=i.pop(),s=e.find(l=>l.id===a);if(a&&s&&o.has(s.id))switch(o.delete(s.id),s.type){case"ROAD":for(const d of this.DIRECTION_UPDATES){const c=s.road[d.direction];c&&o.has(c)&&i.push(c)}break;case"MODULE":const l=s.intersection;if(!l)return!1;o.has(l)&&i.push(l)}}}return 0===o.size}setLayoutSaved(){this._modified=!1}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(St))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ao=["drawer"],so=["gridZoomContainer"],lo=["gridster"],co=["defaultLayoutDialogContent"];function uo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h2",13)(1,"mat-icon"),t._uU(2,"healing"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",14),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",15)(9,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendDefaultLayoutReset()}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",17),t._uU(13),t.ALo(14,"translate"),t.qZA()()}2&n&&(t.xp6(3),t.hij(" ",t.lcZ(4,4,"Zur\xfccksetzen auf Standardlayout"),""),t.xp6(3),t.hij(" ",t.lcZ(7,6,"Soll die Fabrik wirklich auf das Standardlayout zur\xfcckgesetzt werden?")," "),t.xp6(4),t.Oqu(t.lcZ(11,8,"Ja")),t.xp6(3),t.Oqu(t.lcZ(14,10,"Nein")))}function po(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){return t.CHM(e),t.oxw(2),t.MAs(8).toggle()}),t.ALo(1,"async"),t.ALo(2,"translate"),t.TgZ(3,"mat-icon"),t._uU(4,"add_circle"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",t.lcZ(1,2,e.hasRunningOrders$))("matTooltip",t.lcZ(2,4,"Hinzuf\xfcgen"))}}function _o(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveLayout()}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"async"),t.ALo(4,"async"),t.TgZ(5,"mat-icon"),t._uU(6,"save"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("matTooltip",t.lcZ(2,5,"Speichern"))("disabled",t.lcZ(3,7,e.hasRunningOrders$)||!e.layoutEditor.modified||!1===t.lcZ(4,9,e.isValidLayout$)),t.uIk("aria-label",t.lcZ(1,3,"Speichern"))}}function mo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).resetLayout()}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("matTooltip",t.lcZ(2,5,"Zur\xfccksetzen"))("disabled",!e.layoutEditor.modified),t.uIk("aria-label",t.lcZ(1,3,"Zur\xfccksetzen"))}}function fo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).resetDefaultLayout()}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.TgZ(3,"mat-icon"),t._uU(4,"healing"),t.qZA()()}2&n&&(t.Q6J("matTooltip",t.lcZ(2,4,"Zur\xfccksetzen auf Standardlayout")),t.uIk("aria-label",t.lcZ(1,2,"Zur\xfccksetzen auf Standardlayout")))}function go(n,r){if(1&n){const e=t.EpF();t.YNc(0,po,5,6,"button",18),t.YNc(1,_o,7,11,"button",19),t.YNc(2,mo,5,7,"button",19),t.YNc(3,fo,5,6,"button",20),t.TgZ(4,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().zoomIn()}),t.ALo(5,"translate"),t.ALo(6,"translate"),t.TgZ(7,"mat-icon"),t._uU(8,"zoom_in"),t.qZA()(),t.TgZ(9,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().zoomOut()}),t.ALo(10,"translate"),t.ALo(11,"translate"),t.TgZ(12,"mat-icon"),t._uU(13,"zoom_out"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("ngIf",e.editable),t.xp6(1),t.Q6J("ngIf",e.editable),t.xp6(1),t.Q6J("ngIf",e.editable),t.xp6(1),t.Q6J("ngIf",e.editable),t.xp6(1),t.Q6J("matTooltip",t.lcZ(6,10,"Vergr\xf6\xdfern")),t.uIk("aria-label",t.lcZ(5,8,"Vergr\xf6\xdfern")),t.xp6(5),t.Q6J("matTooltip",t.lcZ(11,14,"Verkleinern")),t.uIk("aria-label",t.lcZ(10,12,"Verkleinern"))}}function ho(n,r){1&n&&t.GkF(0)}function Co(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).add_production(a)}),t._UZ(1,"img",27),t.ALo(2,"translate"),t.TgZ(3,"span")(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA()()()}if(2&n){const e=r.$implicit;t.xp6(1),t.Q6J("src","assets/images/ic_ft_"+(null==e.subType?null:e.subType.toLowerCase())+".svg",t.LSH)("alt",t.lcZ(2,4,"Produktionsschritt."+e.subType)),t.xp6(4),t.hij("",t.lcZ(6,6,"Produktionsschritt."+e.subType)," "),t.xp6(3),t.Oqu(e.serialNumber)}}function To(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-action-list")(1,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().add_intersection()}),t.TgZ(2,"mat-icon",25),t._uU(3,"flare"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().add_charger()}),t.TgZ(8,"mat-icon",25),t._uU(9,"power"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.YNc(13,Co,9,8,"button",26),t.ALo(14,"async"),t.qZA()}if(2&n){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,3,"Kreuzung")),t.xp6(6),t.Oqu(t.lcZ(12,5,"Produktionsschritt.CHRG")),t.xp6(2),t.Q6J("ngForOf",t.lcZ(14,7,e.layoutEditor.availableModules$))}}function Ao(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().delete_item(i)}),t.ALo(1,"async"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.TgZ(4,"mat-icon"),t._uU(5,"delete"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",t.lcZ(1,3,e.hasRunningOrders$))("matTooltip",t.lcZ(3,7,"L\xf6schen")),t.uIk("aria-label",t.lcZ(2,5,"L\xf6schen"))}}function xo(n,r){if(1&n&&(t.TgZ(0,"div",34),t._UZ(1,"div",35)(2,"div",36)(3,"div",37)(4,"div",38),t.TgZ(5,"div",39),t._uU(6),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.Oqu(e.tile.id)}}function Oo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().rotate_module(i)}),t.ALo(1,"async"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.TgZ(4,"mat-icon"),t._uU(5,"rotate_right"),t.qZA()()}if(2&n){const e=t.oxw(3);t.Q6J("disabled",t.lcZ(1,3,e.hasRunningOrders$))("matTooltip",t.lcZ(3,7,"Drehen")),t.uIk("aria-label",t.lcZ(2,5,"Drehen"))}}const yo=function(n,r,e){return[n,r,e]};function bo(n,r){if(1&n&&(t.TgZ(0,"button",49),t.ALo(1,"async"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.TgZ(4,"mat-icon"),t._uU(5,"more"),t.qZA()()),2&n){const e=t.oxw(2).$implicit,o=t.oxw();t.Q6J("routerLink",t.kEZ(9,yo,t.lcZ(1,3,o.routeToRoot$),o.FutureFactoryRoutes.MODULE,e.tile.id))("matTooltip",t.lcZ(3,7,"Mehr")),t.uIk("aria-label",t.lcZ(2,5,"Mehr"))}}const So=function(n){return[n]},vo=function(n,r){return[n,r]};function Zo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw().item_clicked(i)}),t.TgZ(1,"div",41)(2,"div",42),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",43),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t._UZ(8,"div",44),t.TgZ(9,"div",45),t.YNc(10,Oo,6,9,"button",46),t.YNc(11,bo,6,13,"button",47),t.qZA()()}if(2&n){const e=t.oxw().$implicit,o=t.oxw();t.ekj("is-offline",o.isOffline(e.tile.id))("is-placeholder",e.tile.placeholder)("is-large-module",o.layoutEditor.isLargeModule(e.tile.moduleType))("not-connected",!e.tile.intersection),t.xp6(1),t.Q6J("ngClass",t.VKq(20,So,e.tile.moduleType)),t.xp6(2),t.Oqu(t.lcZ(4,16,"Produktionsschritt."+e.tile.moduleType)),t.xp6(3),t.AsE("",t.lcZ(7,18,"ID:")," ",e.tile.id,""),t.xp6(2),t.Q6J("ngClass",t.WLB(22,vo,e.tile.direction,e.tile.moduleType))("title",e.tile.direction),t.xp6(2),t.Q6J("ngIf",o.editable),t.xp6(1),t.Q6J("ngIf",e.tile.moduleType!==o.ModuleType.CHRG)}}function Fo(n,r){if(1&n&&(t.TgZ(0,"gridster-item",28),t.YNc(1,Ao,6,9,"button",29),t.YNc(2,xo,7,1,"div",30),t.YNc(3,Zo,12,25,"div",31),t._UZ(4,"div",32),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.ekj("is-road","ROAD"===e.tile.type)("highlight",e.tile.id===o.highlightedId),t.Q6J("item",e),t.xp6(1),t.Q6J("ngIf",o.editable),t.xp6(1),t.Q6J("ngIf","ROAD"===e.tile.type),t.xp6(1),t.Q6J("ngIf","MODULE"===e.tile.type)}}let ie=(()=>{class n{constructor(e,o,i,a,s,l,d,c){this.mqtt=e,this.orderStatesService=o,this.factoryStateService=i,this.layoutEditor=a,this.dialog=s,this.zone=l,this.router=d,this.activatedRoute=c,this.destroy$=new J.t(1),this.width$=new H.X(0),this.zoomScale$=new H.X(1),this._editable$=new H.X(!1),this.offlineModules=new Map,this.FutureFactoryRoutes=M,this.ModuleType=f,this.dragStopped=u=>{setTimeout(()=>{this.layoutEditor.updateMovedGridItem(u)})},this.options={scale:1,gridType:"fixed",fixedColWidth:200,fixedRowHeight:200,setGridSize:!0,minRows:3,margin:10,minCols:3,swap:!1,mobileBreakpoint:0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!0,disablePushOnResize:!0,draggable:{dropOverItems:!0,enabled:!0,stop:this.dragStopped}},this.routeToRoot$=oe(c),this.isValidLayout$=a.editorGrid$.pipe((0,m.U)(u=>a.validateGridLayout(a.convertGridToGridLayout(u)))),this.hasRunningOrders$=this.orderStatesService.hasRunningOrders$,window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(u=>{this.zone.run(()=>{this.width$.next(u[0].contentRect.width)})})),this.widthScaleStyle$=this.getWidthScaleStyle$(),this.gridContents$=a.editorGrid$.pipe((0,dt.V)(this._editable$),(0,m.U)(([u,g])=>u.map(b=>g?b:Object.assign(Object.assign({},b),{dragEnabled:!1})))),this.setupOfflineModules(this.factoryStateService.pairedModules$)}set editable(e){this._editable$.next(e)}get editable(){return this._editable$.value}isLargeModule(e){return this.layoutEditor.isLargeModule(e)}isOffline(e){var o;return null!==(o=this.offlineModules.get(e))&&void 0!==o&&o}getWidthScaleStyle$(){return(0,et.a)([this.zoomScale$,this.width$,this.layoutEditor.editorGrid$]).pipe((0,m.U)(([e,o,i])=>{const a=(2+Math.max(...i.map(u=>u.x)))*(this.options.margin+this.options.fixedColWidth)+this.options.margin,s=(2+Math.max(...i.map(u=>u.y)))*(this.options.margin+this.options.fixedRowHeight)+this.options.margin,c=Math.min(1,o/a)*e*(this.startZoom||1);return this.gridster&&(this.gridster.options.scale=c,this.gridster.optionsChanged()),{transform:"scale("+c+")",height:c*s+"px"}}),(0,D.O)({}),(0,T.d)(1))}ngOnInit(){this.layoutEditor.resetLayout(),this.resizeObserver&&this.resizeObserver.observe(this.gridZoomContainer.nativeElement)}ngAfterViewInit(){this.orderStatesService.hasRunningOrders$.pipe((0,$.h)(e=>e),(0,F.R)(this.destroy$)).subscribe(()=>this.drawer.close())}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.unobserve(this.gridZoomContainer.nativeElement),this.zoomScale$.complete(),this.width$.complete(),this._editable$.complete(),this.destroy$.next(),this.destroy$.complete()}add_intersection(){const e={cols:1,rows:1,x:0,y:0,tile:{type:"ROAD",x:0,y:0,road:{},id:this.layoutEditor.getNextId()}};e.x=this.gridster.getFirstPossiblePosition(e).x,e.y=this.gridster.getFirstPossiblePosition(e).y,e.tile.x=e.x,e.tile.y=e.y,this.layoutEditor.addItem(e)}add_charger(){let e=0,o="CHRG";for(;this.layoutEditor.hasGridItemId(o+e);)e++;this.add_production({type:"MODULE",subType:f.CHRG,serialNumber:o+e,available:Tt.READY,connected:!0})}add_production(e){const o={cols:1,rows:e.subType===f.HBW||e.subType===f.DPS?2:1,x:0,y:0,tile:{type:"MODULE",x:0,y:0,id:e.serialNumber,connected:!0,moduleType:e.subType,direction:e.subType===f.HBW?h.WEST:h.EAST}};o.x=this.gridster.getFirstPossiblePosition(o).x,o.y=this.gridster.getFirstPossiblePosition(o).y,o.tile.x=o.x,o.tile.y=o.y,this.layoutEditor.addItem(o)}delete_item(e){this.layoutEditor.deleteGridItem(e)}rotate_module(e){this.layoutEditor.rotateModuleConnection(e)}saveLayout(){var e=this;return(0,nt.Z)(function*(){if(yield(0,bt.z)(e.hasRunningOrders$))return;const i=yield e.layoutEditor.getNewGridLayout();if(e.layoutEditor.validateGridLayout(i)){const a=e.layoutEditor.convertGridLayoutToLayout(i);return e.layoutEditor.setLayoutSaved(),e.mqtt.publish(y.SET_LAYOUT,a)}alert("WRONG LAYOUT")})()}resetLayout(){this.layoutEditor.resetLayout()}zoomIn(){this.zoomScale$.value<4&&this.zoomScale$.next(this.zoomScale$.value+.2)}zoomOut(){this.zoomScale$.value>.3&&this.zoomScale$.next(this.zoomScale$.value-.2)}item_clicked(e){var o=this;return(0,nt.Z)(function*(){if(!o.editable&&"MODULE"===e.tile.type&&e.tile.moduleType!==f.CHRG){const i=yield(0,bt.z)(o.routeToRoot$);yield o.router.navigate([i,M.MODULE,e.tile.id],{relativeTo:o.activatedRoute})}})()}setupOfflineModules(e){e.pipe((0,D.O)([]),(0,m.U)(o=>o.map(i=>{var a;return[i.serialNumber,null!==(a=i.connected)&&void 0!==a&&a]})),(0,F.R)(this.destroy$)).subscribe(o=>{for(let[i,a]of o)this.offlineModules.set(i,!a)})}resetDefaultLayout(){this.dialog.open(this.defaultLayoutDialogContent)}sendDefaultLayoutReset(){this.mqtt.publish(y.SET_DEFAULT_LAYOUT,{timestamp:new Date})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(I),t.Y36(ct),t.Y36(K),t.Y36(ro),t.Y36(x.uw),t.Y36(t.R0b),t.Y36(Z.F0),t.Y36(Z.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-factory-layout"]],viewQuery:function(e,o){if(1&e&&(t.Gf(ao,5),t.Gf(so,7),t.Gf(lo,5),t.Gf(co,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.drawer=i.first),t.iGM(i=t.CRH())&&(o.gridZoomContainer=i.first),t.iGM(i=t.CRH())&&(o.gridster=i.first),t.iGM(i=t.CRH())&&(o.defaultLayoutDialogContent=i.first)}},inputs:{editable:"editable",highlightedId:"highlightedId",startZoom:"startZoom"},decls:18,vars:11,consts:[["defaultLayoutDialogContent",""],["layoutActions",""],["id","layout-configuration"],[4,"ngTemplateOutlet"],["hasBackdrop","true",1,"example-container"],["mode","over"],["drawer",""],[4,"ngIf"],["id","grid-zoom",3,"ngStyle"],["gridZoomContainer",""],[3,"options"],["gridster",""],["class","ff-tile",3,"item","is-road","highlight",4,"ngFor","ngForOf"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","color","warn",3,"click"],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-raised-button","","aria-label","'Hinzuf\xfcgen' | translate",3,"disabled","matTooltip","click",4,"ngIf"],["mat-raised-button","",3,"matTooltip","disabled","click",4,"ngIf"],["mat-raised-button","",3,"matTooltip","click",4,"ngIf"],["mat-raised-button","",3,"matTooltip","click"],["mat-raised-button","","aria-label","'Hinzuf\xfcgen' | translate",3,"disabled","matTooltip","click"],["mat-raised-button","",3,"matTooltip","disabled","click"],["mat-list-item","",3,"click"],["color","accent"],["mat-list-item","",3,"click",4,"ngFor","ngForOf"],[1,"module-icon",3,"src","alt"],[1,"ff-tile",3,"item"],["class","gridster-item-content","mat-icon-button","","mat-raised-button","","style","float: right; z-index: 1; position: relative",3,"disabled","matTooltip","click",4,"ngIf"],["class","roads",4,"ngIf"],["class","module",3,"is-offline","is-placeholder","is-large-module","not-connected","click",4,"ngIf"],[1,"ff-tile-overlay"],["mat-icon-button","","mat-raised-button","",1,"gridster-item-content",2,"float","right","z-index","1","position","relative",3,"disabled","matTooltip","click"],[1,"roads"],[1,"road","road-south"],[1,"road","road-east"],[1,"road","road-north"],[1,"road","road-west"],[1,"content","intersection"],[1,"module",3,"click"],[1,"content",3,"ngClass"],[1,"module-type"],[1,"module-id"],[1,"direction",3,"ngClass","title"],[1,"actions"],["mat-icon-button","","mat-raised-button","","class","gridster-item-content",3,"disabled","matTooltip","click",4,"ngIf"],["mat-icon-button","","routerLinkActive","active",3,"routerLink","matTooltip",4,"ngIf"],["mat-icon-button","","mat-raised-button","",1,"gridster-item-content",3,"disabled","matTooltip","click"],["mat-icon-button","","routerLinkActive","active",3,"routerLink","matTooltip"]],template:function(e,o){if(1&e&&(t.YNc(0,uo,15,12,"ng-template",null,0,t.W1O),t.YNc(2,go,14,16,"ng-template",null,1,t.W1O),t.TgZ(4,"div",2),t.YNc(5,ho,1,0,"ng-container",3),t.TgZ(6,"mat-drawer-container",4)(7,"mat-drawer",5,6),t.YNc(9,To,15,9,"mat-action-list",7),t.qZA(),t.TgZ(10,"mat-drawer-content")(11,"div",8,9),t.ALo(13,"async"),t.TgZ(14,"gridster",10,11),t.YNc(16,Fo,5,8,"gridster-item",12),t.ALo(17,"async"),t.qZA()()()()()),2&e){const i=t.MAs(3);t.xp6(5),t.Q6J("ngTemplateOutlet",i),t.xp6(4),t.Q6J("ngIf",o.editable),t.xp6(2),t.Q6J("ngStyle",t.lcZ(13,7,o.widthScaleStyle$)),t.xp6(3),t.ekj("readonly",!o.editable),t.Q6J("options",o.options),t.xp6(2),t.Q6J("ngForOf",t.lcZ(17,9,o.gridContents$))}},directives:[x.uh,U.Hw,x.xY,x.H8,E.lW,x.ZT,_.O5,Lt.gM,_.tP,ht.kh,ht.jA,j.i$,j.Tg,_.sg,ht.LW,_.PC,_t.sm,_t.IM,_.mk,Z.Od,Z.rH],pipes:[A.X$,_.Ov],styles:['.mat-drawer-content[_ngcontent-%COMP%]{overflow-y:hidden}mat-drawer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1.5rem}gridster[_ngcontent-%COMP%]{background:#eaeaea}#grid-zoom[_ngcontent-%COMP%]{transform-origin:top left;width:100%}#layout-configuration[_ngcontent-%COMP%] > .mat-icon-button[_ngcontent-%COMP%], #layout-configuration[_ngcontent-%COMP%] > .mat-raised-button[_ngcontent-%COMP%]{margin:0;padding:0 1rem;min-width:64px}.mat-icon[_ngcontent-%COMP%]{line-height:24px}.ff-tile.gridster-item-moving[_ngcontent-%COMP%]{z-index:100!important}.ff-tile.is-road[_ngcontent-%COMP%]{background:#fafafa}.ff-tile.highlight[_ngcontent-%COMP%]   .ff-tile-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;border:10px solid orange;background:#aaaa0055;pointer-events:none}.ff-tile[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%], .ff-tile[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin:0;padding:0}.ff-tile[_ngcontent-%COMP%]   .roads[_ngcontent-%COMP%], .ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;font-weight:700;font-family:sans-serif;font-size:32px;line-height:32px}.ff-tile[_ngcontent-%COMP%]   .road[_ngcontent-%COMP%]{background:#000000;position:absolute}.ff-tile[_ngcontent-%COMP%]   .road.road-north[_ngcontent-%COMP%]{inset:0 47% 50%}.ff-tile[_ngcontent-%COMP%]   .road.road-east[_ngcontent-%COMP%]{inset:47% 0 47% 50%}.ff-tile[_ngcontent-%COMP%]   .road.road-south[_ngcontent-%COMP%]{inset:50% 47% 0}.ff-tile[_ngcontent-%COMP%]   .road.road-west[_ngcontent-%COMP%]{inset:47% 50% 47% 0}.ff-tile[_ngcontent-%COMP%]   .intersection[_ngcontent-%COMP%]{border-radius:50%;position:absolute;top:50%;left:50%;text-align:center;transform:translate(-50%,-50%);padding:5px;min-width:15%;min-height:15%;background:white}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]{position:relative}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .direction[_ngcontent-%COMP%]{position:absolute;background:#333333}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .direction.NORTH[_ngcontent-%COMP%]{inset:0 47% 80%;border-radius:0 0 50% 50%/0 0 20% 20%}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .direction.SOUTH[_ngcontent-%COMP%]{inset:80% 47% 0;border-radius:50% 50% 0 0/20% 20% 0 0}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .direction.EAST[_ngcontent-%COMP%]{inset:47% 0 47% 80%;border-radius:20% 0 0 20%/50% 0 0 50%}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .direction.WEST[_ngcontent-%COMP%]{inset:47% 80% 47% 0;border-radius:0 20% 20% 0/0 50% 50% 0}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%], .ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .mat-raised-button[_ngcontent-%COMP%]{margin:0;padding:0}.ff-tile[_ngcontent-%COMP%]   .module.not-connected[_ngcontent-%COMP%]{background:#ffeebb}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]:before, .ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]:after{font-family:Material Icons,Material Icons;content:"";z-index:-100}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]:before{position:absolute;top:.5rem;left:.5rem;height:64px;width:64px;line-height:64px;font-size:64px}.ff-tile[_ngcontent-%COMP%]   .module.is-offline[_ngcontent-%COMP%]:before, .ff-tile[_ngcontent-%COMP%]   .module.is-placeholder[_ngcontent-%COMP%]:before{z-index:10;content:"wifi_off";opacity:.8}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]:after{position:absolute;inset:.5rem}.ff-tile[_ngcontent-%COMP%]   .module.is-offline[_ngcontent-%COMP%]:after, .ff-tile[_ngcontent-%COMP%]   .module.is-placeholder[_ngcontent-%COMP%]:after{background-image:repeating-linear-gradient(45deg,var(--warn-color),var(--warn-color) 12.5px,var(--text-accent-color) 12.5px,var(--text-accent-color) 25px);opacity:.125}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.NORTH.DPS[_ngcontent-%COMP%]{left:23%;right:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.NORTH.HBW[_ngcontent-%COMP%]{right:23%;left:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.EAST.DPS[_ngcontent-%COMP%]{top:23%;bottom:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.EAST.HBW[_ngcontent-%COMP%]{bottom:23%;top:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.SOUTH.DPS[_ngcontent-%COMP%]{right:23%;left:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.SOUTH.HBW[_ngcontent-%COMP%]{left:23%;right:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.WEST.DPS[_ngcontent-%COMP%]{bottom:23%;top:74%}.ff-tile[_ngcontent-%COMP%]   .module.is-large-module[_ngcontent-%COMP%]   .direction.WEST.HBW[_ngcontent-%COMP%]{top:23%;bottom:74%}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;inset:20px 0;padding:20px;text-align:center;background-size:contain;background-repeat:no-repeat;background-position:center center;font-size:16px;line-height:18px;text-shadow:#fff 4px 0px 0px,#fff 3.87565px .989616px 0px,#fff 3.51033px 1.9177px 0px,#fff 2.92676px 2.72656px 0px,#fff 2.16121px 3.36588px 0px,#fff 1.26129px 3.79594px 0px,#fff .282949px 3.98998px 0px,#fff -.712984px 3.93594px 0px,#fff -1.66459px 3.63719px 0px,#fff -2.51269px 3.11229px 0px,#fff -3.20457px 2.39389px 0px,#fff -3.69721px 1.52664px 0px,#fff -3.95997px .56448px 0px,#fff -3.97652px -.432781px 0px,#fff -3.74583px -1.40313px 0px,#fff -3.28224px -2.28625px 0px,#fff -2.61457px -3.02721px 0px,#fff -1.78435px -3.57996px 0px,#fff -.843183px -3.91012px 0px,#fff .150409px -3.99717px 0px,#fff 1.13465px -3.8357px 0px,#fff 2.04834px -3.43574px 0px,#fff 2.83468px -2.82216px 0px,#fff 3.44477px -2.03312px 0px,#fff 3.84068px -1.11766px 0px,#fff 3.9978px -.132717px 0px}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.DPS[_ngcontent-%COMP%]{background-image:url(ic_ft_dps.7707d45cdb95a1ae.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.HBW[_ngcontent-%COMP%]{background-image:url(ic_ft_hbw.beecab1bb58c9912.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.START[_ngcontent-%COMP%]{background-image:url(module.START.764bd7c7a1844785.png)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.DRILL[_ngcontent-%COMP%]{background-image:url(ic_ft_drill.1915691366aabeea.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.MILL[_ngcontent-%COMP%]{background-image:url(ic_ft_mill.2293eae10359e898.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.OVEN[_ngcontent-%COMP%]{background-image:url(ic_ft_oven.104a9d4cbb1f932a.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.AIQS[_ngcontent-%COMP%]{background-image:url(ic_ft_aiqs.72610317cc08236d.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.CHRG[_ngcontent-%COMP%]{background-image:url(ic_ft_chrg.d50dd9eb9a1acf66.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .content.FTS[_ngcontent-%COMP%]{background-image:url(ic_ft_fts.ae5dc75f76d18756.svg)}.ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:absolute;left:5px;right:5px;bottom:5px;display:flex;justify-content:space-between}.readonly[_ngcontent-%COMP%]   .ff-tile[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]{cursor:pointer}']}),n})();const Le=[{type:k.WHITE,name:"Werkst\xfcck.Wei\xdf",icon:"assets/images/ic_ft_workpiece_white.svg"},{type:k.BLUE,name:"Werkst\xfcck.Blau",icon:"assets/images/ic_ft_workpiece_blue.svg"},{type:k.RED,name:"Werkst\xfcck.Rot",icon:"assets/images/ic_ft_workpiece_red.svg"}];let Me=(()=>{class n{constructor(e){this.mqttService=e,this.config$=this.mqttService.subscribe(y.CONFIG).pipe(Y(),(0,T.d)(1))}saveConfig(e){this.mqttService.publish(y.SET_CONFIG,e,{qos:1})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Lo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",3),t._UZ(1,"img",10),t.ALo(2,"translate"),t.TgZ(3,"div",4),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",5)(7,"mat-form-field")(8,"input",6),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.oxw(2).config.productionDurations[s.type]=i}),t.qZA(),t.TgZ(9,"span",8),t._uU(10),t.ALo(11,"translate"),t.qZA()()()()}if(2&n){const e=r.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("src",e.icon,t.LSH),t.uIk("alt",t.lcZ(2,5,e.name)),t.xp6(3),t.Oqu(t.lcZ(5,7,e.name)),t.xp6(4),t.Q6J("ngModel",o.config.productionDurations[e.type]),t.xp6(2),t.Oqu(t.lcZ(11,9,"Sekunden"))}}function Mo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section")(1,"h2"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",1),t.YNc(5,Lo,12,11,"div",2),t.qZA(),t._UZ(6,"hr"),t.TgZ(7,"h2"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",3)(11,"div",4),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",5)(15,"mat-form-field")(16,"input",6),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().config.productionSettings.maxParallelOrders=i}),t.qZA()()()(),t._UZ(17,"hr"),t.TgZ(18,"h2"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"div",3)(22,"div",4),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"div",5)(26,"mat-form-field")(27,"input",7),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().config.ftsSettings.chargeThresholdPercent=i}),t.qZA(),t.TgZ(28,"span",8),t._uU(29,"\uff05"),t.qZA()()()(),t.TgZ(30,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().saveConfig()}),t._uU(31),t.ALo(32,"translate"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,10,"Gesamtdauer")),t.xp6(3),t.Q6J("ngForOf",e.wsTypes),t.xp6(3),t.Oqu(t.lcZ(9,12,"Produktionseinstellungen")),t.xp6(4),t.Oqu(t.lcZ(13,14,"Anzahl parallel produzierbarer Werkst\xfccke")),t.xp6(4),t.Q6J("ngModel",e.config.productionSettings.maxParallelOrders),t.xp6(3),t.Oqu(t.lcZ(20,16,"Transporteinstellungen")),t.xp6(4),t.Oqu(t.lcZ(24,18,"Ladeschwelle f\xfcr FTS")),t.xp6(4),t.Q6J("ngModel",e.config.ftsSettings.chargeThresholdPercent),t.xp6(3),t.Q6J("disabled",!e.configChanged),t.xp6(1),t.Oqu(t.lcZ(32,20,"Speichern"))}}let Po=(()=>{class n{constructor(e){this.generalConfigService=e,this.editable=!1,this.destroy$=new J.t(1),this.wsTypes=Le,this.generalConfigService.config$.pipe((0,F.R)(this.destroy$)).subscribe(o=>{this.config=o,this.originalConfig=JSON.parse(JSON.stringify(o))})}get configChanged(){return JSON.stringify(this.config)!==JSON.stringify(this.originalConfig)}saveConfig(){this.config&&this.generalConfigService.saveConfig(this.config)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Me))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-factory-config"]],inputs:{editable:"editable"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"config"],["class","config__item",4,"ngFor","ngForOf"],[1,"config__item"],[1,"config__item__label"],[1,"config__item__value"],["matInput","","type","number",3,"ngModel","ngModelChange"],["matInput","","min","0","max","100","type","number",3,"ngModel","ngModelChange"],["matSuffix",""],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"config__item__icon",3,"src"]],template:function(e,o){1&e&&t.YNc(0,Mo,33,22,"section",0),2&e&&t.Q6J("ngIf",(null==o.config?null:o.config.productionDurations)&&(null==o.config?null:o.config.ftsSettings))},directives:[_.O5,_.sg,N.KE,rt.Nt,L.wV,L.Fj,L.JJ,L.On,N.R9,L.qQ,L.Fd,E.lW],pipes:[A.X$],styles:["section[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem;background-color:#eaeaea;font-size:1.3rem}.config__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:.5rem}.config__item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:right}.config__item__icon[_ngcontent-%COMP%]{width:3em}\n/*# sourceMappingURL=factory-config.component.css.map*/"]}),n})(),wo=(()=>{class n{constructor(){this.htmlStrings={configurationHeader:"Fabrikkonfiguration"}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-layout-editor"]],decls:8,vars:9,consts:[[2,"flex-direction","column"],[3,"animationDuration"],[3,"label"],[3,"editable"]],template:function(e,o){1&e&&(t.TgZ(0,"ff-missing-controller-banner",0)(1,"mat-tab-group",1)(2,"mat-tab",2),t.ALo(3,"translate"),t._UZ(4,"ff-factory-layout",3),t.qZA(),t.TgZ(5,"mat-tab",2),t.ALo(6,"translate"),t._UZ(7,"ff-factory-config",3),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("animationDuration",0),t.xp6(1),t.s9C("label",t.lcZ(3,5,"Fabrikkonfiguration")),t.xp6(2),t.Q6J("editable",!0),t.xp6(1),t.s9C("label",t.lcZ(6,7,"Konfiguration")),t.xp6(2),t.Q6J("editable",!0))},directives:[ut,tt.SP,tt.uX,ie,Po],pipes:[A.X$],styles:["[_nghost-%COMP%]{display:block;padding:10px}"]}),n})();var re=p(1130);function Io(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",5)(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"input",6),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.referenceValue=i}),t.qZA()()}if(2&n){const e=r.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,e.referenceKey)),t.xp6(2),t.Q6J("ngModel",e.referenceValue)}}function Eo(n,r){if(1&n&&(t.TgZ(0,"div",3),t.YNc(1,Io,5,4,"mat-form-field",4),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.statusValues)}}function Uo(n,r){if(1&n&&(t.TgZ(0,"figure"),t._UZ(1,"img",7),t.TgZ(2,"figcaption"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("src",e.referenceValue,t.LSH),t.xp6(2),t.Oqu(t.lcZ(4,2,e.referenceKey))}}function Ro(n,r){if(1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-title"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-card-content"),t.YNc(5,Eo,2,1,"div",1),t.YNc(6,Uo,5,4,"figure",2),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,3,"Kalibrierungsinformationen")),t.xp6(3),t.Q6J("ngIf",e.statusValues),t.xp6(1),t.Q6J("ngForOf",e.imageData)}}let No=(()=>{class n{constructor(){this.imageData=[],this.statusValues=[]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-calibration-info"]],inputs:{imageData:"imageData",statusValues:"statusValues"},decls:1,vars:1,consts:[[4,"ngIf"],["class","value-list",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"value-list"],["class","full-width",4,"ngFor","ngForOf"],[1,"full-width"],["matNativeControl","","readonly","readonly","type","text",3,"ngModel","ngModelChange"],[3,"src"]],template:function(e,o){1&e&&t.YNc(0,Ro,7,5,"mat-card",0),2&e&&t.Q6J("ngIf",(null==o.statusValues?null:o.statusValues.length)||(null==o.imageData?null:o.imageData.length))},directives:[_.O5,S.a8,S.n5,S.dn,_.sg,N.KE,N.hX,rt.Nt,L.Fj,L.JJ,L.On],pipes:[A.X$],styles:[""]}),n})();function Do(n,r){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"section",1),t._UZ(3,"img",2)(4,"img",3),t.qZA()()())}function ko(n,r){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"section",1),t._UZ(3,"img",4)(4,"img",5),t.qZA()()())}let qo=(()=>{class n{constructor(){this.ModuleType=f,this.moduleType=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-calibration-caption"]],inputs:{moduleType:"moduleType"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"grid"],["src","assets/images/APS_E-A_3D.jpg","alt","APS I/O in 3D"],["src","assets/images/APS_E-A_Front.jpg","alt","APS I/O Front"],["src","assets/images/APS_Hochregal_3D.jpg","alt","APS HBW in 3D"],["src","assets/images/APS_Hochregal_Front.jpg","alt","APS HBW Front"]],template:function(e,o){1&e&&(t.YNc(0,Do,5,0,"mat-card",0),t.YNc(1,ko,5,0,"mat-card",0)),2&e&&(t.Q6J("ngIf",o.moduleType===o.ModuleType.DPS),t.xp6(1),t.Q6J("ngIf",o.moduleType===o.ModuleType.HBW))},directives:[_.O5,S.a8,S.dn],styles:["[_nghost-%COMP%]{display:block}img[_ngcontent-%COMP%]{max-width:100%;height:auto;display:block;margin:0 auto}mat-card[_ngcontent-%COMP%]{margin-top:1rem}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;grid-gap:1rem}@media screen and (min-width: 1200px){.grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"],changeDetection:0}),n})();const $o={HBW:{REF:[],RACK_REIHE_1_SPALTE_A:["cal__rackOffset","cal__row1","cal__colA"],RACK_REIHE_2_SPALTE_B:["cal__rackOffset","cal__row2","cal__colB"],RACK_REIHE_3_SPALTE_C:["cal__rackOffset","cal__row3","cal__colC"],RAMPE:["cal__rampOffset","cal__rampPositionX","cal__rampPositionY","cal__rampPositionRot","cal__rampPositionRotCheck"],DROP:["cal__AGVPositionRot"],PICK:["cal__AGVPositionRot"],FACTORY_BASE_SETTINGS:["cal__timeProcessEnd","cal__timeGripperValveClose","cal__timeGripperValveOpen","cal__timeCompressor"]},DPS:{REF:[],HOME_BASE:["RA.HOME.BASE.X","RA.HOME.BASE.Y","RA.HOME.BASE.Z"],HOME_INPUT:["RA.HOME.INPUT.X","RA.HOME.INPUT.Y","RA.HOME.INPUT.Z"],HOME_OUTPUT:["RA.HOME.OUTPUT.X","RA.HOME.OUTPUT.Y","RA.HOME.OUTPUT.Z"],NIO_APPROACH:["RA.NIO.APPROACH.X","RA.NIO.APPROACH.Y","RA.NIO.APPROACH.Z"],NIO_TARGET:["RA.NIO.TARGET.X","RA.NIO.TARGET.Y","RA.NIO.TARGET.Z"],CS_APPROACH:["RA.CS.APPROACH.X","RA.CS.APPROACH.Y","RA.CS.APPROACH.Z","cal__colorRedSetpoint","cal__colorBlueSetpoint","cal__colorWhiteSetpoint","cal__colorValue"],CS_TARGET:["RA.CS.TARGET.X","RA.CS.TARGET.Y","RA.CS.TARGET.Z","cal__colorRedSetpoint","cal__colorBlueSetpoint","cal__colorWhiteSetpoint","cal__colorValue"],NFC_APPROACH:["RA.NFC.APPROACH.X","RA.NFC.APPROACH.Y","RA.NFC.APPROACH.Z"],NFC_TARGET:["RA.NFC.TARGET.X","RA.NFC.TARGET.Y","RA.NFC.TARGET.Z"],INPUT_PICK_APPROACH_A:["RA.INPUT.PICK.APPROACH_A.X","RA.INPUT.PICK.APPROACH_A.Y","RA.INPUT.PICK.APPROACH_A.Z"],INPUT_PICK_APPROACH_B:["RA.INPUT.PICK.APPROACH_B.X","RA.INPUT.PICK.APPROACH_B.Y","RA.INPUT.PICK.APPROACH_B.Z"],INPUT_PICK_TARGET:["RA.INPUT.PICK.TARGET.X","RA.INPUT.PICK.TARGET.Y","RA.INPUT.PICK.TARGET.Z"],OUTPUT_DROP_APPROACH_A:["RA.OUTPUT.DROP.APPROACH_A.X","RA.OUTPUT.DROP.APPROACH_A.Y","RA.OUTPUT.DROP.APPROACH_A.Z"],OUTPUT_DROP_APPROACH_B:["RA.OUTPUT.DROP.APPROACH_B.X","RA.OUTPUT.DROP.APPROACH_B.Y","RA.OUTPUT.DROP.APPROACH_B.Z"],OUTPUT_DROP_TARGET:["RA.OUTPUT.DROP.TARGET.X","RA.OUTPUT.DROP.TARGET.Y","RA.OUTPUT.DROP.TARGET.Z"],FTS_PICK_APPROACH_A:["RA.FTS.PICK.APPROACH_A.X","RA.FTS.PICK.APPROACH_A.Y","RA.FTS.PICK.APPROACH_A.Z"],FTS_PICK_APPROACH_B:["RA.FTS.PICK.APPROACH_B.X","RA.FTS.PICK.APPROACH_B.Y","RA.FTS.PICK.APPROACH_B.Z"],FTS_PICK_TARGET:["RA.FTS.PICK.TARGET.X","RA.FTS.PICK.TARGET.Y","RA.FTS.PICK.TARGET.Z"],FTS_DROP_APPROACH_A:["RA.FTS.DROP.APPROACH_A.X","RA.FTS.DROP.APPROACH_A.Y","RA.FTS.DROP.APPROACH_A.Z"],FTS_DROP_APPROACH_B:["RA.FTS.DROP.APPROACH_B.X","RA.FTS.DROP.APPROACH_B.Y","RA.FTS.DROP.APPROACH_B.Z"],FTS_DROP_TARGET:["RA.FTS.DROP.TARGET.X","RA.FTS.DROP.TARGET.Y","RA.FTS.DROP.TARGET.Z"],GRIP_ON:[],GRIP_OFF:[],CAMERA_HOME:["cal__homePosX","cal__homePosY"],CAMERA_HBW:["cal__customPosX","cal__customPosY"],FACTORY_BASE_SETTINGS:["cal__shortProcessWaitTime","cal__colorRange"]},AIQS:{TO_NIO_BIN:["cal__badTime"],TO_CAMERA:["cal__cameraTime"],TO_PICKUP:[],PICK:["STEPS_BELT_CAMERA","STEPS_BELT_BIN","STEPS_BELT_GRIPPER"],DROP:["STEPS_BELT_CAMERA","STEPS_BELT_BIN","STEPS_BELT_GRIPPER"],CHECK:["STEPS_BELT_CAMERA","STEPS_BELT_BIN","STEPS_BELT_GRIPPER"],FACTORY_BASE_SETTINGS:["cal__processEndTime","cal__midLightGateTime","cal__gripperDownTime","cal__vacuumReleaseTime","cal__prePhotoTime"]}};let Jo=(()=>{class n{constructor(){this.calibrationData=$o}transform(e,o,i){var a;if(!o||!i)return[];const s=null!==(a=this.calibrationData[i][o])&&void 0!==a?a:[];return(null!=e?e:[]).filter(l=>s.includes(l.referenceKey))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"filterRef",type:n,pure:!0}),n})();function Qo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h2",2)(1,"mat-icon"),t._uU(2,"tune"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"section",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"section",4)(9,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.sendCalibrationCommand(i.ModuleCalibrationCommand.STOP)}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"button",6),t._uU(13),t.ALo(14,"translate"),t.qZA()()}2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,4,"Kalibrierung beenden")),t.xp6(3),t.hij(" ",t.lcZ(7,6,"Nicht gespeicherte \xc4nderungen gehen verloren.")," "),t.xp6(4),t.Oqu(t.lcZ(11,8,"Kalibrierung beenden")),t.xp6(3),t.Oqu(t.lcZ(14,10,"Abbrechen")))}function Yo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return i.sendCalibrationCommand(i.ModuleCalibrationCommand.START)}),t.TgZ(1,"mat-icon"),t._uU(2,"tune"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA()}2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"Kalibrierung starten")))}function Ho(n,r){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,Yo,5,3,"button",9),t.qZA()),2&n){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",!e.calibrating)}}function Bo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return i.sendCalibrationCommand(i.ModuleCalibrationCommand.START)}),t.TgZ(1,"mat-icon"),t._uU(2,"refresh"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA()}2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"Werte laden")))}function Go(n,r){if(1&n&&(t.TgZ(0,"mat-option",21),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(t.lcZ(2,2,e))}}function Wo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(4);let a;return i.sendCalibrationCommand(i.ModuleCalibrationCommand.SELECT,null==i.current_position||null==(a=i.current_position.trim())?null:a.toUpperCase())}),t.TgZ(1,"mat-icon"),t._uU(2,"flag"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA()}2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"Position w\xe4hlen")))}function Vo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(4);let a;return i.sendCalibrationCommand(i.ModuleCalibrationCommand.TEST,null==i.current_position||null==(a=i.current_position.trim())?null:a.toUpperCase())}),t.TgZ(1,"mat-icon"),t._uU(2,"play_arrow"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA()}2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"Position testen")))}function jo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",18)(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"input",23,24),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit,l=t.MAs(5);return t.oxw(4).updateRef(l,s,i)}),t.qZA()()}if(2&n){const e=r.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,e.referenceKey)),t.xp6(2),t.Q6J("ngModel",e.referenceValue)}}function zo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section",15)(1,"section",16)(2,"section",17)(3,"mat-form-field",18)(4,"mat-label"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"mat-select",19),t.NdJ("valueChange",function(i){return t.CHM(e),t.oxw(3).current_position=i}),t.YNc(8,Go,3,4,"mat-option",20),t.TgZ(9,"mat-option",21),t._uU(10),t.ALo(11,"translate"),t.qZA()()(),t.YNc(12,Wo,5,3,"button",9),t.YNc(13,Vo,5,3,"button",9),t.qZA(),t.YNc(14,jo,6,4,"mat-form-field",22),t.ALo(15,"filterRef"),t.qZA()()}if(2&n){const e=t.oxw(2).ngIf,o=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,8,"Position zum Kalibrieren")),t.xp6(2),t.Q6J("value",o.current_position),t.xp6(1),t.Q6J("ngForOf",o.available_positions),t.xp6(1),t.Q6J("value","FACTORY_BASE_SETTINGS"),t.xp6(1),t.Oqu(t.lcZ(11,10,"FACTORY_BASE_SETTINGS")),t.xp6(2),t.Q6J("ngIf","FACTORY_BASE_SETTINGS"!==o.current_position),t.xp6(1),t.Q6J("ngIf","FACTORY_BASE_SETTINGS"!==o.current_position),t.xp6(1),t.Q6J("ngForOf",t.Dn7(15,12,o.calibration_data,o.current_position,e.subType))}}function Ko(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card-actions")(1,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return i.calibrationCommandWithValues(i.ModuleCalibrationCommand.SET_VALUES)}),t.TgZ(2,"mat-icon"),t._uU(3,"access_time"),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return i.sendCalibrationCommand(i.ModuleCalibrationCommand.RESET)}),t.TgZ(7,"mat-icon"),t._uU(8,"undo"),t.qZA(),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return i.calibrationCommandWithValues(i.ModuleCalibrationCommand.STORE)}),t.TgZ(12,"mat-icon"),t._uU(13,"save"),t.qZA(),t._uU(14),t.ALo(15,"translate"),t.qZA()()}2&n&&(t.xp6(4),t.Oqu(t.lcZ(5,3,"Anwenden")),t.xp6(5),t.Oqu(t.lcZ(10,5,"Zur\xfccksetzen")),t.xp6(5),t.Oqu(t.lcZ(15,7,"Speichern")))}function Xo(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section")(1,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2),a=t.MAs(1);return i.dialog.open(a)}),t.TgZ(2,"mat-icon"),t._uU(3,"tune"),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",11),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.sendCalibrationCommand(i.ModuleCalibrationCommand.RESET,void 0,!0)}),t.TgZ(7,"mat-icon"),t._uU(8,"clear"),t.qZA(),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"mat-card")(12,"mat-card-title"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"mat-card-content"),t.YNc(16,Bo,5,3,"button",9),t.YNc(17,zo,16,16,"section",12),t.qZA(),t.YNc(18,Ko,16,9,"mat-card-actions",8),t.qZA(),t._UZ(19,"ff-calibration-info",13)(20,"ff-calibration-caption",14),t.qZA()}if(2&n){const e=t.oxw().ngIf,o=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,10,"Kalibrierung beenden")),t.xp6(2),t.Q6J("disabled",!0),t.xp6(3),t.Oqu(t.lcZ(10,12,"Auf Werkseinstellungen zur\xfccksetzen")),t.xp6(4),t.Oqu(t.lcZ(14,14,"Kalibrierungswerte")),t.xp6(3),t.Q6J("ngIf",!(null!=o.calibration_data&&o.calibration_data.length)),t.xp6(1),t.Q6J("ngIf",null==o.calibration_data?null:o.calibration_data.length),t.xp6(1),t.Q6J("ngIf",null==o.calibration_data?null:o.calibration_data.length),t.xp6(1),t.Q6J("imageData",o.image_data)("statusValues",o.status_values),t.xp6(1),t.Q6J("moduleType",e.subType)}}function ti(n,r){if(1&n&&(t.TgZ(0,"section",7)(1,"h1"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,Ho,2,1,"div",8),t.YNc(5,Xo,21,16,"section",8),t.qZA()),2&n){const e=r.ngIf;t.xp6(2),t.lnq("",t.lcZ(3,5,"Modulkalibrierung")," - ",e.subType," (ID: ",e.serialNumber,")"),t.xp6(2),t.Q6J("ngIf",!e.calibrating&&e.connected),t.xp6(1),t.Q6J("ngIf",e.calibrating&&e.connected)}}let ei=(()=>{class n{constructor(e,o,i,a,s){this.factoryLayoutService=e,this.statesService=o,this.mqttClient=i,this.route=a,this.dialog=s,this.ModuleCalibrationCommand=Mt,this.moduleId$=new H.X(void 0),this.destroyed$=new Rt.x,this.image_data=[],this.calibration_data=[],this.available_positions=[],this.current_position="",this.status_values=[],a.params.pipe((0,F.R)(this.destroyed$)).subscribe(l=>{l.moduleId&&(this.moduleId=l.moduleId)}),this.routeToRoot$=oe(a),this.moduleData$=this.createModuleDataObservable(),this.moduleCalibration$=this.createModuleCalibrationObservable(),this.moduleCalibration$.subscribe(l=>{if(l){if(this.calibration_data=[],this.status_values=[],this.image_data=[],this.available_positions=[],this.current_position="",l.references)for(const c of l.references)this.calibration_data.push(c);if(l.status_references)for(const c of l.status_references)"string"==typeof c.referenceValue&&c.referenceValue.startsWith("data:")?this.image_data.push(c):"POSITIONS.AVAILABLE"===c.referenceKey&&"string"==typeof c.referenceValue?this.available_positions=c.referenceValue.split(","):"POSITIONS.CURRENT"===c.referenceKey&&"string"==typeof c.referenceValue?this.current_position=c.referenceValue:this.status_values.push(c);const d=(c,u)=>c.referenceKey.localeCompare(u.referenceKey);this.calibration_data.sort(d),this.status_values.sort(d),this.image_data.sort(d)}})}set moduleId(e){this.moduleId$.next(e)}get moduleId(){return this.moduleId$.value}updateRef(e,o,i){this.calibration_data=this.calibration_data.map(a=>(a.referenceKey===o.referenceKey&&(a.referenceValue=i),a)),e.focus()}createModuleCalibrationObservable(){return this.statesService.calibrationState$.pipe((0,dt.V)(this.moduleId$),(0,m.U)(([e,o])=>e.serialNumber===o?e:null),(0,$.h)(e=>!!e),(0,D.O)(void 0),(0,T.d)(1),(0,F.R)(this.destroyed$))}createModuleDataObservable(){return this.factoryLayoutService.pairedModules$.pipe((0,dt.V)(this.moduleId$),(0,m.U)(([e,o])=>o?e.find(i=>i.serialNumber===o):void 0),(0,T.d)(1),(0,F.R)(this.destroyed$))}ngOnDestroy(){this.destroyed$.complete(),this.moduleId$.complete()}calibrationCommandWithValues(e){this.moduleId&&this.sendCalibrationCommand(e,void 0,void 0,this.calibration_data.map(o=>(o.referenceValue=+o.referenceValue,o)))}sendCalibrationCommand(e,o,i,a){this.moduleId&&this.mqttClient.publish(y.SET_MODULE_CALIBRATION,{timestamp:new Date,serialNumber:this.moduleId,command:e,position:o,factory:i,references:a})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(St),t.Y36(K),t.Y36(I),t.Y36(Z.gz),t.Y36(x.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-module-details"]],inputs:{moduleId:"moduleId"},decls:5,vars:3,consts:[["stopDialogContent",""],["id","module-calibration",4,"ngIf"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","color","warn",3,"click"],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial",""],["id","module-calibration"],[4,"ngIf"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","",3,"click"],["mat-raised-button","",3,"disabled","click"],["class","calibration-data",4,"ngIf"],[3,"imageData","statusValues"],[3,"moduleType"],[1,"calibration-data"],[1,"value-list"],[2,"margin-bottom","1rem"],[1,"full-width"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","full-width",4,"ngFor","ngForOf"],["matNativeControl","","type","number",3,"ngModel","ngModelChange"],["refInput",""]],template:function(e,o){1&e&&(t.YNc(0,Qo,15,12,"ng-template",null,0,t.W1O),t.TgZ(2,"ff-missing-controller-banner"),t.YNc(3,ti,6,7,"section",1),t.ALo(4,"async"),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,1,o.moduleData$)))},directives:[x.uh,U.Hw,x.xY,x.H8,E.lW,x.ZT,ut,_.O5,S.a8,S.n5,S.dn,N.KE,N.hX,gt.gD,_.sg,re.ey,rt.Nt,L.wV,L.Fj,L.JJ,L.On,S.hq,No,qo],pipes:[A.X$,_.Ov,Jo],styles:["[_nghost-%COMP%]{display:block;overflow:auto;max-width:100dvw}.mat-icon[_ngcontent-%COMP%]{line-height:24px}.value-list[_ngcontent-%COMP%]{max-width:40rem}.full-width[_ngcontent-%COMP%]{display:block}.calibration-data[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;grid-gap:1rem;margin-top:1rem}@media screen and (min-width: 1200px){[_nghost-%COMP%]{padding:10px;max-width:60dvw}.calibration-data[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"]}),n})();var ni=p(8977);const oi=["durationEditEnabled"],ii=["durationInput"];function ri(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t._UZ(5,"input",13,14),t._uU(7),t.ALo(8,"translate"),t.TgZ(9,"mat-button-toggle",15,16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).clickEditDuration()}),t.TgZ(11,"mat-icon"),t._uU(12,"edit"),t.qZA()()()()}if(2&n){const e=t.MAs(10),o=t.oxw().ngIf;t.xp6(2),t.Oqu(t.lcZ(3,4,"Fertigungsdauer")),t.xp6(3),t.Q6J("value",o.productionDuration)("disabled",!e.checked),t.xp6(2),t.hij(" \xa0",t.lcZ(8,6,"Sekunden"),"\xa0 ")}}const ai=function(n){return[n]};function si(n,r){if(1&n&&(t.TgZ(0,"a",17)(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3," tune "),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.Q6J("routerLink",t.VKq(7,ai,e.CALIBRATION_ROUTE)),t.xp6(1),t.Q6J("title",t.lcZ(2,3,"Kalibrieren")),t.xp6(3),t.hij(" ",t.lcZ(5,5,"Kalibrieren")," ")}}const li=function(n,r,e){return[n,r,e]};function ci(n,r){if(1&n&&(t.TgZ(0,"a",20),t.ALo(1,"async"),t.TgZ(2,"span",21),t._uU(3),t.qZA(),t._uU(4,"\xa0 "),t.TgZ(5,"span",22),t._uU(6),t.qZA()()),2&n){const e=t.oxw().ngIf,o=t.oxw(2);t.Q6J("routerLink",t.kEZ(5,li,t.lcZ(1,3,o.routeToRoot$),o.ORDERS_ROUTE,e.orderId)),t.xp6(3),t.Oqu(e.workpiece),t.xp6(3),t.Oqu(e.orderId)}}function ui(n,r){if(1&n&&(t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t.YNc(5,ci,7,9,"a",19),t.qZA(),t.TgZ(6,"dt"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"dd"),t._uU(10),t.ALo(11,"translate"),t.qZA()()),2&n){const e=r.ngIf;let o;t.xp6(2),t.Oqu(t.lcZ(3,4,"Bestellung")),t.xp6(3),t.Q6J("ngIf",e.orderId),t.xp6(2),t.Oqu(t.lcZ(8,6,"Start der Bearbeitung")),t.xp6(3),t.Oqu(null!==(o=e.startedAt)&&void 0!==o?o:t.lcZ(11,8,"Unbekannt"))}}function di(n,r){if(1&n&&(t.TgZ(0,"section",1)(1,"h1"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",2)(6,"section",3)(7,"section",4),t._UZ(8,"img",5),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"section",6)(11,"h3"),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.YNc(14,ri,13,8,"dl",7),t.TgZ(15,"dl")(16,"dt"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"dd"),t._uU(20),t.qZA()(),t.TgZ(21,"dl")(22,"dt"),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"dd"),t._uU(26),t.TgZ(27,"button",8)(28,"mat-icon"),t._uU(29,"more"),t.qZA()()()(),t.TgZ(30,"dl")(31,"dt"),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"dd"),t._uU(35),t.YNc(36,si,6,9,"a",9),t.qZA()()()(),t.TgZ(37,"section",10),t._UZ(38,"ff-factory-layout",11),t.qZA()(),t.TgZ(39,"section",12)(40,"h3"),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.YNc(43,ui,12,10,"dl",7),t.ALo(44,"async"),t.qZA()()),2&n){const e=r.ngIf,o=t.oxw();let i;t.xp6(2),t.lnq("",t.lcZ(3,19,"Moduleinstellungen")," - ",t.lcZ(4,21,"Produktionsschritt."+e.subType)," (ID: ",e.serialNumber,")"),t.xp6(6),t.Q6J("src","assets/images/ic_ft_"+(null==e.subType?null:e.subType.toLowerCase())+".svg",t.LSH),t.uIk("alt",t.lcZ(9,23,"Produktionsschritt."+e.subType)),t.xp6(4),t.Oqu(t.lcZ(13,25,"Modulwerte")),t.xp6(2),t.Q6J("ngIf",void 0!==e.productionDuration),t.xp6(3),t.Oqu(t.lcZ(18,27,"Verbunden")),t.xp6(3),t.Oqu(e.connected),t.xp6(3),t.Oqu(t.lcZ(24,29,"Blockiert durch Fehler")),t.xp6(3),t.hij(" ",e.connected&&e.available===o.BLOCKED_STATE," "),t.xp6(6),t.Oqu(t.lcZ(33,31,"Kalibrierung")),t.xp6(3),t.hij(" ",null!==(i=e.calibrating)&&void 0!==i&&i," "),t.xp6(1),t.Q6J("ngIf",e.hasCalibration),t.xp6(2),t.Q6J("startZoom",.6)("editable",!1)("highlightedId",o.moduleId),t.xp6(3),t.Oqu(t.lcZ(42,33,"Aktueller Auftrag")),t.xp6(2),t.Q6J("ngIf",t.lcZ(44,35,o.orderInfo$))}}let pi=(()=>{class n{constructor(e,o,i,a,s){this.factoryLayoutService=e,this.statesService=o,this.orderStatesService=i,this.mqttClient=a,this.route=s,this.ORDERS_ROUTE=M.ORDERS,this.moduleId$=new H.X(void 0),this.destroyed$=new Rt.x,this.BLOCKED_STATE=Tt.BLOCKED,this.CALIBRATION_ROUTE=M.CALIBRATION,s.params.pipe((0,F.R)(this.destroyed$)).subscribe(l=>{l.moduleId&&(this.moduleId=l.moduleId)}),this.routeToRoot$=oe(s),this.moduleData$=this.createModuleDataObservable(),this.orderInfo$=this.createOrderInfoObservable()}set moduleId(e){this.moduleId$.next(e)}get moduleId(){return this.moduleId$.value}findLatestOrderStepIndexForModule(e,o){for(let i=e.productionSteps.length-1;i>=0;i--){const a=e.productionSteps[i];if("MANUFACTURE"===a.type&&a.serialNumber===o&&a.state!==v.ENQUEUED&&a.startedAt)return i}return-1}findStartOfCurrentModuleSteps(e,o,i){let a;for(let s=i;s>=0;s--){const l=e.productionSteps[s];if("MANUFACTURE"!==l.type||l.serialNumber!==o||l.state===v.ENQUEUED||!l.startedAt)break;a=l}return a}hasCurrentlyRemainingModuleSteps(e,o,i){let a=!1;if(i<0)return!1;for(let s=i;s<e.productionSteps.length;s++){const l=e.productionSteps[s];if("MANUFACTURE"!==l.type||l.serialNumber!==o)break;if(l.state===v.ENQUEUED||l.state===v.IN_PROGRESS){a=!0;break}}return a}createOrderInfoObservable(){return this.statesService.moduleStates$.pipe((0,dt.V)(this.moduleId$),(0,m.U)(([o,i])=>i?o.get(i):void 0),(0,$.h)(o=>!!o),(0,ni.x)()).pipe((0,dt.V)(this.orderStatesService.activeOrders$.pipe((0,D.O)([]))),(0,m.U)(([o,i])=>{let a,s;const l=i.find(d=>d.orderId===o.orderId);if(l){const d=this.findLatestOrderStepIndexForModule(l,o.serialNumber);s=this.findStartOfCurrentModuleSteps(l,o.serialNumber,d),this.hasCurrentlyRemainingModuleSteps(l,o.serialNumber,d)&&(a={orderId:o.orderId,workpiece:null==l?void 0:l.type,workpieceId:null==l?void 0:l.workpieceId,startedAt:null==s?void 0:s.startedAt})}return a}))}createModuleDataObservable(){return this.factoryLayoutService.pairedModules$.pipe((0,dt.V)(this.moduleId$),(0,m.U)(([e,o])=>o?e.find(i=>i.serialNumber===o):void 0),(0,T.d)(1),(0,F.R)(this.destroyed$))}ngOnDestroy(){this.destroyed$.complete(),this.moduleId$.complete()}clickEditDuration(){if(this.moduleId&&!this.durationEditToggle.checked){const e={serialNumber:this.moduleId,duration:Number(this.durationInput.nativeElement.value)};this.mqttClient.publish(y.SET_MODULE_DURATION,e)}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(St),t.Y36(K),t.Y36(ct),t.Y36(I),t.Y36(Z.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-module-details"]],viewQuery:function(e,o){if(1&e&&(t.Gf(oi,5),t.Gf(ii,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.durationEditToggle=i.first),t.iGM(i=t.CRH())&&(o.durationInput=i.first)}},inputs:{moduleId:"moduleId"},decls:3,vars:3,consts:[["id","module-details",4,"ngIf"],["id","module-details"],[1,"wideflex"],[1,"left"],[1,"image"],[3,"src"],[1,"module_settings"],[4,"ngIf"],["mat-icon-button",""],["class","calibration-button","mat-stroked-button","",3,"routerLink",4,"ngIf"],[1,"location"],[3,"startZoom","editable","highlightedId"],[1,"order_info"],["type","number",3,"value","disabled"],["durationInput",""],[3,"click"],["durationEditEnabled",""],["mat-stroked-button","",1,"calibration-button",3,"routerLink"],[3,"title"],[3,"routerLink",4,"ngIf"],[3,"routerLink"],[1,"workpiece"],[1,"orderId"]],template:function(e,o){1&e&&(t.TgZ(0,"ff-missing-controller-banner"),t.YNc(1,di,45,37,"section",0),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.moduleData$)))},directives:[ut,_.O5,Ft.Yi,U.Hw,E.lW,E.zs,Z.yS,ie],pipes:[_.Ov,A.X$],styles:["[_nghost-%COMP%]{display:block;overflow:auto}@media screen and (min-width: 1200px){[_nghost-%COMP%]{padding:10px}}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;max-width:20rem;height:auto}.wideflex[_ngcontent-%COMP%]{width:100%;flex-flow:row wrap}.wideflex[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{min-height:300px;flex:1}.wideflex[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{overflow:auto}@media screen and (min-width: 800px){.wideflex[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1 1}.wideflex[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center}.wideflex[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{flex-basis:30%}.wideflex[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{flex-basis:60%}}.module_settings[_ngcontent-%COMP%]{font-size:1.2rem}.module_settings[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem}"]}),n})();class _i extends C.by{constructor(r,e){super(),this.pairingState$=r,this.translate=e,this.connectionCount=0,this.sortingDataAccessor=(o,i)=>{var a;switch(i){case"serialNumber":return o.serialNumber;case"connected":return o.connected?1:0;case"name":return this.translate.instant("Produktionsschritt."+(null!==(a=o.subType)&&void 0!==a?a:o.type));default:return""}},this.sortData=(o,i)=>{const a=i.active,s=i.direction;return a&&""!==s?o.sort((l,d)=>(this.sortingDataAccessor(l,a)<this.sortingDataAccessor(d,a)?-1:1)*("asc"===s?1:-1)):o}}connect(){const r=e=>"FTS"===(null==e?void 0:e.type);return this.collection$||(this.collection$=this.pairingState$.pipe((0,m.U)(e=>[...e.modules,...e.transports]),(0,m.U)(e=>e.map(o=>{var i;return{type:o.type,subType:o.subType,ip:o.ip,version:o.version,connected:null!==(i=o.connected)&&void 0!==i&&i,available:o.available,pairedSince:o.pairedSince,serialNumber:o.serialNumber,hasCalibration:o.hasCalibration,charging:r(o)?o.charging:void 0}}))).subscribe(e=>this.data=e)),this.connectionCount++,super.connect()}disconnect(){this.connectionCount&&(this.connectionCount--,0===this.connectionCount&&this.collection$&&(this.collection$.unsubscribe(),this.collection$=void 0)),super.disconnect()}}const mi=["parkDialogContent"];function fi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h2",2)(1,"mat-icon"),t._uU(2,"sync_problem"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3)(6,"p"),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"div",4)(10,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendFactoryPark()}),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"button",6),t._uU(14),t.ALo(15,"translate"),t.qZA()()}2&n&&(t.xp6(3),t.hij(" ",t.lcZ(4,4,"Fabrik parken"),""),t.xp6(4),t.Oqu(t.lcZ(8,6,"Sollen die Fabrikmodule geparkt werden?")),t.xp6(4),t.Oqu(t.lcZ(12,8,"Ja")),t.xp6(3),t.Oqu(t.lcZ(15,10,"Nein")))}let gi=(()=>{class n{constructor(e,o){this.dialog=e,this.mqtt=o}confirmFactoryPark(){this.dialog.open(this.parkDialogContent)}sendFactoryPark(){const e={timestamp:new Date};this.mqtt.publish(y.SET_PARK,e,{qos:2})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.uw),t.Y36(I))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-factory-park"]],viewQuery:function(e,o){if(1&e&&t.Gf(mi,5),2&e){let i;t.iGM(i=t.CRH())&&(o.parkDialogContent=i.first)}},decls:7,vars:6,consts:[["parkDialogContent",""],["mat-mini-fab","","color","primary",1,"action-btn",3,"title","click"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-flat-button","","mat-dialog-close","","color","warn",3,"click"],["mat-flat-button","","mat-dialog-close","","cdkFocusInitial",""]],template:function(e,o){1&e&&(t.YNc(0,fi,16,12,"ng-template",null,0,t.W1O),t.TgZ(2,"button",1),t.NdJ("click",function(){return o.confirmFactoryPark()}),t.ALo(3,"translate"),t.ALo(4,"translate"),t.TgZ(5,"mat-icon"),t._uU(6,"local_parking"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("title",t.lcZ(3,2,"Fabrik parken")),t.uIk("aria-label",t.lcZ(4,4,"Fabrik parken")))},directives:[x.uh,U.Hw,x.xY,x.H8,E.lW,x.ZT],pipes:[A.X$],styles:["[_nghost-%COMP%]{position:absolute;top:45px;right:65px;z-index:2001}.extended-fab-button[_ngcontent-%COMP%]{width:unset;padding:0 26px;border-radius:29px}.extended-fab-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:10px}.extended-fab-button[_ngcontent-%COMP%]   .extended-fab-button__text[_ngcontent-%COMP%]{font-weight:300;letter-spacing:.1em;text-transform:uppercase}"]}),n})(),Nt=(()=>{class n{transform(e,o={}){return e in o?o[e]:e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"toIcon",type:n,pure:!0}),n})();function hi(n,r){1&n&&t._UZ(0,"th",14)}function Ci(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().moduleSelected(a)}),t._UZ(1,"img",16),t.ALo(2,"toIcon"),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw();let i;t.xp6(1),t.Q6J("src",t.xi3(2,1,null!==(i=e.subType)&&void 0!==i?i:e.type,o.MODULE_ICON_PATHS),t.LSH)}}function Ti(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"ID")))}function Ai(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().moduleSelected(a)}),t.TgZ(1,"span",18),t._uU(2),t.qZA()()}if(2&n){const e=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("title",o.getMetadata(e)),t.xp6(1),t.hij(" ",e.serialNumber," ")}}function xi(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Name")))}function Oi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().moduleSelected(a)}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&n){const e=r.$implicit;let o;t.xp6(2),t.hij(" ",t.lcZ(3,1,"Produktionsschritt."+(null!==(o=e.subType)&&void 0!==o?o:e.type))," ")}}function yi(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Verbunden")))}function bi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().moduleSelected(a)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3),t.qZA()()}if(2&n){const e=r.$implicit;t.xp6(1),t.Q6J("title",e.connected?"Verbunden":t.lcZ(2,2,"Nicht verbunden")),t.xp6(2),t.hij(" ",e.connected?"wifi":"wifi_off"," ")}}function Si(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Verf\xfcgbarkeitsstatus")))}function vi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"td",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().moduleSelected(a)}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,"AvailableState."+e.available)," ")}}function Zi(n,r){1&n&&(t.TgZ(0,"th",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Konfiguriert")))}function Fi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit;return t.oxw().connectFts(i)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3," pin_drop "),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(2,2,"Docke an DPS")),t.xp6(3),t.hij(" ",t.lcZ(5,4,"Docke an DPS")," "))}function Li(n,r){if(1&n&&(t.TgZ(0,"mat-icon",18),t._uU(1," place "),t.qZA()),2&n){const e=t.oxw(3).$implicit,o=t.oxw();t.Q6J("title",o.getInFactorySince(e))}}function Mi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"a",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit;return t.oxw().setFtsCharge(i,!0)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3," power "),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(2,2,"Laden")),t.xp6(3),t.hij(" ",t.lcZ(5,4,"Laden")," "))}function Pi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"a",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3).$implicit;return t.oxw().setFtsCharge(i,!1)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3," battery_charging_full "),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(2,2,"Laden")),t.xp6(3),t.hij(" ",t.lcZ(5,4,"Laden beenden")," "))}function wi(n,r){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,Fi,6,6,"button",22),t.YNc(2,Li,2,1,"mat-icon",23),t.YNc(3,Mi,6,6,"a",24),t.YNc(4,Pi,6,6,"a",24),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",!e.pairedSince),t.xp6(1),t.Q6J("ngIf",e.pairedSince),t.xp6(1),t.Q6J("ngIf",!e.charging&&e.pairedSince),t.xp6(1),t.Q6J("ngIf",e.charging&&e.pairedSince)}}function Ii(n,r){if(1&n&&(t.ynx(0),t.YNc(1,wi,5,4,"span",20),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.connected)}}function Ei(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-icon",18),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("title",o.getPairedSince(e)),t.xp6(1),t.hij(" ",e.pairedSince?"grid_on":"grid_off"," ")}}const Ui=function(n,r){return[n,r]};function Ri(n,r){if(1&n&&(t.TgZ(0,"a",27)(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3," tune "),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.Q6J("routerLink",t.WLB(7,Ui,e.serialNumber,o.CALIBRATION_ROUTE)),t.xp6(1),t.Q6J("title",t.lcZ(2,3,"Kalibrieren")),t.xp6(3),t.hij(" ",t.lcZ(5,5,"Kalibrieren")," ")}}function Ni(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().confirmDelete(i)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3,"delete"),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(2,2,"L\xf6schen")),t.xp6(3),t.hij(" ",t.lcZ(5,4,"L\xf6schen")," "))}function Di(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().deleteModule(i)}),t.TgZ(1,"mat-icon",18),t.ALo(2,"translate"),t._uU(3,"delete_forever"),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(2,2,"L\xf6schen")),t.xp6(3),t.hij(" ",t.lcZ(5,4,"Endg\xfcltig l\xf6schen")," "))}function ki(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Ni,6,6,"button",28),t.YNc(2,Di,6,6,"button",29),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.pairedSince&&!o.hasConfirmedDelete(e)),t.xp6(1),t.Q6J("ngIf",!e.pairedSince&&o.hasConfirmedDelete(e))}}function qi(n,r){if(1&n&&(t.TgZ(0,"td",19),t.YNc(1,Ii,2,1,"ng-container",20),t.YNc(2,Ei,3,2,"ng-container",20),t.YNc(3,Ri,6,10,"a",21),t.YNc(4,ki,3,2,"ng-container",20),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngIf",e.type===o.DeviceType.FTS),t.xp6(1),t.Q6J("ngIf",e.type===o.DeviceType.MODULE),t.xp6(1),t.Q6J("ngIf",e.hasCalibration),t.xp6(1),t.Q6J("ngIf",e.type===o.DeviceType.MODULE)}}function $i(n,r){1&n&&t._UZ(0,"tr",32)}function Ji(n,r){1&n&&t._UZ(0,"tr",33),2&n&&t.ekj("has-details","MODULE"===r.$implicit.type)}let Qi=(()=>{class n{constructor(e,o,i,a,s){this.factoryLayoutService=e,this.translate=o,this.mqttService=i,this.router=a,this.activatedRoute=s,this.MODULE_ICON_PATHS=Fe,this.CALIBRATION_ROUTE=M.CALIBRATION,this.DeviceType=Ae,this.displayedColumns=["icon","serialNumber","name","connected","available","paired"],this.deletionMap=new Map,this.dataSource=new _i(e.pairingState$,o)}ngAfterViewInit(){this.dataSource.sort=this.sort}getMetadata(e){return e.ip&&e.version?`${e.version} - ${e.ip}`:this.translate.instant("Keine Metadaten verf\xfcgbar")}getInFactorySince(e){return e.pairedSince?this.translate.instant("In Fabrik eingebunden seit {{since}}",{since:e.pairedSince}):this.translate.instant("nicht in Fabrik eingebunden")}getPairedSince(e){return e.pairedSince?this.translate.instant("im Layout seit {{since}}",{since:e.pairedSince}):this.translate.instant("nicht im Layout")}connectFts(e){this.mqttService.publish(y.PAIRING_PAIR_FTS,{serialNumber:e.serialNumber},{qos:2})}moduleSelected(e){e.type===Ae.MODULE&&this.router.navigate([e.serialNumber],{relativeTo:this.activatedRoute})}setFtsCharge(e,o){this.mqttService.publish(y.SET_CHARGE,{serialNumber:e.serialNumber,charge:o},{qos:2})}hasConfirmedDelete(e){return!0===this.deletionMap.get(e.serialNumber)}confirmDelete(e){this.deletionMap.set(e.serialNumber,!0)}deleteModule(e){!0===this.deletionMap.get(e.serialNumber)&&this.mqttService.publish(y.DELETE_MODULE,{serialNumber:e.serialNumber},{qos:2}),this.deletionMap.delete(e.serialNumber)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(St),t.Y36(A.sK),t.Y36(I),t.Y36(Z.F0),t.Y36(Z.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-module-list"]],viewQuery:function(e,o){if(1&e&&t.Gf(z.YE,5),2&e){let i;t.iGM(i=t.CRH())&&(o.sort=i.first)}},decls:26,vars:6,consts:[[1,"header"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","icon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"click",4,"matCellDef"],["matColumnDef","serialNumber"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["matColumnDef","connected"],["matColumnDef","available"],["matColumnDef","paired"],["mat-cell","","class","no-pointer",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"has-details",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",3,"click"],[3,"src"],["mat-header-cell","","mat-sort-header",""],[3,"title"],["mat-cell","",1,"no-pointer"],[4,"ngIf"],["class","calibration-button","mat-stroked-button","",3,"routerLink",4,"ngIf"],["mat-stroked-button","",3,"click",4,"ngIf"],[3,"title",4,"ngIf"],["class","charge-button","mat-stroked-button","",3,"click",4,"ngIf"],["mat-stroked-button","",3,"click"],["mat-stroked-button","",1,"charge-button",3,"click"],["mat-stroked-button","",1,"calibration-button",3,"routerLink"],["mat-stroked-button","","color","warn","class","delete-module-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","delete-module-button",3,"click",4,"ngIf"],["mat-stroked-button","","color","warn",1,"delete-module-button",3,"click"],["mat-flat-button","","color","warn",1,"delete-module-button",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"ff-missing-controller-banner")(1,"h2",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"ff-factory-park"),t.TgZ(5,"table",1),t.ynx(6,2),t.YNc(7,hi,1,0,"th",3),t.YNc(8,Ci,3,4,"td",4),t.BQk(),t.ynx(9,5),t.YNc(10,Ti,3,3,"th",6),t.YNc(11,Ai,3,2,"td",4),t.BQk(),t.ynx(12,7),t.YNc(13,xi,3,3,"th",6),t.YNc(14,Oi,4,3,"td",4),t.BQk(),t.ynx(15,8),t.YNc(16,yi,3,3,"th",6),t.YNc(17,bi,4,4,"td",4),t.BQk(),t.ynx(18,9),t.YNc(19,Si,3,3,"th",6),t.YNc(20,vi,3,3,"td",4),t.BQk(),t.ynx(21,10),t.YNc(22,Zi,3,3,"th",3),t.YNc(23,qi,5,4,"td",11),t.BQk(),t.YNc(24,$i,1,0,"tr",12),t.YNc(25,Ji,1,2,"tr",13),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,4,"Modul\xfcbersicht")),t.xp6(3),t.Q6J("dataSource",o.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns))},directives:[ut,gi,C.BZ,z.YE,C.w1,C.fO,C.ge,C.Dz,C.ev,z.nU,U.Hw,_.O5,E.lW,E.zs,Z.yS,C.as,C.XQ,C.nj,C.Gk],pipes:[A.X$,Nt],styles:["[_nghost-%COMP%]{display:block;padding:10px}h3[_ngcontent-%COMP%]{margin:16px 0 0}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{padding:10px}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle;line-height:24px}.calibration-button[_ngcontent-%COMP%], .delete-module-button[_ngcontent-%COMP%]{margin-left:10px;display:inline-block}.mat-column-icon[_ngcontent-%COMP%]{width:4rem}.mat-column-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3rem}.mat-row.has-details[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{cursor:pointer}.mat-row.has-details[_ngcontent-%COMP%]   .mat-cell.no-pointer[_ngcontent-%COMP%]{cursor:default}.mat-row[_ngcontent-%COMP%]:hover   .mat-cell[_ngcontent-%COMP%]{background:var(--primary-lighter-color)}@media only screen and (max-width: 640px){.mat-header-row[_ngcontent-%COMP%]{display:none}.mat-row[_ngcontent-%COMP%]   .mat-cell.mat-column-name[_ngcontent-%COMP%]{max-width:calc(100vw - 4rem)}.mat-row[_ngcontent-%COMP%]   .mat-cell.mat-column-serialnumber[_ngcontent-%COMP%]{order:3}}.mat-column-paired[_ngcontent-%COMP%]{min-width:250px}"]}),n})();var Pe=p(629);let we=(()=>{class n{constructor(e,o){this.mqttService=e,this.orderStatesService=o,this.selectedOrder=new H.X(void 0),this.activeOrders$=this.orderStatesService.activeOrders$.pipe(this.filterOrdersByType(),(0,T.d)(1)),this.completedOrders$=this.orderStatesService.completedOrders$.pipe(this.filterOrdersByType(),(0,T.d)(1))}setSelectedOrder(e){this.selectedOrder.next(e)}isOrderSelected(e){var o;return(null===(o=this.selectedOrder.value)||void 0===o?void 0:o.orderId)===e.orderId}deleteOrder(e,o){e.stopPropagation(),this.mqttService.publish(y.CANCEL_ORDERS,[o])}filterOrdersByType(){return(0,Pe.z)((0,m.U)(e=>null!=e?e:[]),(0,m.U)(e=>e.filter(o=>"PRODUCTION"===o.orderType)),(0,D.O)([]))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I),t.LFG(ct))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();function Yi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().order;return t.oxw().state.deleteOrder(i,a.orderId)}),t.TgZ(1,"mat-icon",10),t.ALo(2,"translate"),t.ALo(3,"translate"),t._uU(4," delete "),t.qZA()()}2&n&&(t.xp6(1),t.Q6J("title",t.lcZ(3,4,"Abbrechen")),t.uIk("aria-label",t.lcZ(2,2,"Abbrechen")))}function Hi(n,r){if(1&n&&(t.TgZ(0,"div",5)(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.TgZ(9,"span",6)(10,"mat-icon",7),t.ALo(11,"translate"),t.ALo(12,"translate"),t._uU(13),t.ALo(14,"toIcon"),t.qZA()(),t.TgZ(15,"span"),t._uU(16),t.ALo(17,"date"),t.YNc(18,Yi,5,6,"button",8),t.qZA()()),2&n){const e=r.order,o=t.oxw();t.Q6J("title","ID: "+e.orderId),t.xp6(2),t.Oqu(t.lcZ(3,9,"Auftrag")),t.xp6(3),t.Oqu(t.xi3(6,11,e.timestamp,"hh:mm")),t.xp6(3),t.Oqu(e.type),t.xp6(2),t.Q6J("title",t.lcZ(12,16,"Status."+e.state)),t.uIk("aria-label",t.lcZ(11,14,"Status."+e.state)),t.xp6(3),t.hij(" ",t.xi3(14,18,e.state,o.stateIcons)," "),t.xp6(3),t.hij(" ",t.xi3(17,21,e.startedAt,"short")," "),t.xp6(2),t.Q6J("ngIf","ENQUEUED"===e.state&&o.canRemove)}}function Bi(n,r){1&n&&(t.TgZ(0,"h2",1),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Laufende Auftr\xe4ge")," "))}function Gi(n,r){1&n&&(t.TgZ(0,"h2",1),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Keine laufenden Auftr\xe4ge verf\xfcgbar")," "))}function Wi(n,r){1&n&&t.GkF(0)}const Ie=function(n){return{order:n}};function Vi(n,r){if(1&n&&(t.TgZ(0,"mat-list-option",14),t.YNc(1,Wi,1,0,"ng-container",15),t.qZA()),2&n){const e=r.$implicit,o=t.oxw(2),i=t.MAs(1);t.Q6J("selected",o.state.isOrderSelected(e))("value",e),t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(4,Ie,e))}}function ji(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"mat-selection-list",12),t.NdJ("selectionChange",function(i){return t.CHM(e),t.oxw().selectOrder(i)}),t.YNc(2,Vi,2,6,"mat-list-option",13),t.ALo(3,"async"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",t.lcZ(3,2,e.activeOrders$))}}function zi(n,r){1&n&&(t.TgZ(0,"h2",1),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Abgeschlossene Auftr\xe4ge")," "))}function Ki(n,r){1&n&&(t.TgZ(0,"h2",1),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Keine abgeschlossenen Auftr\xe4ge verf\xfcgbar")," "))}function Xi(n,r){1&n&&t.GkF(0)}function tr(n,r){if(1&n&&(t.TgZ(0,"mat-list-option",14),t.YNc(1,Xi,1,0,"ng-container",15),t.qZA()),2&n){const e=r.$implicit,o=t.oxw(3),i=t.MAs(1);t.Q6J("selected",o.state.isOrderSelected(e))("value",e),t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(4,Ie,e))}}function er(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"mat-selection-list",12),t.NdJ("selectionChange",function(i){return t.CHM(e),t.oxw(2).selectOrder(i)}),t.YNc(2,tr,2,6,"mat-list-option",13),t.ALo(3,"async"),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",t.lcZ(3,2,e.completedOrders$))}}function nr(n,r){if(1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-title",1),t.YNc(2,zi,3,3,"h2",2),t.ALo(3,"async"),t.YNc(4,Ki,3,3,"h2",2),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"mat-card-content"),t.YNc(7,er,4,4,"div",3),t.ALo(8,"async"),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,3,e.completedOrders$).length>0),t.xp6(2),t.Q6J("ngIf",0===t.lcZ(5,5,e.completedOrders$).length),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,7,e.completedOrders$).length>0)}}let Ee=(()=>{class n{constructor(e){this.state=e,this.stepTypeIcon={MANUFACTURE:"precision_manufacturing",NAVIGATION:"forklift"},this.stateIcons={[v.ENQUEUED]:"hourglass_empty",[v.IN_PROGRESS]:"play_circle",[v.FINISHED]:"check_circle",[v.ERROR]:"error",[v.CANCELLED]:"hourglass_disabled"},this.multiple=!1,this.withCompleted=!1,this.canRemove=!0,this.orderSelect=new t.vpe,this.activeOrders$=this.state.activeOrders$.pipe((0,m.U)(o=>o.filter(i=>void 0===this.simulationId||i.simulationId==this.simulationId)),(0,T.d)(1)),this.completedOrders$=this.state.completedOrders$.pipe((0,m.U)(o=>o.filter(i=>void 0===this.simulationId||i.simulationId==this.simulationId)),(0,T.d)(1))}set selectedOrder(e){this.state.setSelectedOrder(e)}selectOrder(e){const o=e.options.map(i=>i.value);this.orderSelect.emit(o)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(we))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-order-list"]],inputs:{multiple:"multiple",withCompleted:"withCompleted",canRemove:"canRemove",selectedOrder:"selectedOrder",simulationId:"simulationId"},outputs:{orderSelect:"orderSelect"},features:[t._Bn([we])],decls:12,vars:10,consts:[["listoption",""],[1,"mb-0"],["class","mb-0",4,"ngIf"],["class","production-orders__list",4,"ngIf"],[4,"ngIf"],[1,"production-orders__list__item__content",3,"title"],[1,"icon_column"],[1,"step-state",3,"title"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],[3,"title"],[1,"production-orders__list"],[3,"multiple","selectionChange"],["color","accent","class","production-orders__list__item",3,"selected","value",4,"ngFor","ngForOf"],["color","accent",1,"production-orders__list__item",3,"selected","value"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){if(1&e&&(t.YNc(0,Hi,19,24,"ng-template",null,0,t.W1O),t.TgZ(2,"mat-card")(3,"mat-card-title",1),t.YNc(4,Bi,3,3,"h2",2),t.ALo(5,"async"),t.YNc(6,Gi,3,3,"h2",2),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"mat-card-content"),t.YNc(9,ji,4,4,"div",3),t.ALo(10,"async"),t.qZA()(),t.YNc(11,nr,9,9,"mat-card",4)),2&e){let i;t.xp6(4),t.Q6J("ngIf",t.lcZ(5,4,o.activeOrders$).length>0),t.xp6(2),t.Q6J("ngIf",0===(null==(i=t.lcZ(7,6,o.activeOrders$))?null:i.length)),t.xp6(3),t.Q6J("ngIf",t.lcZ(10,8,o.activeOrders$).length>0),t.xp6(2),t.Q6J("ngIf",o.withCompleted)}},directives:[U.Hw,_.O5,E.lW,S.a8,S.n5,S.dn,j.Ub,_.sg,j.vS,_.tP],pipes:[A.X$,_.uU,Nt,_.Ov],styles:["[_nghost-%COMP%]{height:100%}.mb-0[_ngcontent-%COMP%]{margin-bottom:0}.production-orders__list[_ngcontent-%COMP%]{margin-bottom:10px}.production-orders__list__item__content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.production-orders__list__item__content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;margin-right:10px}.production-orders__list__item__content[_ngcontent-%COMP%]   span.icon_column[_ngcontent-%COMP%]{flex:0}"]}),n})();function or(n,r){if(1&n&&(t._UZ(0,"img",5),t.ALo(1,"toIcon"),t.ALo(2,"translate")),2&n){const e=t.oxw().$implicit,o=t.oxw();t.Q6J("src",t.xi3(1,2,e.moduleType,o.MODULE_ICON_PATHS),t.LSH),t.uIk("alt",t.lcZ(2,5,"Produktionsschritt."+e.moduleType))}}function ir(n,r){if(1&n&&(t._UZ(0,"img",5),t.ALo(1,"toIcon"),t.ALo(2,"translate")),2&n){const e=t.oxw(2);t.Q6J("src",t.xi3(1,2,"FTS",e.MODULE_ICON_PATHS),t.LSH),t.uIk("alt",t.lcZ(2,5,"Produktionsschritt.FTS"))}}function rr(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE("",t.lcZ(2,2,"Produktionsschritt."+e.moduleType)," : ",t.lcZ(3,4,"Befehl."+e.command),"")}}function ar(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.TgZ(3,"mat-icon",6),t._uU(4,"chevron_right"),t.qZA(),t._UZ(5,"img",5),t.ALo(6,"toIcon"),t.ALo(7,"translate"),t._uU(8),t.ALo(9,"translate"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij("",t.lcZ(2,4,"Produktionsschritt.FTS")," "),t.xp6(4),t.Q6J("src",t.xi3(6,6,e.target,o.MODULE_ICON_PATHS),t.LSH),t.uIk("alt",t.lcZ(7,9,"Produktionsschritt."+e.target)),t.xp6(3),t.hij(" ",t.lcZ(9,11,"Produktionsschritt."+e.target)," ")}}function sr(n,r){if(1&n&&(t.TgZ(0,"mat-list-item",1)(1,"span"),t.YNc(2,or,3,7,"img",2),t.YNc(3,ir,3,7,"img",2),t.qZA(),t.TgZ(4,"span")(5,"mat-icon",3),t.ALo(6,"translate"),t.ALo(7,"translate"),t._uU(8),t.ALo(9,"toIcon"),t.qZA()(),t.YNc(10,rr,4,6,"span",4),t.YNc(11,ar,10,13,"span",4),t.qZA()),2&n){const e=r.$implicit,o=t.oxw();t.ekj("mat-list-single-selected-option","IN_PROGRESS"===e.state),t.xp6(2),t.Q6J("ngIf","MANUFACTURE"===e.type),t.xp6(1),t.Q6J("ngIf","NAVIGATION"===e.type),t.xp6(2),t.Q6J("title",t.lcZ(7,11,"Status."+e.state)),t.uIk("aria-label",t.lcZ(6,9,"Status."+e.state)),t.xp6(3),t.hij(" ",t.xi3(9,13,e.state,o.stateIcons)," "),t.xp6(2),t.Q6J("ngIf","MANUFACTURE"===e.type),t.xp6(1),t.Q6J("ngIf","NAVIGATION"===e.type)}}let Ue=(()=>{class n{constructor(){this.MODULE_ICON_PATHS=Fe,this.actionHtmlStrings={[P.CHECK_QUALITY]:"Qualit\xe4tspr\xfcfung",[P.PICK]:"FTS entladen",[P.DROP]:"FTS beladen",[P.MILL]:"Fr\xe4sen",[P.DRILL]:"Bohren",[P.FIRE]:"Erhitzen"},this.stateIcons={[v.ENQUEUED]:"hourglass_empty",[v.IN_PROGRESS]:"play_circle",[v.FINISHED]:"check_circle",[v.ERROR]:"error",[v.CANCELLED]:"hourglass_disabled"},this.order=void 0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-production-steps"]],inputs:{order:"order"},decls:2,vars:1,consts:[["class","production-order-steps__item",3,"mat-list-single-selected-option",4,"ngFor","ngForOf"],[1,"production-order-steps__item"],["style","vertical-align: middle; height: 24px",3,"src",4,"ngIf"],[1,"step-state",3,"title"],[4,"ngIf"],[2,"vertical-align","middle","height","24px",3,"src"],[2,"vertical-align","middle"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,sr,12,16,"mat-list-item",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",null==o.order?null:o.order.productionSteps))},directives:[j.i$,_.sg,j.Tg,_.O5,U.Hw],pipes:[Nt,A.X$],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column}.production-order-steps__item[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.production-order-steps__item[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),n})();const lr=["selectionList"];function cr(n,r){if(1&n&&(t.TgZ(0,"mat-card",8)(1,"mat-card-title")(2,"h2",5),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"mat-card-content"),t._UZ(6,"ff-production-steps",9),t.qZA()()),2&n){const e=r.ngIf;t.xp6(3),t.Oqu(t.lcZ(4,2,"Fertigungsschritte")),t.xp6(3),t.Q6J("order",e)}}function ur(n,r){if(1&n&&(t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(2),t.Oqu(t.lcZ(3,2,"Bestelldatum")),t.xp6(3),t.Oqu(t.xi3(6,4,e.timestamp,"short"))}}function dr(n,r){if(1&n&&(t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(2),t.Oqu(t.lcZ(3,2,"Auftragseingang")),t.xp6(3),t.Oqu(t.xi3(6,4,e.receivedAt,"short"))}}function pr(n,r){if(1&n&&(t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(2),t.Oqu(t.lcZ(3,2,"Start der Bearbeitung")),t.xp6(3),t.Oqu(t.xi3(6,4,e.startedAt,"short"))}}function _r(n,r){if(1&n&&(t.TgZ(0,"dl")(1,"dt"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd"),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(2),t.Oqu(t.lcZ(3,2,"Ende der Bearbeitung")),t.xp6(3),t.Oqu(t.xi3(6,4,e.stoppedAt,"short"))}}function mr(n,r){if(1&n&&(t.TgZ(0,"mat-card",10)(1,"mat-card-title")(2,"h2",5),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"dl")(7,"dt"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"dd"),t._uU(11),t.qZA()(),t.TgZ(12,"dl")(13,"dt"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"dd"),t._uU(17),t.ALo(18,"translate"),t.qZA()(),t.YNc(19,ur,7,7,"dl",11),t.YNc(20,dr,7,7,"dl",11),t.YNc(21,pr,7,7,"dl",11),t.YNc(22,_r,7,7,"dl",11),t.qZA()()),2&n){const e=r.ngIf;t.xp6(3),t.Oqu(t.lcZ(4,9,"Auftragsinformationen")),t.xp6(5),t.Oqu(t.lcZ(9,11,"Auftragsnummer")),t.xp6(3),t.Oqu(e.orderId),t.xp6(3),t.Oqu(t.lcZ(15,13,"Auftragsstatus")),t.xp6(3),t.Oqu(t.lcZ(18,15,"Status."+e.state)),t.xp6(2),t.Q6J("ngIf",e.timestamp),t.xp6(1),t.Q6J("ngIf",e.receivedAt),t.xp6(1),t.Q6J("ngIf",e.startedAt),t.xp6(1),t.Q6J("ngIf",e.stoppedAt)}}let Re=(()=>{class n{constructor(e,o,i,a){this.mqttService=e,this.orderStatesService=o,this.activatedRoute=i,this.router=a,this.destroyed$=new Rt.x,this.paramOrderId$=this.activatedRoute.paramMap.pipe((0,F.R)(this.destroyed$),(0,m.U)(s=>s.get("orderId"))),this.activeOrders$=this.orderStatesService.activeOrders$.pipe((0,m.U)(s=>s.filter(l=>"PRODUCTION"===l.orderType))),this.selectedOrder$=(0,et.a)([this.paramOrderId$,this.activeOrders$]).pipe((0,m.U)(([s,l])=>{const d=s?l.find(c=>s===c.orderId):void 0;return null!=d?d:l.length?l[0]:void 0}),(0,T.d)(1)),this.activeStepId$=this.selectedOrder$.pipe((0,m.U)(s=>{if(!s)return;const l=this.getUsedProductionSteps(s);return(null==l?void 0:l.length)?l.reverse()[0].serialNumber:void 0}))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}selectOrder(e){var o=this;return(0,nt.Z)(function*(){const a=[null!=(yield(0,bt.z)(o.paramOrderId$))?"..":".",e[0].orderId];yield o.router.navigate(a,{relativeTo:o.activatedRoute})})()}getUsedProductionSteps(e){return e.productionSteps.filter(o=>"MANUFACTURE"===o.type&&o.state!==v.ENQUEUED&&o.state!==v.CANCELLED)}deleteOrder(e,o){e.stopPropagation(),this.mqttService.publish(y.CANCEL_ORDERS,[o])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(I),t.Y36(ct),t.Y36(Z.gz),t.Y36(Z.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&t.Gf(lr,5),2&e){let i;t.iGM(i=t.CRH())&&(o.selectionList=i.first)}},decls:18,vars:17,consts:[["id","production-orders",1,"production-orders"],[1,"wideflex"],[1,"col"],[3,"selectedOrder","orderSelect"],["id","production-order-steps","class","production-order-steps",4,"ngIf"],[1,"header"],[3,"startZoom","editable","highlightedId"],["class","production-order-details",4,"ngIf"],["id","production-order-steps",1,"production-order-steps"],[3,"order"],[1,"production-order-details"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ff-order-list",3),t.NdJ("orderSelect",function(a){return o.selectOrder(a)}),t.ALo(4,"async"),t.qZA(),t.YNc(5,cr,7,4,"mat-card",4),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"div",2)(8,"mat-card")(9,"mat-card-title")(10,"h2",5),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"mat-card-content"),t._UZ(14,"ff-factory-layout",6),t.ALo(15,"async"),t.qZA()(),t.YNc(16,mr,23,17,"mat-card",7),t.ALo(17,"async"),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("selectedOrder",t.lcZ(4,7,o.selectedOrder$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,9,o.selectedOrder$)),t.xp6(6),t.hij(" ",t.lcZ(12,11,"Aktueller Fertigungsschritt")," "),t.xp6(3),t.Q6J("startZoom",.6)("editable",!1)("highlightedId",t.lcZ(15,13,o.activeStepId$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(17,15,o.selectedOrder$)))},directives:[Ee,_.O5,S.a8,S.n5,S.dn,Ue,ie],pipes:[_.Ov,A.X$,_.uU],styles:[".wideflex[_ngcontent-%COMP%]{width:100%;flex-flow:row wrap}.wideflex[_ngcontent-%COMP%] > .col[_ngcontent-%COMP%]{min-height:300px;flex-grow:1;margin:10px}dl[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:center}dl[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{flex-basis:30%}dl[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{flex-basis:60%}@media screen and (min-width: 1000px){.wideflex[_ngcontent-%COMP%]{display:flex}.wideflex[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{min-width:40%;max-width:47%}}@media screen and (min-width: 1200px){.wideflex[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{max-width:50%}#production-orders[_ngcontent-%COMP%]{padding:10px}}.production-order-steps__item[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.production-order-steps__item[_ngcontent-%COMP%]   .mat-list-item-content[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{flex:1}.production-orders__list[_ngcontent-%COMP%]{margin-bottom:10px}.production-orders__list__item__content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.production-orders__list__item__content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;margin-right:10px}.production-orders__list__item__content[_ngcontent-%COMP%]   span.icon_column[_ngcontent-%COMP%]{flex:0}"]}),n})();var Dt=p(9337),fr=p(7580);function Ne(n,r){return ce(n)*le(n,r)*ae(n)}function gr(n,r){return ue(n)*De(n,r)*se(n)}function ae(n){const r=n.length;return(r-n.filter(o=>["ERROR","CANCELLED"].includes(o.state)).length)/r}function se(n){return["ERROR","CANCELLED"].includes(n.state)?0:1}function le(n,r){const e=n.reduce((i,a)=>i+kt(a,r),0);return n.reduce((i,a)=>i+r.productionDurations[a.type],0)/e}function De(n,r){return r.productionDurations[n.type]/kt(n,r)}function kt(n,r){return n.startedAt||n.stoppedAt?n.startedAt&&!n.stoppedAt?Math.max(r.productionDurations[n.type],(Date.now()-n.startedAt.getTime())/1e3):(n.stoppedAt.getTime()-n.startedAt.getTime())/1e3:r.productionDurations[n.type]}function ce(n){let r=0,e=0;for(let i of n)r+=$t(i),e+=qt(i);return r/(r+e)}function ue(n){const r=$t(n);return r/(r+qt(n))}function qt(n){var r;let e=0;for(let o of n.productionSteps)if(o.startedAt)if(o.dependentActionId){const i=n.productionSteps.find(a=>a.id===o.dependentActionId);if(i&&i.stoppedAt){const a=o.startedAt.getTime()-i.stoppedAt.getTime();a>500&&(e+=a)}}else{const i=((null===(r=o.startedAt)||void 0===r?void 0:r.getTime())||Date.now())-n.receivedAt.getTime();i>500&&(e+=i)}return e/1e3}function $t(n){let r=0;for(let e of n.productionSteps)r+=hr(e);return r}function hr(n){let r=0;return r=n.startedAt&&n.stoppedAt?n.stoppedAt.getTime()-n.startedAt.getTime():n.startedAt?Date.now()-n.startedAt.getTime():0,r/1e3}let qe=(()=>{class n{constructor(){this.selectedOrder=new H.X(void 0)}setSelectedOrder(e){Array.isArray(e)?this.selectedOrder.next(e[0]):this.selectedOrder.next(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),Cr=(()=>{class n{constructor(e){this.mqttService=e,this.stock$=this.mqttService.subscribe(y.STOCK).pipe(Y(),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(I))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Tr=["*"];let Ar=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-banner"]],ngContentSelectors:Tr,decls:1,vars:0,template:function(e,o){1&e&&(t.F$t(),t.Hsn(0))},styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;align-items:flex-start;justify-content:center;margin:1rem 2rem 0;padding:1rem;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}@media (min-width: 768px){[_nghost-%COMP%]{align-items:center}}"],changeDetection:0}),n})(),$e=(()=>{class n{constructor(){this.selectedOrder=new J.t(1),this.startTime$=this.setupStartTime(this.selectedOrder.asObservable()),this.endTime$=this.setupEndTime(this.selectedOrder.asObservable()),this.duration$=this.setupDuration(this.startTime$,this.endTime$),this.calculatedProductionTime$=this.setupCalculatedProductionTime(this.selectedOrder.asObservable()),this.calculatedTransportTime$=this.setupCalculatedTransportTime(this.selectedOrder.asObservable())}setSelectedOrder(e){this.selectedOrder.next(e)}setupStartTime(e){return e.pipe((0,$.h)(o=>!!o),(0,m.U)(o=>null==o?void 0:o.startedAt),(0,D.O)(void 0))}setupEndTime(e){return e.pipe((0,$.h)(o=>!!o),(0,m.U)(o=>null==o?void 0:o.stoppedAt),(0,D.O)(void 0))}setupDuration(e,o){return(0,et.a)([e,o]).pipe((0,m.U)(([i,a])=>{if(i&&a)return a.getTime()-i.getTime()}),(0,D.O)(void 0))}aggregateStepDuration(e){return(0,Pe.z)((0,$.h)(o=>!!o),(0,m.U)(o=>{var i;return null!==(i=null==o?void 0:o.productionSteps)&&void 0!==i?i:[]}),(0,m.U)(o=>o.filter(i=>i.type===e)),(0,m.U)(o=>o.reduce((i,a)=>a.startedAt&&a.stoppedAt?i+(a.stoppedAt.getTime()-a.startedAt.getTime()):i,0)),(0,m.U)(o=>o>0?o:void 0))}setupCalculatedProductionTime(e){return e.pipe(this.aggregateStepDuration("MANUFACTURE"))}setupCalculatedTransportTime(e){return e.pipe(this.aggregateStepDuration("NAVIGATION"))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),xr=(()=>{class n{transform(e,o){var i;return null!==(i=null!=e?e:o)&&void 0!==i?i:void 0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"fallback",type:n,pure:!0}),n})(),Or=(()=>{class n{constructor(){this.numberFormatter=new Intl.NumberFormat(void 0,{maximumFractionDigits:2})}transform(e){return Number.isSafeInteger(e)?`${this.numberFormatter.format(e/1e3)}s`:e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"toSeconds",type:n,pure:!0}),n})(),yr=(()=>{class n{constructor(e){this.state=e}set order(e){this.state.setSelectedOrder(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36($e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-production-time-calculator"]],inputs:{order:"order"},features:[t._Bn([$e])],decls:35,vars:67,template:function(e,o){1&e&&(t.TgZ(0,"h2"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.ALo(4,"fallback"),t.ALo(5,"date"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"h2"),t._uU(8),t.ALo(9,"translate"),t.ALo(10,"translate"),t.ALo(11,"fallback"),t.ALo(12,"date"),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"h2"),t._uU(15),t.ALo(16,"translate"),t.ALo(17,"translate"),t.ALo(18,"fallback"),t.ALo(19,"toSeconds"),t.ALo(20,"async"),t.qZA(),t.TgZ(21,"h2"),t._uU(22),t.ALo(23,"translate"),t.ALo(24,"translate"),t.ALo(25,"fallback"),t.ALo(26,"toSeconds"),t.ALo(27,"async"),t.qZA(),t.TgZ(28,"h2"),t._uU(29),t.ALo(30,"translate"),t.ALo(31,"translate"),t.ALo(32,"fallback"),t.ALo(33,"toSeconds"),t.ALo(34,"async"),t.qZA()),2&e&&(t.xp6(1),t.AsE(" ",t.lcZ(2,10,"Start"),":\xa0 ",t.lcZ(3,12,t.xi3(4,14,t.xi3(5,17,t.lcZ(6,20,o.state.startTime$),"medium"),"Unbekannt")),"\n"),t.xp6(7),t.AsE(" ",t.lcZ(9,22,"Ende"),":\xa0 ",t.lcZ(10,24,t.xi3(11,26,t.xi3(12,29,t.lcZ(13,32,o.state.endTime$),"medium"),"Unbekannt")),"\n"),t.xp6(7),t.AsE(" ",t.lcZ(16,34,"Gesamtdauer"),":\xa0 ",t.lcZ(17,36,t.xi3(18,38,t.lcZ(19,41,t.lcZ(20,43,o.state.duration$)),"Unbekannt")),"\n"),t.xp6(7),t.AsE(" ",t.lcZ(23,45,"Produktionsdauer"),":\xa0 ",t.lcZ(24,47,t.xi3(25,49,t.lcZ(26,52,t.lcZ(27,54,o.state.calculatedProductionTime$)),"Unbekannt")),"\n"),t.xp6(7),t.AsE(" ",t.lcZ(30,56,"Transportdauer"),":\xa0 ",t.lcZ(31,58,t.xi3(32,60,t.lcZ(33,63,t.lcZ(34,65,o.state.calculatedTransportTime$)),"Unbekannt")),"\n"))},pipes:[A.X$,xr,_.uU,_.Ov,Or],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column}"],changeDetection:0}),n})();function br(n,r){1&n&&(t.TgZ(0,"div",11),t._UZ(1,"mat-spinner"),t.TgZ(2,"h1"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"Planspiel wird gestartet")))}function Sr(n,r){1&n&&(t.TgZ(0,"mat-hint",16),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Bitte geben Sie einen Namen ein.")," "))}function vr(n,r){1&n&&(t.TgZ(0,"mat-hint",16),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Ein Planspiel mit diesem Namen existiert bereits.")," "))}function Zr(n,r){if(1&n&&(t.TgZ(0,"mat-option",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e.type),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.name)," ")}}function Fr(n,r){1&n&&(t.TgZ(0,"mat-hint",16),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Dieses Werkst\xfcck ist nicht auf Lager.")," "))}const Lr=function(n){return{"not-in-stock":n}};function Mr(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",17)(1,"mat-form-field",18)(2,"mat-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-select",19),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.type=i})("ngModelChange",function(){return t.CHM(e),t.oxw(2).updateProducability()}),t.YNc(6,Zr,3,4,"mat-option",20),t.qZA(),t.YNc(7,Fr,3,3,"mat-hint",14),t.qZA(),t.TgZ(8,"button",21),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).removeWorkpiece(a)}),t.TgZ(9,"mat-icon"),t._uU(10,"do_not_disturb_on"),t.qZA()()()}if(2&n){const e=r.$implicit,o=t.oxw(2);t.Q6J("ngClass",t.VKq(7,Lr,!e.inStock)),t.xp6(3),t.Oqu(t.lcZ(4,5,"Werkst\xfccktyp")),t.xp6(2),t.Q6J("ngModel",e.type),t.xp6(1),t.Q6J("ngForOf",o.wsTypes),t.xp6(1),t.Q6J("ngIf",!e.inStock)}}function Pr(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().startSimulation()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"input",13),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().simulation.name=i})("ngModelChange",function(){return t.CHM(e),t.oxw().checkSimulationName()}),t.qZA(),t.YNc(10,Sr,3,3,"mat-hint",14),t.YNc(11,vr,3,3,"mat-hint",14),t.qZA(),t.TgZ(12,"h2"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.YNc(15,Mr,11,9,"div",15),t.TgZ(16,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().addWorkpiece()}),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",!e.canStartSimulation),t.xp6(1),t.hij(" ",t.lcZ(3,9,"Planspiel starten")," "),t.xp6(5),t.Oqu(t.lcZ(8,11,"Name des Planspiels")),t.xp6(2),t.Q6J("ngModel",e.simulation.name),t.xp6(1),t.Q6J("ngIf",!e.simulation.name),t.xp6(1),t.Q6J("ngIf",e.simulationNameAlreadyExists),t.xp6(2),t.Oqu(t.lcZ(14,13,"Produktionsplanung")),t.xp6(2),t.Q6J("ngForOf",e.simulation.workpieces),t.xp6(2),t.hij(" ",t.lcZ(18,15,"Werkst\xfcck hinzuf\xfcgen")," ")}}function wr(n,r){1&n&&(t.TgZ(0,"ff-banner")(1,"h1",23),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"Planspiel l\xe4uft")))}function Ir(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ff-order-list",24),t.NdJ("orderSelect",function(i){return t.CHM(e),t.oxw(2).state.setSelectedOrder(i)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("multiple",!0)("withCompleted",!0)("canRemove",!1)("simulationId",e)("selectedOrder",o.state.selectedOrder.value)}}const Je=function(n){return{active:n}};function Er(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",5)(1,"div",6),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().toggleSelectSimulation(a)}),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"percent"),t.qZA(),t.TgZ(5,"mat-icon"),t._uU(6),t.qZA()(),t.YNc(7,Ir,2,5,"ng-container",2),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(7,Je,o.selectedSimulationId===e)),t.xp6(2),t.AsE("",e," (OEE: ",t.lcZ(4,5,o.oee(e)),")"),t.xp6(3),t.hij(" ",o.selectedSimulationId===e?"keyboard_arrow_up":"keyboard_arrow_down"," "),t.xp6(1),t.Q6J("ngIf",o.selectedSimulationId===e)}}function Ur(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ff-order-list",24),t.NdJ("orderSelect",function(i){return t.CHM(e),t.oxw().state.setSelectedOrder(i)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("multiple",!0)("withCompleted",!0)("canRemove",!1)("simulationId",null)("selectedOrder",e.state.selectedOrder.value)}}const Rr=function(n){return{simulationId:n}};function Nr(n,r){if(1&n&&(t.TgZ(0,"div",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(t.xi3(2,1,"Ergebnisse von '{{simulationId}}'",t.VKq(4,Rr,e.selectedSimulationId)))}}function Dr(n,r){1&n&&(t.TgZ(0,"div",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Ergebnisse von Auftr\xe4gen ohne Planspiel")))}function kr(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Bitte beachten Sie, dass die OEE-Berechnung erst nach Abschluss der Produktion einen sinnvollen Wert liefert.")," "))}function qr(n,r){if(1&n&&(t.TgZ(0,"div")(1,"span",31)(2,"h1"),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"mat-icon",32),t.ALo(7,"translate"),t.ALo(8,"translate"),t._uU(9),t.ALo(10,"toIcon"),t.qZA()(),t._UZ(11,"ff-production-time-calculator",33),t.qZA()),2&n){const e=r.ngIf,o=t.oxw(2);t.xp6(3),t.HOy(" ",t.lcZ(4,8,"Gew\xe4hlter Produktionsauftrag"),":\xa0 ",e.orderId," (",e.type,"; ",t.xi3(5,10,e.receivedAt,"medium"),") "),t.xp6(3),t.Q6J("title",t.lcZ(8,15,"Status."+e.state)),t.uIk("aria-label",t.lcZ(7,13,"Status."+e.state)),t.xp6(3),t.hij(" ",t.xi3(10,17,e.state,o.stateIcons)," "),t.xp6(2),t.Q6J("order",e)}}function $r(n,r){if(1&n&&(t.TgZ(0,"mat-expansion-panel",34)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t._UZ(5,"ff-production-steps",33),t.qZA()),2&n){const e=r.ngIf;t.xp6(3),t.hij(" ",t.lcZ(4,2,"Produktions- und Navigationsschritte")," "),t.xp6(2),t.Q6J("order",e)}}function Jr(n,r){1&n&&(t.TgZ(0,"ff-banner")(1,"h1",23),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"Kein Produktionsauftrag ausgew\xe4hlt")))}function Qr(n,r){if(1&n&&(t.TgZ(0,"div",25),t.YNc(1,Nr,3,6,"div",26),t.YNc(2,Dr,3,3,"div",26),t.TgZ(3,"div",27),t.YNc(4,kr,3,3,"div",2),t.ALo(5,"async"),t.TgZ(6,"div",28)(7,"mat-card")(8,"mat-card-title"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"mat-card-content")(12,"h1"),t._uU(13),t.ALo(14,"percent"),t.qZA()()(),t.TgZ(15,"mat-card")(16,"mat-card-title"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"mat-card-content")(20,"h1"),t._uU(21),t.ALo(22,"percent"),t.qZA()()(),t.TgZ(23,"mat-card")(24,"mat-card-title"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"mat-card-content")(28,"h1"),t._uU(29),t.ALo(30,"percent"),t.qZA()()(),t.TgZ(31,"mat-card")(32,"mat-card-title"),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"mat-card-content")(36,"h1"),t._uU(37),t.ALo(38,"percent"),t.qZA()()()(),t._UZ(39,"hr"),t.YNc(40,qr,12,20,"div",2),t.YNc(41,$r,6,4,"mat-expansion-panel",29),t.YNc(42,Jr,4,3,"ff-banner",2),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.selectedSimulationId),t.xp6(1),t.Q6J("ngIf",null===e.selectedSimulationId),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,14,e.runningSimulationId$)===e.selectedSimulationId),t.xp6(5),t.Oqu(t.lcZ(10,16,"OEE")),t.xp6(4),t.Oqu(t.lcZ(14,18,e.oee(e.selectedSimulationId))),t.xp6(4),t.Oqu(t.lcZ(18,20,"Qualit\xe4t")),t.xp6(4),t.Oqu(t.lcZ(22,22,e.quality(e.selectedSimulationId))),t.xp6(4),t.Oqu(t.lcZ(26,24,"Leistung")),t.xp6(4),t.Oqu(t.lcZ(30,26,e.performance(e.selectedSimulationId))),t.xp6(4),t.Oqu(t.lcZ(34,28,"Verf\xfcgbarkeit")),t.xp6(4),t.Oqu(t.lcZ(38,30,e.availability(e.selectedSimulationId))),t.xp6(3),t.Q6J("ngIf",e.state.selectedOrder.value),t.xp6(1),t.Q6J("ngIf",e.state.selectedOrder.value),t.xp6(1),t.Q6J("ngIf",!e.state.selectedOrder.value)}}let Yr=(()=>{class n{constructor(e,o,i,a,s,l,d){this.state=e,this.orderStatesService=o,this.mqttService=i,this.notification=a,this.translate=s,this.stockStatesService=d,this.onDestroy$=new J.t(1),this.stateIcons={[v.ENQUEUED]:"hourglass_empty",[v.IN_PROGRESS]:"play_circle",[v.FINISHED]:"check_circle",[v.ERROR]:"error",[v.CANCELLED]:"hourglass_disabled"},this.startingSimulation=!1,this.simulationNameAlreadyExists=!1,this.allSimulationIds=[],this.allOrders=[],this.simulation={name:"Test Simulation",workpieces:[{type:k.RED,inStock:!1},{type:k.WHITE,inStock:!1},{type:k.BLUE,inStock:!1}]},this.wsTypes=Le,this.runningSimulationId$=this.orderStatesService.activeOrders$.pipe((0,m.U)(c=>{const u=Array.from(new Set(c.filter(g=>"PRODUCTION"===g.orderType&&g.simulationId&&g.simulationId.length>0).map(g=>g.simulationId)));if(u.length>0)return u[0]})),this.simulationIsRunning$=this.runningSimulationId$.pipe((0,m.U)(c=>!!c)),d.stock$.pipe((0,Dt.b)(c=>this.updateProducability(c)),(0,F.R)(this.onDestroy$)).subscribe(),(0,et.a)([this.orderStatesService.activeOrders$,this.orderStatesService.completedOrders$]).pipe((0,m.U)(([c,u])=>[...c,...u]),(0,m.U)(c=>c.filter(u=>"PRODUCTION"===u.orderType)),(0,Dt.b)(c=>{this.allOrders=c,this.allSimulationIds=Array.from(new Set(c.map(u=>u.simulationId).filter(u=>(null==u?void 0:u.length)>0))),this.checkSimulationName(),!this.selectedSimulationId&&this.allSimulationIds[0]&&(this.selectedSimulationId=this.allSimulationIds[0])}),(0,F.R)(this.onDestroy$)).subscribe(),l.config$.pipe((0,Dt.b)(c=>this.config=c),(0,F.R)(this.onDestroy$)).subscribe()}get canStartSimulation(){var e;return this.simulation.workpieces.length&&this.simulation.workpieces.every(o=>o.inStock)&&!this.simulationNameAlreadyExists&&(null===(e=this.simulation.name)||void 0===e?void 0:e.length)>0}ngOnInit(){this.checkSimulationName()}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}startSimulation(){var e=this;return(0,nt.Z)(function*(){e.startingSimulation=!0;const o=e.simulation.name.trim(),i=e.simulation.workpieces.map((a,s)=>function Xe(n,r,e){return{type:n,timestamp:null!=e?e:new Date,orderType:"PRODUCTION",simulationId:r}}(a.type,o,new Date(Date.now()+25*s)));for(const a of i)try{yield new Promise((s,l)=>{e.mqttService.subscribe(y.ORDER_RESPONSE).pipe(Y(),(0,$.h)(d=>d.simulationId===o),(0,st.q)(1),(0,F.R)(e.onDestroy$),(0,fr.V)(3e4)).subscribe({next:()=>s(!0),error:d=>l(d)}),e.mqttService.publish(y.ORDER_REQUEST,a,{qos:2})})}catch(s){return e.notification.open(e.translate.instant("Beim Starten des Planspiels ist ein Fehler aufgetreten."),e.translate.instant("OK"),{duration:1e4,panelClass:"error-snackbar"}),void(e.startingSimulation=!1)}e.notification.open(e.translate.instant("Das Planspiel wurde erfolgreich gestartet."),e.translate.instant("OK"),{duration:1e4,panelClass:"success-snackbar"}),e.startingSimulation=!1})()}removeWorkpiece(e){this.simulation.workpieces=this.simulation.workpieces.filter(o=>o!==e)}addWorkpiece(){this.simulation.workpieces.push({type:k.WHITE,inStock:!1}),this.updateProducability()}updateProducability(e){var o=this;return(0,nt.Z)(function*(){if(e||(e=yield(0,bt.z)(o.stockStatesService.stock$)),e){const i=[];o.simulation.workpieces.forEach(a=>{var s;const l=e.stockItems.find(d=>{var c,u,g;return"RESERVED"!==(null===(c=d.workpiece)||void 0===c?void 0:c.state)&&(null===(u=d.workpiece)||void 0===u?void 0:u.type)===a.type&&-1===i.indexOf(null===(g=d.workpiece)||void 0===g?void 0:g.id)});l?(a.inStock=!0,i.push(null===(s=l.workpiece)||void 0===s?void 0:s.id)):a.inStock=!1})}else o.simulation.workpieces.forEach(i=>{i.inStock=!1})})()}checkSimulationName(){const e=this.simulation.name.trim();this.simulationNameAlreadyExists=0!==e.length&&this.allSimulationIds.some(o=>o===e)}toggleSelectSimulation(e){this.selectedSimulationId=this.selectedSimulationId===e?void 0:e,this.state.setSelectedOrder(void 0)}oee(e){return this.config?Ne(this.allOrders.filter(i=>i.simulationId==e),this.config):0}availability(e){return ce(this.allOrders.filter(i=>i.simulationId==e))}availabilityForOrder(e){return ue(e)}quality(e){return ae(this.allOrders.filter(i=>i.simulationId==e))}qualityForOrder(e){return se(e)}performance(e){return this.config?le(this.allOrders.filter(i=>i.simulationId==e),this.config):0}downloadCsv(){this.downloadCsvOee(),this.downloadRawDataCsv()}downloadCsvOee(){const e="data:text/csv;charset=utf-8,"+["Simulation","OrderId","OEE","Availability","Quality","Performance","Number of Orders","Duration (seconds)","Waiting Time (seconds)","Producton Time (seconds)","Start","End","Received At"].join(",")+"\n"+[...this.allSimulationIds,null].map(a=>{const s=this.allOrders.filter(u=>u.simulationId==a&&"PRODUCTION"===u.orderType),l=(null==a?void 0:a.includes(","))?`'${a}'`:null!=a?a:"without simulation";return[[l,"Planspielzusammenfassung",Ne(s,this.config),ce(s),ae(s),le(s,this.config),s.length,s.reduce((u,g)=>u+kt(g,this.config),0),s.reduce((u,g)=>u+qt(g),0),s.reduce((u,g)=>u+$t(g),0),s.reduce((u,g)=>g.startedAt&&(!u||g.startedAt.getTime()<u.getTime())?g.startedAt:u,new Date),s.reduce((u,g)=>g.stoppedAt&&(!u||g.stoppedAt.getTime()>u.getTime())?g.stoppedAt:u,new Date)].join(","),...s.map(u=>[l,u.orderId,gr(u,this.config),ue(u),se(u),De(u,this.config),1,kt(u,this.config),qt(u),$t(u),u.startedAt,u.stoppedAt,u.receivedAt].join(","))].join("\n")}).join("\n"),o=encodeURI(e),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download","oee.csv"),document.body.appendChild(i),i.click()}downloadRawDataCsv(){const e="data:text/csv;charset=utf-8,"+["Simulation","OrderId","WorkpieceType","WorkpieceId","StepId","Type","State","StartedAt","StoppedAt","ReceivedAt","ModuleType","Command","PreviousStepId"].join(",")+"\n"+[...this.allSimulationIds,null].map(a=>{const s=this.allOrders.filter(c=>c.simulationId==a&&"PRODUCTION"===c.orderType),l=(null==a?void 0:a.includes(","))?`'${a}'`:null!=a?a:"without simulation";return s.map(c=>[[l,c.orderId,c.type,c.workpieceId,"","PRODUCTION",c.state,c.startedAt,c.stoppedAt,c.receivedAt,"","",""].join(","),c.productionSteps.map(b=>[l,c.orderId,c.type,c.workpieceId,b.id,b.type,b.state,b.startedAt,b.stoppedAt,"","MANUFACTURE"===b.type?b.moduleType:b.target,"MANUFACTURE"===b.type?b.command:"DRIVE",b.dependentActionId].join(",")).join("\n")].join("\n")).join("\n")}).join("\n"),o=encodeURI(e),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download","raw-data.csv"),document.body.appendChild(i),i.click()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(qe),t.Y36(ct),t.Y36(I),t.Y36(Ct.ux),t.Y36(A.sK),t.Y36(Me),t.Y36(Cr))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t._Bn([qe])],decls:25,vars:23,consts:[[1,"planning"],["class","simulation-is-starting",4,"ngIf"],[4,"ngIf"],[1,"order-list"],["class","simulation-entry",4,"ngFor","ngForOf"],[1,"simulation-entry"],[1,"header",3,"ngClass","click"],["mat-raised-button","","color","primary",3,"click"],[1,"vertical-divider"],[1,"results"],["class","mat-elevation-z4",4,"ngIf"],[1,"simulation-is-starting"],["mat-raised-button","","color","primary",3,"disabled","click"],["matInput","",3,"ngModel","ngModelChange"],["class","error",4,"ngIf"],["class","order-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"error"],[1,"order-item",3,"ngClass"],[2,"flex","1"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"],[3,"value"],[2,"margin","0"],[3,"multiple","withCompleted","canRemove","simulationId","selectedOrder","orderSelect"],[1,"mat-elevation-z4"],["class","header",4,"ngIf"],[2,"padding","1rem"],[1,"oee-card-container"],["class","simulation__steps",4,"ngIf"],[1,"header"],[2,"display","inline-flex"],[2,"height","36px","width","36px","margin-top","-2px","font-size","36px",3,"title"],[3,"order"],[1,"simulation__steps"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"section",0),t.YNc(2,br,5,3,"div",1),t.YNc(3,Pr,19,17,"ng-container",2),t.ALo(4,"async"),t.YNc(5,wr,4,3,"ff-banner",2),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"section",3),t.YNc(8,Er,8,9,"div",4),t.TgZ(9,"div",5)(10,"div",6),t.NdJ("click",function(){return o.toggleSelectSimulation(null)}),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.ALo(14,"percent"),t.qZA(),t.TgZ(15,"mat-icon"),t._uU(16),t.qZA()(),t.YNc(17,Ur,2,5,"ng-container",2),t.qZA(),t._UZ(18,"hr"),t.TgZ(19,"button",7),t.NdJ("click",function(){return o.downloadCsv()}),t._uU(20),t.ALo(21,"translate"),t.qZA()()(),t._UZ(22,"div",8),t.TgZ(23,"section",9),t.YNc(24,Qr,43,32,"div",10),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.startingSimulation),t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(4,11,o.simulationIsRunning$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,13,o.simulationIsRunning$)),t.xp6(3),t.Q6J("ngForOf",o.allSimulationIds),t.xp6(2),t.Q6J("ngClass",t.VKq(21,Je,null===o.selectedSimulationId)),t.xp6(2),t.AsE("",t.lcZ(13,15,"Auftr\xe4ge ohne Planspiel")," (OEE: ",t.lcZ(14,17,o.oee(null)),")"),t.xp6(4),t.hij(" ",null===o.selectedSimulationId?"keyboard_arrow_up":"keyboard_arrow_down"," "),t.xp6(1),t.Q6J("ngIf",null===o.selectedSimulationId),t.xp6(3),t.hij(" ",t.lcZ(21,19,"CSV herunterladen")," "),t.xp6(4),t.Q6J("ngIf",void 0!==o.selectedSimulationId))},directives:[_.O5,zt.Ou,E.lW,N.KE,N.hX,rt.Nt,L.Fj,L.JJ,L.On,N.bx,_.sg,_.mk,gt.gD,re.ey,U.Hw,Ar,Ee,S.a8,S.n5,S.dn,yr,mt.ib,mt.yz,mt.yK,Ue],pipes:[A.X$,_.Ov,_.Zx,_.uU,Nt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;height:100%;padding:1rem;font-size:1.2rem}mat-hint.error[_ngcontent-%COMP%]{color:var(--warn-color)}section[_ngcontent-%COMP%]{padding:1rem}.vertical-divider[_ngcontent-%COMP%]{border-left:1px solid #ccc;margin:0 1rem}.planning[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;overflow-y:auto;position:relative;min-width:30rem}.planning[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.planning[_ngcontent-%COMP%]   .order-item.not-in-stock[_ngcontent-%COMP%]{margin-bottom:.5rem}.planning[_ngcontent-%COMP%]   .simulation-is-starting[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#fffc;z-index:1000}.order-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:1rem;overflow-y:auto}.order-list[_ngcontent-%COMP%]   .simulation-entry[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{cursor:pointer}.order-list[_ngcontent-%COMP%]   .simulation-entry[_ngcontent-%COMP%]   .header.active[_ngcontent-%COMP%]{background-color:#ccc}.header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;height:3rem;border-bottom:1px solid #ccc;padding:0 1rem}.results[_ngcontent-%COMP%]{flex:1}.results[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:#ccc}.results[_ngcontent-%COMP%]   .oee-card-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.results[_ngcontent-%COMP%]   .oee-card-container[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{flex:1;margin:0 .5rem}.results[_ngcontent-%COMP%]   .oee-card-container[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]:first-child{margin-left:0}.results[_ngcontent-%COMP%]   .oee-card-container[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]:last-child{margin-right:0}.steps[_ngcontent-%COMP%]{margin:1rem 2rem 0}"]}),n})();var ot=p(1631);class Hr extends C.by{constructor(r){super(),this.stateLog$=r,this.connectionCount=0}connect(){return this.collection$||(this.collection$=this.stateLog$.subscribe(r=>this.data=r)),this.connectionCount++,super.connect()}disconnect(){this.connectionCount&&(this.connectionCount--,0===this.connectionCount&&this.collection$&&(this.collection$.unsubscribe(),this.collection$=void 0)),super.disconnect()}}function Br(n,r){1&n&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Keine Modulinformationen verf\xfcgbar")," "))}function Gr(n,r){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw().ngIf;let o;t.xp6(1),t.AsE(" ",t.lcZ(2,2,"Produktionsschritt."+(null!==(o=e.subType)&&void 0!==o?o:e.type))," (",e.serialNumber,") ")}}function Wr(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Br,3,3,"p",0),t.YNc(2,Gr,3,4,"p",0),t.BQk()),2&n){const e=r.ngIf;t.xp6(1),t.Q6J("ngIf",!e),t.xp6(1),t.Q6J("ngIf",e)}}let Vr=(()=>{class n{constructor(e){this.stateService=e,this.stateLog=null,this.pairingState$=this.stateService.pairingState$,this.pairedModule$=this.setupPairedModule(this.pairingState$),this.pairedFts$=this.setupPairedFts(this.pairingState$),this.moduleInfo$=this.setupModuleInfo(this.pairedModule$,this.pairedFts$)}setupPairedModule(e){return e.pipe((0,m.U)(o=>o.modules),(0,m.U)(o=>{var i,a;const s=null===(a=null===(i=this.stateLog)||void 0===i?void 0:i.state)||void 0===a?void 0:a.serialNumber;return o.find(l=>l.serialNumber===s)}),(0,st.q)(1),(0,T.d)(1))}setupPairedFts(e){return e.pipe((0,m.U)(o=>o.transports),(0,m.U)(o=>{var i,a;const s=null===(a=null===(i=this.stateLog)||void 0===i?void 0:i.state)||void 0===a?void 0:a.serialNumber;return o.find(l=>l.serialNumber===s)}),(0,st.q)(1),(0,T.d)(1))}setupModuleInfo(e,o){return(0,et.a)([e,o]).pipe((0,m.U)(([i,a])=>null!=i?i:a),(0,$.h)(i=>!!i),(0,m.U)(i=>({serialNumber:i.serialNumber,type:i.type,subType:i.subType})),(0,D.O)(void 0),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-module-info"]],inputs:{stateLog:"stateLog"},decls:2,vars:3,consts:[[4,"ngIf"]],template:function(e,o){1&e&&(t.YNc(0,Wr,3,2,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.moduleInfo$))},directives:[_.O5],pipes:[_.Ov,A.X$],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}p[_ngcontent-%COMP%]{margin:0;padding:0}"]}),n})();function jr(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Fehlerzeitpunkt")," "))}function zr(n,r){if(1&n&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.timestamp,"medium")," ")}}function Kr(n,r){if(1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e)," ")}}function Xr(n,r){if(1&n&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e[o])," ")}}function ta(n,r){1&n&&(t.ynx(0,19),t.YNc(1,Kr,3,3,"th",10),t.YNc(2,Xr,3,3,"td",11),t.BQk()),2&n&&t.Q6J("matColumnDef",r.$implicit)}function ea(n,r){1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"errorReferences")," "))}function na(n,r){1&n&&(t.ynx(0),t.TgZ(1,"p",22),t._uU(2,"N/A"),t.qZA(),t.BQk())}function oa(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"p",22),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.AsE("",t.lcZ(3,2,e.referenceKey)," - ",t.lcZ(4,4,e.referenceValue),"")}}function ia(n,r){if(1&n&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.AsE("",e.key," - ",e.value,"")}}function ra(n,r){if(1&n&&(t.ynx(0),t.YNc(1,ia,2,2,"p",23),t.ALo(2,"keyvalue"),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,e))}}function aa(n,r){if(1&n&&(t.ynx(0),t.YNc(1,oa,5,6,"ng-container",20),t.YNc(2,ra,3,3,"ng-container",20),t.BQk()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",e.referenceKey&&e.referenceValue),t.xp6(1),t.Q6J("ngIf",!e.referenceKey||!e.referenceValue)}}function sa(n,r){if(1&n&&(t.TgZ(0,"td",18),t.YNc(1,na,3,0,"ng-container",20),t.YNc(2,aa,3,2,"ng-container",21),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",!e.errorReferences),t.xp6(1),t.Q6J("ngForOf",e.errorReferences)}}function la(n,r){1&n&&t._UZ(0,"tr",24)}function ca(n,r){if(1&n&&(t.TgZ(0,"tr",25)(1,"td",26),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(1),t.uIk("colspan",e.errorColumns.length),t.xp6(1),t.hij(" ",t.lcZ(3,2,"Keine Daten verf\xfcgbar")," ")}}function ua(n,r){1&n&&t._UZ(0,"tr",27)}function da(n,r){if(1&n&&(t.TgZ(0,"table",8),t.ynx(1,9),t.YNc(2,jr,3,3,"th",10),t.YNc(3,zr,3,4,"td",11),t.BQk(),t.YNc(4,ta,3,1,"ng-container",12),t.ynx(5,13),t.YNc(6,ea,3,3,"th",10),t.YNc(7,sa,3,2,"td",11),t.BQk(),t.YNc(8,la,1,0,"tr",14),t.YNc(9,ca,4,4,"tr",15),t.YNc(10,ua,1,0,"tr",16),t.qZA()),2&n){const e=t.oxw().errors,o=t.oxw();t.Q6J("dataSource",o.filterEmptyErrors(e)),t.xp6(4),t.Q6J("ngForOf",o.displayColumns),t.xp6(4),t.Q6J("matHeaderRowDef",o.errorColumns),t.xp6(2),t.Q6J("matRowDefColumns",o.errorColumns)}}function pa(n,r){if(1&n&&t.YNc(0,da,11,4,"table",7),2&n){const e=r.errors,o=t.oxw();t.Q6J("ngIf",o.hasErrors(e))}}const _a=function(n,r){return{ip:n,version:r}};function ma(n,r){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"translate"),t.qZA()),2&n){const e=r.moduleInfo;let o;t.xp6(1),t.AsE("",t.lcZ(2,3,e.connected?"Verbunden":"Nicht verbunden")," - ",t.lcZ(3,5,"AvailableState."+e.available),""),t.xp6(4),t.Oqu(t.xi3(6,7,"IP: {{ip}} - Version: {{version}}",t.WLB(10,_a,null!==(o=e.ip)&&void 0!==o?o:"N/A",null!==(o=e.version)&&void 0!==o?o:"N/A")))}}function fa(n,r){1&n&&t.GkF(0)}const ga=function(n){return{timestamp:n}},de=function(n){return{moduleInfo:n}};function ha(n,r){if(1&n&&(t.TgZ(0,"section")(1,"h3"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.YNc(8,fa,1,0,"ng-container",28),t.qZA()),2&n){const e=r.ngIf,o=t.oxw().state;t.oxw();const i=t.MAs(3);let a;t.xp6(2),t.Oqu(t.xi3(3,5,"Verbindungsstatus vom {{timestamp}}",t.VKq(13,ga,t.xi3(4,8,null==o?null:o.timestamp,"medium")))),t.xp6(4),t.AsE("",t.lcZ(7,11,"Produktionsschritt."+(null!==(a=e.subType)&&void 0!==a?a:e.type))," - ",e.serialNumber,""),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(15,de,e))}}function Ca(n,r){if(1&n&&(t.YNc(0,ha,9,17,"section",20),t.ALo(1,"async")),2&n){const e=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,e.moduleInfo$))}}function Ta(n,r){1&n&&t.GkF(0)}const Qe=function(n,r){return{serialNumber:n,timestamp:r}},Aa=function(n){return{lastNodeId:n}},xa=function(n){return{percentage:n}};function Oa(n,r){if(1&n&&(t.TgZ(0,"section")(1,"h3"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"date"),t.qZA(),t.YNc(5,Ta,1,0,"ng-container",28),t.TgZ(6,"p"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"p"),t._uU(10),t.ALo(11,"translate"),t.qZA()()),2&n){const e=r.ngIf,o=t.oxw().state;t.oxw();const i=t.MAs(3);t.xp6(2),t.Oqu(t.xi3(3,5,"Status f\xfcr FTS [{{serialNumber}}] vom {{timestamp}}",t.WLB(17,Qe,e.serialNumber,t.xi3(4,8,null==o?null:o.timestamp,"medium")))),t.xp6(3),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(20,de,e)),t.xp6(2),t.Oqu(t.xi3(8,11,"Letzter Knoten / letztes Module {{lastNodeId}}",t.VKq(22,Aa,e.lastNodeId))),t.xp6(3),t.Oqu(t.xi3(11,14,"Batteriestand {{percentage}}%",t.VKq(24,xa,null==o||null==o.batteryState?null:o.batteryState.percentage)))}}function ya(n,r){1&n&&t.GkF(0)}const Ye=function(n){return{errors:n}};function ba(n,r){if(1&n&&(t.YNc(0,Oa,12,26,"section",20),t.ALo(1,"async"),t.YNc(2,ya,1,0,"ng-container",28)),2&n){const e=r.state,o=t.oxw(),i=t.MAs(1);t.Q6J("ngIf",t.lcZ(1,3,o.ftsInfo$)),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(5,Ye,e.errors))}}function Sa(n,r){1&n&&t.GkF(0)}function va(n,r){if(1&n&&(t.TgZ(0,"section")(1,"h3"),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"date"),t.qZA(),t.YNc(5,Sa,1,0,"ng-container",28),t.qZA()),2&n){const e=r.ngIf,o=t.oxw().state;t.oxw();const i=t.MAs(3);t.xp6(2),t.Oqu(t.xi3(3,3,"Status f\xfcr Module [{{serialNumber}}] vom {{timestamp}}",t.WLB(9,Qe,e.serialNumber,t.xi3(4,6,null==o?null:o.timestamp,"medium")))),t.xp6(3),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(12,de,e))}}function Za(n,r){1&n&&t.GkF(0)}function Fa(n,r){if(1&n&&(t.YNc(0,va,6,14,"section",20),t.ALo(1,"async"),t.YNc(2,Za,1,0,"ng-container",28)),2&n){const e=r.state,o=t.oxw(),i=t.MAs(1);t.Q6J("ngIf",t.lcZ(1,3,o.moduleInfo$)),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(5,Ye,e.errors))}}function La(n,r){1&n&&t.GkF(0)}const pe=function(n){return{state:n}};function Ma(n,r){if(1&n&&(t.ynx(0),t.YNc(1,La,1,0,"ng-container",28),t.BQk()),2&n){const e=t.oxw(),o=t.MAs(5);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,pe,null==e.stateLog?null:e.stateLog.state))}}function Pa(n,r){1&n&&t.GkF(0)}function wa(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Pa,1,0,"ng-container",28),t.BQk()),2&n){const e=t.oxw(),o=t.MAs(7);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,pe,null==e.stateLog?null:e.stateLog.state))}}function Ia(n,r){1&n&&t.GkF(0)}function Ea(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Ia,1,0,"ng-container",28),t.BQk()),2&n){const e=t.oxw(),o=t.MAs(9);t.xp6(1),t.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",t.VKq(2,pe,null==e.stateLog?null:e.stateLog.state))}}let Ua=(()=>{class n{constructor(e){this.stateService=e,this.displayColumns=["errorType","errorLevel"],this.errorColumns=["timestamp",...this.displayColumns,"errorReferences"],this.StateLogType=Et,this.stateLog=null,this.pairingState$=this.stateService.pairingState$,this.moduleInfo$=this.setupModuleInfo(this.pairingState$),this.ftsInfo$=this.setupFtsInfo(this.pairingState$)}hasErrors(e){const o=null!=e?e:[];return o.length>0&&o.some(i=>!!i.errorLevel)}filterEmptyErrors(e){return(null!=e?e:[]).filter(i=>!!i.errorLevel)}setupModuleInfo(e){return e.pipe((0,m.U)(o=>[...o.modules,...o.transports]),(0,m.U)(o=>{var i,a;const s=null===(a=null===(i=this.stateLog)||void 0===i?void 0:i.state)||void 0===a?void 0:a.serialNumber;return o.find(l=>l.serialNumber===s)}),(0,st.q)(1),(0,T.d)(1))}setupFtsInfo(e){return e.pipe((0,m.U)(o=>o.transports),(0,m.U)(o=>{var i,a;const s=null===(a=null===(i=this.stateLog)||void 0===i?void 0:i.state)||void 0===a?void 0:a.serialNumber;return o.find(l=>l.serialNumber===s)}),(0,st.q)(1),(0,T.d)(1))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-state-log-details"]],inputs:{stateLog:"stateLog"},decls:14,vars:4,consts:[["errorTable",""],["connectionStrings",""],["connectionState",""],["ftsState",""],["moduleState",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["mat-table","",3,"dataSource",4,"ngIf"],["mat-table","",3,"dataSource"],["matColumnDef","timestamp"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","errorReferences"],["mat-header-row","",4,"matHeaderRowDef"],["class","mat-row",4,"matNoDataRow"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"matColumnDef"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"ref-output"],["class","ref-output",4,"ngFor","ngForOf"],["mat-header-row",""],[1,"mat-row"],[1,"mat-cell"],["mat-row",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,o){1&e&&(t.YNc(0,pa,1,1,"ng-template",null,0,t.W1O),t.YNc(2,ma,7,13,"ng-template",null,1,t.W1O),t.YNc(4,Ca,2,3,"ng-template",null,2,t.W1O),t.YNc(6,ba,3,7,"ng-template",null,3,t.W1O),t.YNc(8,Fa,3,7,"ng-template",null,4,t.W1O),t.ynx(10,5),t.YNc(11,Ma,2,4,"ng-container",6),t.YNc(12,wa,2,4,"ng-container",6),t.YNc(13,Ea,2,4,"ng-container",6),t.BQk()),2&e&&(t.xp6(10),t.Q6J("ngSwitch",null==o.stateLog?null:o.stateLog.type),t.xp6(1),t.Q6J("ngSwitchCase",o.StateLogType.CONNECTION),t.xp6(1),t.Q6J("ngSwitchCase",o.StateLogType.FTS),t.xp6(1),t.Q6J("ngSwitchCase",o.StateLogType.MODULE))},directives:[_.O5,C.BZ,C.w1,C.fO,C.ge,C.Dz,C.ev,_.sg,C.as,C.XQ,C.Ee,C.nj,C.Gk,_.tP,_.RF,_.n9],pipes:[A.X$,_.uU,_.Nd,_.Ov],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}table[_ngcontent-%COMP%]{width:100%}.ref-output[_ngcontent-%COMP%]{margin:0}"]}),n})(),Ra=(()=>{class n{transform(e,o){var i,a,s,l;if("MODULE"===e.type||"FTS"===e.type){if(null===(a=null===(i=e.state)||void 0===i?void 0:i.errors)||void 0===a?void 0:a.find(d=>"FATAL"==d.errorLevel))return"FATAL"===o;if(null===(l=null===(s=e.state)||void 0===s?void 0:s.errors)||void 0===l?void 0:l.find(d=>"WARNING"==d.errorLevel))return"WARNING"===o}else if("CONNECTION"===e.type&&e.state.connectionState===xt.CONNECTIONBROKEN)return"WARNING"===o;return"NONE"===o}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"isErrorLevel",type:n,pure:!0}),n})();function Na(n,r){if(1&n&&(t.TgZ(0,"mat-option",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",null!==e?t.lcZ(2,2,"StateLog."+e):""," ")}}function Da(n,r){if(1&n&&(t.TgZ(0,"mat-option",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;let o;t.Q6J("value",e.serialNumber),t.xp6(1),t.AsE(" ",t.lcZ(2,3,"Produktionsschritt."+(null!==(o=e.subType)&&void 0!==o?o:e.type))," (",e.serialNumber,") ")}}function ka(n,r){1&n&&t._UZ(0,"th",24)}function qa(n,r){if(1&n&&(t.TgZ(0,"td",25)(1,"button",26)(2,"mat-icon"),t._uU(3),t.qZA()()()),2&n){const e=r.$implicit,o=t.oxw();t.xp6(3),t.Oqu(o.selectedState===e?"expand_more":"chevron_right")}}function $a(n,r){1&n&&(t.TgZ(0,"th",27),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"state.received")," "))}function Ja(n,r){if(1&n&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.received,"medium")," ")}}function Qa(n,r){1&n&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"state.type")," "))}function Ya(n,r){if(1&n&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,"StateLog."+e.type)," ")}}function Ha(n,r){1&n&&(t.TgZ(0,"th",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Nachrichtenherkunft")," "))}function Ba(n,r){if(1&n&&(t.TgZ(0,"td",28),t._UZ(1,"ff-module-info",30),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("stateLog",e)}}function Ga(n,r){if(1&n&&(t.TgZ(0,"td",28)(1,"div",31),t._UZ(2,"ff-state-log-details",30),t.qZA()()),2&n){const e=r.$implicit,o=t.oxw();t.uIk("colspan",o.stateColumns.length),t.xp6(1),t.ekj("expanded",o.selectedState===e),t.Q6J("@detailExpand",o.selectedState===e?"expanded":"collapsed"),t.xp6(1),t.Q6J("stateLog",e)}}function Wa(n,r){1&n&&t._UZ(0,"tr",32)}function Va(n,r){if(1&n&&(t.TgZ(0,"tr",33)(1,"td",34),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.stateColumns.length),t.xp6(1),t.hij(" ",t.lcZ(3,2,"Keine Daten verf\xfcgbar")," ")}}function ja(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",35),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().selectState(a)}),t.ALo(1,"isErrorLevel"),t.ALo(2,"isErrorLevel"),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw();t.ekj("selected-state-row",o.selectedState===e)("severity-fatal",t.xi3(1,6,e,"FATAL"))("severity-warning",t.xi3(2,9,e,"WARNING"))}}function za(n,r){1&n&&t._UZ(0,"tr",36)}const Ka=function(){return["stateDetails"]},ts=[{path:"",component:In,children:[{path:wt.DASHBOARD,loadChildren:()=>R.Q5},{path:M.ROOT,redirectTo:M.DASHBOARD,data:{[q]:"."},pathMatch:"full"},{path:M.MODULE,component:Qi,data:{[q]:".."}},{path:M.MODULE+"/:moduleId",component:pi,data:{[q]:"../.."}},{path:`${M.MODULE}/:moduleId/${M.CALIBRATION}`,component:ei,data:{[q]:"../../.."}},{path:M.ORDERS,component:Re,pathMatch:"full",data:{[q]:".."}},{path:M.ORDERS+"/:orderId",component:Re,data:{[q]:"../.."}},{path:M.PRODUCTION_FLOWS,component:eo,data:{[q]:".."}},{path:M.LAYOUT,component:wo,data:{[q]:".."}},{path:M.SIMULATION,component:Yr,data:{[q]:".."}},{path:M.LOGS,component:(()=>{class n{constructor(e){this.statesService=e,this.stateColumns=["actions","received","type","module"],this.logTypes=[Et.CONNECTION,Et.MODULE,Et.FTS],this.modules$=this.statesService.allModules$,this.selectedState=null,this._selectedType=null,this._selectedModule=null,this.filterPredicate=(o,i)=>{const a=o.type===this._selectedType,s=o.state.serialNumber===this._selectedModule;return this._selectedType&&this._selectedModule?a&&s:this._selectedType&&!this._selectedModule?a:!(!this._selectedType&&this._selectedModule)||s},this.filterPredicate=this.filterPredicate.bind(this),this.dataSource=new Hr(this.statesService.stateLog$),this.dataSource.filterPredicate=this.filterPredicate}get selectedType(){return this._selectedType}set selectedType(e){this._selectedType=e,this.dataSource.filter=this.createFilter(this._selectedType,this._selectedModule)}get selectedModule(){return this._selectedModule}set selectedModule(e){this._selectedModule=e,this.dataSource.filter=this.createFilter(this._selectedType,this._selectedModule)}createFilter(e,o){return`${null!=e?e:""}\u25ec${null!=o?o:""}`}ngAfterViewInit(){this.sort.active="received",this.sort.start="desc",this.dataSource.sort=this.sort}selectState(e){this.selectedState=this.selectedState===e?null:e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ff-status-log"]],viewQuery:function(e,o){if(1&e&&t.Gf(z.YE,5),2&e){let i;t.iGM(i=t.CRH())&&(o.sort=i.first)}},decls:47,vars:31,consts:[[1,"header"],[1,"filter-header"],[1,"filter-label"],["appearance","fill",1,"status-type-filter"],[3,"value","valueChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"module-type-filter"],[1,"state-table-container"],["mat-table","","multiTemplateDataRows","","matSort","","matSortActive","received","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","","class","actions-column",4,"matHeaderCellDef"],["mat-cell","","class","actions-column",4,"matCellDef"],["matColumnDef","received"],["mat-header-cell","","mat-sort-header","","disableClear","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","module"],["matColumnDef","stateDetails"],["mat-header-row","",4,"matHeaderRowDef"],["class","mat-row",4,"matNoDataRow"],["mat-row","","class","state-row",3,"selected-state-row","severity-fatal","severity-warning","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","state-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"actions-column"],["mat-cell","",1,"actions-column"],["mat-icon-button",""],["mat-header-cell","","mat-sort-header","","disableClear",""],["mat-cell",""],["mat-header-cell",""],[3,"stateLog"],[1,"selected-state-detail"],["mat-header-row",""],[1,"mat-row"],[1,"no-data"],["mat-row","",1,"state-row",3,"click"],["mat-row","",1,"state-detail-row"]],template:function(e,o){1&e&&(t.TgZ(0,"ff-missing-controller-banner")(1,"h2",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"section",1)(5,"h3",2),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"mat-form-field",3)(9,"mat-label"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"mat-select",4),t.NdJ("valueChange",function(a){return o.selectedType=a}),t.TgZ(13,"mat-option",5),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.YNc(16,Na,3,4,"mat-option",6),t.qZA()(),t.TgZ(17,"mat-form-field",7)(18,"mat-label"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"mat-select",4),t.NdJ("valueChange",function(a){return o.selectedModule=a}),t.TgZ(22,"mat-option",5),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.YNc(25,Da,3,5,"mat-option",6),t.ALo(26,"async"),t.qZA()()(),t.TgZ(27,"section",8)(28,"table",9),t.ynx(29,10),t.YNc(30,ka,1,0,"th",11),t.YNc(31,qa,4,1,"td",12),t.BQk(),t.ynx(32,13),t.YNc(33,$a,3,3,"th",14),t.YNc(34,Ja,3,4,"td",15),t.BQk(),t.ynx(35,16),t.YNc(36,Qa,3,3,"th",17),t.YNc(37,Ya,3,3,"td",15),t.BQk(),t.ynx(38,18),t.YNc(39,Ha,3,3,"th",17),t.YNc(40,Ba,2,1,"td",15),t.BQk(),t.ynx(41,19),t.YNc(42,Ga,3,5,"td",15),t.BQk(),t.YNc(43,Wa,1,0,"tr",20),t.YNc(44,Va,4,4,"tr",21),t.YNc(45,ja,3,12,"tr",22),t.YNc(46,za,1,0,"tr",23),t.qZA()()()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,16,"Statusmeldungen")),t.xp6(4),t.Oqu(t.lcZ(7,18,"Filter")),t.xp6(4),t.Oqu(t.lcZ(11,20,"state.type")),t.xp6(2),t.Q6J("value",o.selectedType),t.xp6(1),t.Q6J("value",null),t.xp6(1),t.Oqu(t.lcZ(15,22,"Alle Nachrichten")),t.xp6(2),t.Q6J("ngForOf",o.logTypes),t.xp6(3),t.Oqu(t.lcZ(20,24,"Module")),t.xp6(2),t.Q6J("value",o.selectedModule),t.xp6(1),t.Q6J("value",null),t.xp6(1),t.Oqu(t.lcZ(24,26,"Alle Module")),t.xp6(2),t.Q6J("ngForOf",t.lcZ(26,28,o.modules$)),t.xp6(3),t.Q6J("dataSource",o.dataSource),t.xp6(15),t.Q6J("matHeaderRowDef",o.stateColumns),t.xp6(2),t.Q6J("matRowDefColumns",o.stateColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(30,Ka)))},directives:[ut,N.KE,N.hX,gt.gD,re.ey,_.sg,C.BZ,z.YE,C.w1,C.fO,C.ge,C.Dz,C.ev,E.lW,U.Hw,z.nU,Vr,Ua,C.as,C.XQ,C.Ee,C.nj,C.Gk],pipes:[A.X$,_.Ov,_.uU,Ra],styles:["[_nghost-%COMP%]{display:block;padding:10px}.filter-header[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;width:auto;align-items:center}.filter-header[_ngcontent-%COMP%]   .filter-label[_ngcontent-%COMP%]{margin-right:.75rem}.actions-column[_ngcontent-%COMP%]{width:48px}li.warning[_ngcontent-%COMP%]{background:yellow}li.error[_ngcontent-%COMP%]{background:red}.state-table-container[_ngcontent-%COMP%]{position:relative;max-height:calc(100dvh - 17rem);overflow:auto}table[_ngcontent-%COMP%]{width:100%}.state-detail-row[_ngcontent-%COMP%]{height:0}.state-row[_ngcontent-%COMP%]:not(.state-detail-row):hover{cursor:pointer;background:whitesmoke}.state-row[_ngcontent-%COMP%]:not(.state-detail-row):active{background:#efefef}.state-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.selected-state-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.selected-state-detail[_ngcontent-%COMP%]:not(.expanded){height:0}.mat-column-actions[_ngcontent-%COMP%]{width:20px;max-width:20px}td.mat-column-actions[_ngcontent-%COMP%]:first-of-type{padding-left:0}td.no-data[_ngcontent-%COMP%]:first-of-type{padding-left:44px}.state-row.severity-fatal[_ngcontent-%COMP%]{background:#ff968c}.state-row.severity-warning[_ngcontent-%COMP%]{background:#fff3f2}"],data:{animation:[(0,ot.X$)("detailExpand",[(0,ot.SB)("collapsed",(0,ot.oB)({height:"0px"})),(0,ot.SB)("expanded",(0,ot.oB)({height:"*"})),(0,ot.eR)("expanded <=> collapsed",(0,ot.jt)("250ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),n})(),data:{[q]:".."}},{path:"**",redirectTo:"./"}]}];let es=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(ts)],Z.Bz]}),n})(),ns=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_.ez,Xt,L.u5,_t.IX,Z.Bz,A.aw,Te,ge]]}),n})();var He=p(984),os=p(3158);class Be{constructor(r,e="assets/i18n/messages.",o=".xlf"){this.http=r,this.prefix=e,this.suffix=o}getTranslation(r){const e=`${this.prefix}${r}${this.suffix}`;return this.http.get(e,{responseType:"text",observe:"body"}).pipe((0,m.U)(o=>{const i=He.XMLValidator.validate(o);if(!0!==i)throw new Error(`Invalid XML: ${i.err.msg} at ${i.err.line}:${i.err.col}`);return o}),(0,m.U)(o=>new He.XMLParser({ignoreAttributes:!1}).parse(o)),(0,m.U)(o=>{if(!o.xliff)throw new Error("Invalid XLIFF: missing xliff root element");if(!o.xliff.file)throw new Error("Invalid XLIFF: missing xliff.file element");if(!o.xliff.file.body)throw new Error("Invalid XLIFF: missing xliff.file.body element");return o.xliff.file.body["trans-unit"]}),(0,m.U)(o=>o.reduce((i,a)=>{const s=a["@_id"];return!s||!a.target||("string"==typeof a.target?i[s]=a.target:"object"==typeof a.target&&(i[s]=a.target["#text"])),i},{})),(0,Dt.b)(o=>{console.groupCollapsed(`Loaded ${Object.keys(o).length} translations for targetFile ${e}`),console.table(o),console.groupEnd()}),(0,os.K)(o=>(console.error(`Failed to load translation for targetFile ${e}:`,o),(0,ye.of)({}))))}}function is(n){return new Be(n,"assets/i18n/messages-omm.",".xlf")}let Ge=(()=>{class n{constructor(e,o,i){var a;this.locale=e,this.translate=o,this.i18n=i,this.translate.setDefaultLang("de"),this.translate.addLangs(["de","en","es","fr","nl","pt","ru","ua"]);const s=null!==(a=this.locale)&&void 0!==a?a:this.translate.getBrowserLang();console.log("Detected locale: "+s),this.translate.use(s),this.i18n.use(s)}static configure(e={}){var o,i,a,s,l;return{ngModule:n,providers:[null!==(o=e.showLanguageSelector)&&void 0!==o?o:{provide:Wt,useValue:!1},null!==(i=e.mqttPrefixRequired)&&void 0!==i?i:{provide:Gt,useValue:!0},null!==(a=e.mqttService)&&void 0!==a?a:{provide:Bt,useClass:sn},null!==(s=e.controllerService)&&void 0!==s?s:{provide:Vt,useClass:ln},null!==(l=e.dashboardConfig)&&void 0!==l?l:{provide:R.zz,useValue:fe}]}}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(t.soG),t.LFG(A.sK),t.LFG(ne.Dp))},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[I,ee],imports:[[_.ez,es,Xt,_t.IX,Te,ns,A.aw.forChild({loader:{provide:A.Zw,useFactory:is,deps:[Ht.eN]},extend:!0,isolate:!0})]]}),n})();var V=(()=>{return(n=V||(V={})).LOGS="factory/logs",n.LAYOUT="factory/layout",n.FLOWS="factory/flows",n.ORDERS="factory/orders",n.ROOT="",n.DASHBOARD="dashboard",n.FACTORY="factory",n.WILDCARD="**",V;var n})(),_e=p(9946);function as(n,r){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"router-outlet"),t.qZA())}let ss=(()=>{class n{constructor(e){this.translate=e,this.APP_TITLE="Agile Production Simulation (APS)",this.RoutePaths=V,this.i18nIsFullyLoaded$=this.translate.getStreamOnTranslationChange("dashboardOrder").pipe((0,m.U)(o=>"dashboardOrder"!==o))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-root"]],decls:5,vars:4,consts:[[1,"mat-title"],["class","page-content mat-typography",4,"ngIf"],[1,"page-content","mat-typography"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-toolbar")(1,"h1",0),t._uU(2),t.qZA()(),t.YNc(3,as,2,0,"div",1),t.ALo(4,"async")),2&e&&(t.xp6(2),t.Oqu(o.APP_TITLE),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,o.i18nIsFullyLoaded$)))},directives:[_e.Ye,_.O5,Z.lC],pipes:[_.Ov],styles:["[_nghost-%COMP%]{display:flex;height:100%;width:100%;margin:0;padding:0;overflow:hidden;flex-direction:column}.page-content[_ngcontent-%COMP%]{box-sizing:border-box;display:block;flex:1;overflow:auto}"]}),n})();const ls=[{path:V.ROOT,redirectTo:V.FACTORY,pathMatch:"full"},{path:V.FACTORY,loadChildren:()=>Ge},{path:V.WILDCARD,redirectTo:V.FACTORY}];let cs=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Z.Bz.forRoot(ls,{relativeLinkResolution:"legacy"})],Z.Bz]}),n})();var Jt=(()=>{return(n=Jt||(Jt={}))[n.Unset=0]="Unset",n[n.SmartHome=1]="SmartHome",n[n.TrainingFactory=2]="TrainingFactory",n[n.APS=3]="APS",Jt;var n})();let We=(()=>{class n{constructor(){this.controllers$=new H.X([{targetModule:Jt.APS,name:"APS",hardwareModel:"TXT",alarm:!0,pushMessage:!0,shared:!0,mqttUser:{mqttUserId:1,password:"password",crdate:1560873431,controllerId:"1"},softwareVersion:"1.1.9",softwareName:"txt",controllerId:1,crdate:1560873431}])}onChange(){return this.controllers$.asObservable()}loadControllers(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ve=(()=>{class n{constructor(e){this.mqttService=e,this.destroy=new J.t(1)}publish(e,o,i,a){this.mqttService.unsafePublish(o,i,a)}subscribe(e,o){return console.debug("Subscribing to topic : %s",o),this.mqttService.observe(o).pipe((0,F.R)(this.destroy))}ngOnDestroy(){this.destroy.next(!0),this.destroy.complete(),this.mqttService.disconnect()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(vt.KZ))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var it=p(2985),us=p(9973),O=p(9011);function ds(){const n=document.getElementsByTagName("base");return n.length?n[0].getAttribute("href"):"/"}let ps=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:_.mr,useFactory:ds},{provide:us.h,useValue:{}},{provide:O.pl,useClass:Ve}],imports:[[R.Q5.configure({alarmService:{provide:O.Tg,useClass:O.qd,deps:[ne.Dp,O.pl]},ptuService:{provide:O.Ms,useClass:O.VX,deps:[O.pl]},cameraService:{provide:O.yr,useClass:O.ib,deps:[O.pl]},ldrSensorService:{provide:O.L9,useClass:O.LR,deps:[O.pl]},bme680SensorService:{provide:O.SX,useClass:O.zj,deps:[O.pl]},nfcService:{provide:O.nd,useClass:O.Eg,deps:[O.pl]},orderService:{provide:O.px,useClass:O.j,deps:[O.pl]},stateService:{provide:O.b2,useClass:O.SB,deps:[O.pl]},stockService:{provide:O.qR,useClass:O.lm,deps:[O.pl]},hbwService:{provide:O.dC,useClass:O.cG,deps:[O.pl]},userApiService:{provide:it.Qf,useClass:it.vC},chartApiService:{provide:it.j4,useClass:it.Cd},cameraApiService:{provide:it.Me,useClass:it.UB},controllerApiService:{provide:it.kE,useClass:We}})]]}),n})(),_s=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_e.g0],_e.g0]}),n})();function ms(n){return new Be(n,"assets/i18n/messages-ft.",".xlf")}const fs={hostname:window.location.hostname,port:9001,path:"/ws",username:"default",password:"default"};let gs=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n,bootstrap:[ss]}),n.\u0275inj=t.cJS({imports:[[Zt.b2,je.PW,cs,_s,ps,Ht.JF,A.aw.forRoot({loader:{provide:A.Zw,useFactory:ms,deps:[Ht.eN]}}),vt.tY.forRoot(fs),Ge.configure({showLanguageSelector:{provide:Wt,useValue:!0},mqttPrefixRequired:{provide:Gt,useValue:!1},mqttService:{provide:Bt,useClass:Ve},controllerService:{provide:Vt,useClass:We},dashboardConfig:{provide:R.zz,useValue:ze}})]]}),n})();(0,t.G48)(),Zt.q6().bootstrapModule(gs).catch(n=>console.error(n))}},pt=>{pt.O(0,["vendor"],()=>pt(pt.s=1728)),pt.O()}]);
//# sourceMappingURL=main.3c3283515fab30fd.js.map