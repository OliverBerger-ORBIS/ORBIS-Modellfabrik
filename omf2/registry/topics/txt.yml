metadata:
  version: 2.1.0
  last_updated: '2025-10-09'
  author: OMF Development Team
  description: TXT Topics mit QoS/Retain und Publisher/Subscriber-Mapping (erweitert mit Session-Analyse)
  analysis_note: "Direction is from TXT-Controller perspective: i=INPUT (to TXT), o=OUTPUT (from TXT)"
category: txt
txt_topics:
- topic: /j1/txt/1/f/i/stock
  qos: 1
  retain: 0
  schema: j1_txt_1_f_i_stock.schema.json
  description: "Stock-Status Updates - HBW Inventory für TXT-Display"
  assumption: "TXT stockitems FIFO workpiece (id-nfc, tape BLUE state-RAW, loc-FIFO-Pos, hbw-serial -> inventory"
  # APS as-IS Observation:
  observed_publisher_aps: "CCU-Backend (Stock Management)"
  observed_subscriber_aps: "TXT-Controller (DPS Display)"
  # OMF2 Guidance (manual configuration):
  semantic_role: stock_status_display
  triggers: null
  omf2_usage: "Optional: StockManager → publish stock updates for TXT-Display"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - 5+ updates pro Session"
- topic: /j1/txt/1/f/i/order
  qos: 1
  retain: 0
  schema: j1_txt_1_f_i_order.schema.json
  description: "Order-Status Feedback - zeigt aktuelle Order auf TXT-Display"
  assumption: 'TXT "state": "WAITING_FOR_ORDER"'
  # APS as-IS Observation:
  observed_publisher_aps: "CCU-Backend (Gateway Module - publishGatewayOrderUpdate)"
  observed_subscriber_aps: "TXT-Controller (DPS Display)"
  # OMF2 Guidance (manual configuration):
  semantic_role: order_status_display
  triggers: null
  omf2_usage: "Optional: ProductionOrderManager → publish order status for TXT-Display (states: WAITING_FOR_ORDER, IN_PROCESS, ORDERED)"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - 8+ status updates pro Order, Code: gateway/order/publish.js"
- topic: /j1/txt/1/f/i/status
  qos: 1
  retain: 0
  schema: j1_txt_1_f_i_order.schema.json
  description: "Status-Updates an TXT-Display (deprecated/unused?)"
  assumption: 'TXT "state": "WAITING_FOR_ORDER", "type": "RED", "ts": "2025-08-29T10:00:00Z" -> order'
  # APS as-IS Observation:
  observed_publisher_aps: "CCU-Backend (Gateway Module)"
  observed_subscriber_aps: "TXT-Controller (DPS Display)"
  # OMF2 Guidance (manual configuration):
  semantic_role: status_display
  triggers: null
  omf2_usage: "Unknown - topic not observed in recent sessions, possibly deprecated"
  # Verification:
  verified: false
  data_source: "Not found in recent sessions"
- topic: /j1/txt/1/f/i/error
  qos: 1
  retain: 0
  schema: j1_txt_1_f_i_order.schema.json
  description: "Error-Messages an TXT-Display"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "CCU-Backend (Gateway Module)"
  observed_subscriber_aps: "TXT-Controller (DPS Display)"
  # OMF2 Guidance (manual configuration):
  semantic_role: error_display
  triggers: null
  omf2_usage: "Optional: ErrorHandler → publish errors for TXT-Display"
  # Verification:
  verified: false
  data_source: "Not found in recent sessions"
- topic: /j1/txt/1/f/i/config/hbw
  qos: 1
  retain: 1
  schema: j1_txt_1_f_i_config_hbw.schema.json
  description: "HBW-Configuration für TXT-Display (warehouse list)"
  assumption: 'TXT "warehouses":["SVR3QA0022"]'
  # APS as-IS Observation:
  observed_publisher_aps: "CCU-Backend (Gateway Module)"
  observed_subscriber_aps: "TXT-Controller (DPS Display)"
  # OMF2 Guidance (manual configuration):
  semantic_role: warehouse_config_display
  triggers: null
  omf2_usage: "Optional: WarehouseManager → publish HBW configuration for TXT-Display"
  # Verification:
  verified: false
  data_source: "Schema exists, not verified in sessions"
- topic: /j1/txt/1/f/o/order
  qos: 2
  retain: 0
  schema: wildcard.schema.json
  description: "Order-Request vom User - triggert Production Order Workflow"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "APS-Dashboard Frontend (MQTT-Browser) imitating TXT-Controller"
  observed_subscriber_aps: "CCU-Backend (Gateway Module - handleMessage)"
  # OMF2 Guidance (manual configuration):
  semantic_role: order_trigger_alternative
  triggers: production_order_workflow
  omf2_usage: "ProductionOrderManager → subscribe to detect orders (ALTERNATIVE to ccu/order/request)"
  omf2_note: "Topic is OPTIONAL - ccu/order/request is the primary trigger. This topic is for TXT-Gateway compatibility."
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - 2 messages (BLUE, RED), Code: gateway/order/index.js"
  analysis_note: "Identical timestamp with ccu/order/request confirms same publisher (Frontend sends both simultaneously)"
- topic: /j1/txt/1/f/o/stock
  qos: 1
  retain: 0
  schema: wildcard.schema.json
  description: "Stock-Updates vom User an CCU (manual inventory changes?)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller or Frontend"
  observed_subscriber_aps: "CCU-Backend (Gateway Module)"
  # OMF2 Guidance (manual configuration):
  semantic_role: stock_update_trigger
  triggers: stock_management_update
  omf2_usage: "StockManager → subscribe for manual stock updates from TXT-UI"
  # Verification:
  verified: false
  data_source: "Not found in recent sessions, possibly unused"
- topic: /j1/txt/1/f/o/status
  qos: 1
  retain: 0
  schema: wildcard.schema.json
  description: "Status-Messages vom TXT an CCU (unknown purpose)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller or Frontend"
  observed_subscriber_aps: "CCU-Backend (Gateway Module)"
  # OMF2 Guidance (manual configuration):
  semantic_role: unknown
  triggers: null
  omf2_usage: "Unknown - topic not observed, possibly deprecated"
  # Verification:
  verified: false
  data_source: "Not found in recent sessions"
- topic: /j1/txt/1/f/o/error
  qos: 1
  retain: 0
  schema: wildcard.schema.json
  description: "Error-Reports vom TXT an CCU"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller or Frontend"
  observed_subscriber_aps: "CCU-Backend (Gateway Module)"
  # OMF2 Guidance (manual configuration):
  semantic_role: error_report
  triggers: error_handling
  omf2_usage: "Optional: ErrorHandler → subscribe for TXT-reported errors"
  # Verification:
  verified: false
  data_source: "Not found in recent sessions"
- topic: /j1/txt/1/c/bme680
  qos: 1
  retain: 0
  schema: j1_txt_1_c_bme680.schema.json
  description: "BME680 Sensor configuration/control (purpose unclear)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: Unknown
  observed_subscriber_aps: Unknown
  # OMF2 Guidance (manual configuration):
  semantic_role: sensor_config
  triggers: null
  omf2_usage: "Unknown - schema exists but topic not observed in sessions"
  # Verification:
  verified: false
  data_source: "Schema exists, not found in sessions"
- topic: /j1/txt/1/c/cam
  qos: 1
  retain: 0
  schema: j1_txt_1_c_cam.schema.json
  description: "Camera configuration/control (purpose unclear)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: Unknown
  observed_subscriber_aps: Unknown
  # OMF2 Guidance (manual configuration):
  semantic_role: camera_config
  triggers: null
  omf2_usage: "Unknown - schema exists but topic not observed in sessions"
  # Verification:
  verified: false
  data_source: "Schema exists, not found in sessions"
- topic: /j1/txt/1/c/ldr
  qos: 1
  retain: 0
  schema: j1_txt_1_c_ldr.schema.json
  description: "LDR (Light sensor) configuration/control (purpose unclear)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: Unknown
  observed_subscriber_aps: Unknown
  # OMF2 Guidance (manual configuration):
  semantic_role: light_sensor_config
  triggers: null
  omf2_usage: "Unknown - schema exists but topic not observed in sessions"
  # Verification:
  verified: false
  data_source: "Schema exists, not found in sessions"
- topic: /j1/txt/1/i/bme680
  qos: 1
  retain: 0
  schema: j1_txt_1_i_bme680.schema.json
  description: "BME680 Environment Sensor-Daten (Temp, Humidity, Pressure, Air Quality)"
  assumption: "TXT -> Sensor-Data"
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller (DPS Sensors)"
  observed_subscriber_aps: "CCU-Backend, Monitoring Systems, Dashboards"
  # OMF2 Guidance (manual configuration):
  semantic_role: environment_telemetry
  triggers: null
  omf2_usage: "Optional: MonitoringManager → subscribe for environment data (periodic ~20s)"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - periodic updates every ~20s"
- topic: /j1/txt/1/i/broadcast
  qos: 1
  retain: 0
  schema: j1_txt_1_i_broadcast.schema.json
  description: "TXT Hardware-Info (hardwareId, model, software version) - sent at startup"
  assumption: 'TXT "hardwareId": "txt40-p0F4"'
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller (DPS)"
  observed_subscriber_aps: "CCU-Backend, Monitoring Systems"
  # OMF2 Guidance (manual configuration):
  semantic_role: hardware_announcement
  triggers: null
  omf2_usage: "Optional: DeviceRegistry → subscribe for TXT hardware discovery/identification"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - message #4 at startup"
- topic: /j1/txt/1/i/cam
  qos: 2
  retain: 1
  schema: j1_txt_1_i_cam.schema.json
  description: "Camera images (base64 JPEG) - high frequency stream (2-3 fps)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller (DPS Camera)"
  observed_subscriber_aps: "CCU-Backend, Monitoring Systems, Dashboards, Vision Systems"
  # OMF2 Guidance (manual configuration):
  semantic_role: camera_stream
  triggers: null
  omf2_usage: "Optional: VisionManager → subscribe for camera feed (WARNING: high frequency, 100+ msgs/min)"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - 100+ images, very frequent (~2 fps)"
- topic: /j1/txt/1/i/ldr
  qos: 1
  retain: 0
  schema: j1_txt_1_i_ldr.schema.json
  description: "LDR Light-Sensor data (brightness: br, light: ldr values)"
  assumption: "TXT -> Sensor-Data"
  # APS as-IS Observation:
  observed_publisher_aps: "TXT-Controller (DPS Sensors)"
  observed_subscriber_aps: "CCU-Backend, Monitoring Systems"
  # OMF2 Guidance (manual configuration):
  semantic_role: light_telemetry
  triggers: null
  omf2_usage: "Optional: MonitoringManager → subscribe for light sensor data"
  # Verification:
  verified: true
  data_source: "Session orderBlueLocal_orderRedCloud - periodic updates"
- topic: /j1/txt/1/o/broadcast
  qos: 1
  retain: 0
  schema: wildcard.schema.json
  description: "Commands to TXT actuators/outputs (purpose unclear)"
  assumption: TODO
  # APS as-IS Observation:
  observed_publisher_aps: Unknown
  observed_subscriber_aps: "TXT-Controller (DPS Actuators)"
  # OMF2 Guidance (manual configuration):
  semantic_role: actuator_command
  triggers: null
  omf2_usage: "Unknown - topic found in session but payload unclear"
  # Verification:
  verified: false
  data_source: "Found in session but payload unknown"

# ==============================================================================
# TXT TOPIC PATTERN DOCUMENTATION
# ==============================================================================
#
# Topic Structure: /j1/txt/<controller_id>/<category>/<direction>/<function>
#
# Controller ID:
#   j1 = TXT-Controller ID 1 (DPS Module, IP: 192.168.0.102)
#
# Categories:
#   /f/ = Factory (Business Logic - bidirektional)
#   /i/ = Input Devices (Sensoren - unidirektional vom TXT)
#   /o/ = Output Devices (Aktoren - unidirektional zum TXT)
#   /c/ = Configuration/Control (vermutlich bidirektional)
#
# Direction Semantik (Perspektive: TXT-Controller Hardware):
#   /f/i/ = Factory-Input (Daten ZUM TXT-Display)
#   /f/o/ = Factory-Output (Events VOM TXT-UI oder Frontend)
#   /i/   = Input-Device (Sensor-Daten VOM TXT)
#   /o/   = Output-Device (Aktor-Befehle ZUM TXT)
#
# ==============================================================================
# REGISTRY FIELD SEMANTICS (für OMF2 Entwicklung)
# ==============================================================================
#
# observed_publisher_aps:
#   - Dokumentiert WER in APS-System tatsächlich publiziert (as-IS Beobachtung)
#   - Bezug zu Komponenten in docs/06-integrations/00-REFERENCE/component-overview.md
#   - NICHT für automatische OMF2-Konfiguration
#   - Nur Dokumentation des beobachteten APS-Verhaltens
#
# observed_subscriber_aps:
#   - Dokumentiert WER in APS-System tatsächlich subscribed (as-IS Beobachtung)
#   - WICHTIG: Jeder KANN subscriben - dies ist nur beobachtetes Verhalten
#   - NICHT für automatische OMF2-Konfiguration
#   - Nur Dokumentation, KEINE Vorgabe
#
# semantic_role:
#   - Semantische Rolle des Topics (z.B. order_trigger, telemetry, status_display)
#   - Hilft Entwicklern die Bedeutung zu verstehen
#   - Guidance für MANUELLE Architektur-Konfiguration
#
# triggers:
#   - Welchen Workflow/Prozess löst dieses Topic aus (falls zutreffend)
#   - null = löst keinen Workflow aus (z.B. Telemetrie)
#   - Guidance für Komponenten-Design
#
# omf2_usage:
#   - Empfehlung WIE OMF2-Komponenten dieses Topic nutzen KÖNNTEN
#   - Format: "ComponentName → subscribe/publish for purpose"
#   - Guidance für MANUELLE Konfiguration (nicht automatisch)
#   - Dokumentation für Entwickler beim Setup von:
#     * MQTTClient → Gateway → BusinessManager (onMessage mit Handler)
#
# Examples:
#   /j1/txt/1/f/o/order:
#     - observed_publisher_aps: "APS-Dashboard Frontend"
#     - semantic_role: order_trigger_alternative
#     - triggers: production_order_workflow
#     - omf2_usage: "ProductionOrderManager → subscribe (ALTERNATIVE to ccu/order/request)"
#
#   /j1/txt/1/f/i/order:
#     - observed_publisher_aps: "CCU-Backend Gateway Module"
#     - semantic_role: order_status_display
#     - triggers: null
#     - omf2_usage: "ProductionOrderManager → publish for TXT-Display"
#
# ==============================================================================
# KEY INSIGHTS (verified from Session Analysis)
# ==============================================================================
#
# 1. Fan-Out Pattern:
#    APS-Dashboard Frontend sendet GLEICHZEITIG:
#    ├── /j1/txt/1/f/o/order (für TXT-Display Kompatibilität)
#    └── ccu/order/request (für CCU-Backend Orchestration)
#
# 2. Identical Timestamps:
#    Beide Topics haben identische ts → bestätigt gleicher Publisher
#
# 3. Optional vs. Required:
#    - /j1/txt topics sind OPTIONAL (nur für TXT-Gateway/Display)
#    - ccu/* topics sind PRIMARY (erforderlich für Steuerung)
#
# 4. Frontend imitates TXT:
#    Frontend sendet als "TXT-Proxy" um Gateway-Kompatibilität zu erhalten
#
# ==============================================================================
# DATA SOURCES
# ==============================================================================
#
# Session Analysis: orderBlueLocal_orderRedCloud_20251009_103935.db/log
# Code Analysis: integrations/APS-CCU/ff-central-control-unit/central-control/src/modules/gateway/
# APS Reference: docs/06-integrations/00-REFERENCE/
# Analysis Date: 2025-10-09
#
# Verified Topics (in Sessions): 7 von 15
#   ✅ /j1/txt/1/f/o/order (2 messages - BLUE, RED)
#   ✅ /j1/txt/1/f/i/order (8+ status updates)
#   ✅ /j1/txt/1/f/i/stock (5+ updates)
#   ✅ /j1/txt/1/i/bme680 (periodic ~20s)
#   ✅ /j1/txt/1/i/cam (100+ images, ~2fps)
#   ✅ /j1/txt/1/i/ldr (periodic)
#   ✅ /j1/txt/1/i/broadcast (startup)