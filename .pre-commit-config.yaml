# .pre-commit-config.yaml
# Pre-commit hooks for OSF (Angular) and Session Manager (Python)

repos:
  # Angular/TypeScript Validation
  - repo: local
    hooks:
      # OSF Tests (CRITICAL - produktiver Code)
      - id: nx-test-osf
        name: OSF Tests
        entry: bash -c 'npx nx test osf-ui && npx nx test mqtt-client'
        language: system
        pass_filenames: false
        stages: [pre-commit]
        description: Run OSF tests (osf-ui, mqtt-client)

      # TypeScript/ESLint Linting
      - id: nx-lint-osf
        name: OSF Lint
        entry: npx nx lint osf-ui
        language: system
        pass_filenames: false
        stages: [pre-commit]
        description: Run ESLint on OSF Angular code

      # TypeScript Type Check (via tsc - non-blocking)
      - id: nx-type-check
        name: TypeScript Type Check
        entry: bash -c 'cd osf/apps/osf-ui && npx tsc --noEmit' || true
        language: system
        pass_filenames: false
        stages: [pre-commit]
        description: TypeScript type checking (non-blocking, ESLint catches most issues)

  # Python Validation (Session Manager only)
  - repo: local
    hooks:
      # Black Formatting (Session Manager)
      - id: black
        name: black
        entry: black
        language: system
        types: [python]
        files: ^(session_manager/|scripts/).*\.py$
        description: Format Python code (Session Manager, scripts)

      # Ruff Linting (Session Manager)
      - id: ruff
        name: ruff
        entry: ruff check --fix
        language: system
        types: [python]
        files: ^(session_manager/|scripts/).*\.py$
        description: Lint Python code (Session Manager, scripts)

  # Documentation Validation
  - repo: local
    hooks:
      # Mermaid Diagram Validation
      - id: validate-mermaid-diagrams
        name: validate-mermaid-diagrams
        entry: python tools/validate_mermaid_diagrams.py
        language: system
        files: \.md$
        pass_filenames: false
        stages: [pre-commit]
        description: Validate Mermaid diagrams in documentation
