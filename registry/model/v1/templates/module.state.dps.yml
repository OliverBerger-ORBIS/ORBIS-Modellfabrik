version: 1.0.0
metadata: { category: MODULE, sub_category: State, description: "DPS State" }
templates:
  module.state.dps:
    description: "Warenein-/ausgang; PICK mit Workpiece-Historie optional"
    match:
      required_fields: [timestamp, serialNumber]
    template_structure:
      serialNumber: { type: string }
      actionState:
        type: object
        required: false
        properties:
          id: { type: string }
          command: { type: string, enum: ["PICK","DROP"] }
          state: { type: string, enum: ["RUNNING","FINISHED"] }
          result: { type: string, required: false }
          timestamp: { type: string, format: date-time, required: false }
      actionStates:
        type: array
        required: false
        items:
          type: object
          properties:
            command: { type: string }
            id: { type: string }
            state: { type: string }
            timestamp: { type: string, format: date-time }
            metadata:
              type: object
              properties:
                workpiece:
                  type: object
                  properties:
                    workpieceId: { type: string }
                    type: { type: string, enum: ["RED","WHITE","BLUE"] }
                    state: { type: string }
                    history:
                      type: array
                      items: { type: object, properties: { code: {type: integer}, ts: {type: integer} } }
      batteryState: { type: object, required: false }
      loads: { type: array, items: { type: object }, required: false }
      operatingMode: { type: string, enum: ["AUTOMATIC","MANUAL"], required: false }
      information: { type: array, items: { type: object }, required: false }
      metadata: { type: object, properties: { opcuaState: { type: string } }, required: false }
      errors: { type: array, items: { type: object } }
      orderId: { type: string }
      orderUpdateId: { type: integer, minimum: 0 }
      paused: { type: boolean }
      headerId: { type: integer }
      timestamp: { type: string, format: date-time }
