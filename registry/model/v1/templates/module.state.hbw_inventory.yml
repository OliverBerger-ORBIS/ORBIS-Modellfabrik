version: 1.0.0
metadata: { category: MODULE, sub_category: State, description: "HBW Inventory State" }
templates:
  module.state.hbw_inventory:
    description: "Lagerzustand HBW (9 Positionen, Delta oder Full)"
    match:
      required_fields: [loads, timestamp]
    template_structure:
      serialNumber: { type: string }   # nicht auf fixed SN pr√ºfen
      operatingMode: { type: string, enum: ["AUTOMATIC","MANUAL"], required: false }
      actionState:
        type: object
        required: false
        properties:
          id: { type: string }
          command: { type: string, enum: ["PICK","DROP","STORE"] }
          state: { type: string, enum: ["RUNNING","FINISHED","ENQUEUED"] }
          result: { type: string, required: false } # z.B. NFC id bei DROP
          metadata:
            type: object
            properties:
              type: { type: string, enum: ["RED","WHITE","BLUE"], required: false }
      loads:
        type: array
        items:
          type: object
          properties:
            loadId: { type: string }
            loadType: { type: string, enum: ["RED","WHITE","BLUE",""] }
            loadPosition: { type: string, enum: ["A1","A2","A3","B1","B2","B3","C1","C2","C3"] }
            loadTimestamp: { type: integer, minimum: 0 }
      errors: { type: array, items: { type: object }, required: false }
      information: { type: array, items: { type: object }, required: false }
      metadata:
        type: object
        properties: { opcuaState: { type: string } }
      orderId: { type: string }
      orderUpdateId: { type: integer, minimum: 0 }
      paused: { type: boolean }
      timestamp: { type: string, format: date-time }
